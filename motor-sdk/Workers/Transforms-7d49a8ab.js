define(["exports","./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./Matrix4-c65e6a1b","./RuntimeError-86da6af2"],(function(e,t,r,n,i,a,o){"use strict";var s,u,l,f,d,c,h,p,m,y,v,w,C,g,E,O,_,x,b={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},D={};function q(e){for(var t=e.split("."),r=0,n=t.length;r<n;++r)t[r]=parseInt(t[r],10);return t}function A(){if(!t.defined(l)&&(l=!1,!N())){var e=/ Chrome\/([\.0-9]+)/.exec(u.userAgent);null!==e&&(l=!0,f=q(e[1]))}return l}function S(){return A()&&f}function R(){if(!t.defined(d)&&(d=!1,!A()&&!N()&&/ Safari\/[\.0-9]+/.test(u.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(u.userAgent);null!==e&&(d=!0,c=q(e[1]))}return d}function T(){return R()&&c}function M(){if(!t.defined(h)){h=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(u.userAgent);null!==e&&(h=!0,p=q(e[1]),p.isNightly=!!e[2])}return h}function I(){return M()&&p}function P(){var e;return t.defined(m)||(m=!1,"Microsoft Internet Explorer"===u.appName?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(u.userAgent),null!==e&&(m=!0,y=q(e[1]))):"Netscape"===u.appName&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(u.userAgent),null!==e&&(m=!0,y=q(e[1])))),m}function U(){return P()&&y}function N(){if(!t.defined(v)){v=!1;var e=/ Edge\/([\.0-9]+)/.exec(u.userAgent);null!==e&&(v=!0,w=q(e[1]))}return v}function F(){return N()&&w}function k(){if(!t.defined(C)){C=!1;var e=/Firefox\/([\.0-9]+)/.exec(u.userAgent);null!==e&&(C=!0,g=q(e[1]))}return C}function j(){return t.defined(E)||(E=/Windows/i.test(u.appVersion)),E}function z(){return k()&&g}function L(){return t.defined(O)||(O=!k()&&"undefined"!==typeof PointerEvent&&(!t.defined(u.pointerEnabled)||u.pointerEnabled)),O}function V(){if(!t.defined(x)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var r=e.style.imageRendering;x=t.defined(r)&&""!==r,x&&(_=r)}return x}function B(){return V()?_:void 0}function W(){if(!W.initialized)throw new r.DeveloperError("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return W._result}Object.defineProperties(D,{element:{get:function(){if(D.supportsFullscreen())return document[b.fullscreenElement]}},changeEventName:{get:function(){if(D.supportsFullscreen())return b.fullscreenchange}},errorEventName:{get:function(){if(D.supportsFullscreen())return b.fullscreenerror}},enabled:{get:function(){if(D.supportsFullscreen())return document[b.fullscreenEnabled]}},fullscreen:{get:function(){if(D.supportsFullscreen())return null!==D.element}}}),D.supportsFullscreen=function(){if(t.defined(s))return s;s=!1;var e=document.body;if("function"===typeof e.requestFullscreen)return b.requestFullscreen="requestFullscreen",b.exitFullscreen="exitFullscreen",b.fullscreenEnabled="fullscreenEnabled",b.fullscreenElement="fullscreenElement",b.fullscreenchange="fullscreenchange",b.fullscreenerror="fullscreenerror",s=!0,s;for(var r,n=["webkit","moz","o","ms","khtml"],i=0,a=n.length;i<a;++i){var o=n[i];r=o+"RequestFullscreen","function"===typeof e[r]?(b.requestFullscreen=r,s=!0):(r=o+"RequestFullScreen","function"===typeof e[r]&&(b.requestFullscreen=r,s=!0)),r=o+"ExitFullscreen","function"===typeof document[r]?b.exitFullscreen=r:(r=o+"CancelFullScreen","function"===typeof document[r]&&(b.exitFullscreen=r)),r=o+"FullscreenEnabled",void 0!==document[r]?b.fullscreenEnabled=r:(r=o+"FullScreenEnabled",void 0!==document[r]&&(b.fullscreenEnabled=r)),r=o+"FullscreenElement",void 0!==document[r]?b.fullscreenElement=r:(r=o+"FullScreenElement",void 0!==document[r]&&(b.fullscreenElement=r)),r=o+"fullscreenchange",void 0!==document["on"+r]&&("ms"===o&&(r="MSFullscreenChange"),b.fullscreenchange=r),r=o+"fullscreenerror",void 0!==document["on"+r]&&("ms"===o&&(r="MSFullscreenError"),b.fullscreenerror=r)}return s},D.requestFullscreen=function(e,t){D.supportsFullscreen()&&e[b.requestFullscreen]({vrDisplay:t})},D.exitFullscreen=function(){D.supportsFullscreen()&&document[b.exitFullscreen]()},D._names=b,u="undefined"!==typeof navigator?navigator:{},W._promise=void 0,W._result=void 0,W.initialize=function(){if(t.defined(W._promise))return W._promise;var e=t.when.defer();if(W._promise=e.promise,N())return W._result=!1,e.resolve(W._result),e.promise;var r=new Image;return r.onload=function(){W._result=r.width>0&&r.height>0,e.resolve(W._result)},r.onerror=function(){W._result=!1,e.resolve(W._result)},r.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.promise},Object.defineProperties(W,{initialized:{get:function(){return t.defined(W._result)}}});var Y=[];"undefined"!==typeof ArrayBuffer&&(Y.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!==typeof Uint8ClampedArray&&Y.push(Uint8ClampedArray),"undefined"!==typeof Uint8ClampedArray&&Y.push(Uint8ClampedArray));var H={isChrome:A,chromeVersion:S,isSafari:R,safariVersion:T,isWebkit:M,webkitVersion:I,isInternetExplorer:P,internetExplorerVersion:U,isEdge:N,edgeVersion:F,isFirefox:k,firefoxVersion:z,isWindows:j,hardwareConcurrency:t.defaultValue(u.hardwareConcurrency,3),supportsPointerEvents:L,supportsImageRenderingPixelated:V,supportsWebP:W,imageRenderingValue:B,typedArrayTypes:Y};function J(e,r,n,i){this.x=t.defaultValue(e,0),this.y=t.defaultValue(r,0),this.z=t.defaultValue(n,0),this.w=t.defaultValue(i,0)}H.supportsFullscreen=function(){return D.supportsFullscreen()},H.supportsTypedArrays=function(){return"undefined"!==typeof ArrayBuffer},H.supportsWebWorkers=function(){return"undefined"!==typeof Worker},H.supportsWebAssembly=function(){return"undefined"!==typeof WebAssembly&&!H.isEdge()},H.isInternetExplorer=function(){return P()},H.isEdge=function(){return N()};var X=new n.Cartesian3;J.fromAxisAngle=function(e,i,a){r.Check.typeOf.object("axis",e),r.Check.typeOf.number("angle",i);var o=i/2,s=Math.sin(o);X=n.Cartesian3.normalize(e,X);var u=X.x*s,l=X.y*s,f=X.z*s,d=Math.cos(o);return t.defined(a)?(a.x=u,a.y=l,a.z=f,a.w=d,a):new J(u,l,f,d)};var G=[1,2,0],Z=new Array(3);J.fromRotationMatrix=function(e,n){var i,o,s,u,l;r.Check.typeOf.object("matrix",e);var f=e[a.Matrix3.COLUMN0ROW0],d=e[a.Matrix3.COLUMN1ROW1],c=e[a.Matrix3.COLUMN2ROW2],h=f+d+c;if(h>0)i=Math.sqrt(h+1),l=.5*i,i=.5/i,o=(e[a.Matrix3.COLUMN1ROW2]-e[a.Matrix3.COLUMN2ROW1])*i,s=(e[a.Matrix3.COLUMN2ROW0]-e[a.Matrix3.COLUMN0ROW2])*i,u=(e[a.Matrix3.COLUMN0ROW1]-e[a.Matrix3.COLUMN1ROW0])*i;else{var p=G,m=0;d>f&&(m=1),c>f&&c>d&&(m=2);var y=p[m],v=p[y];i=Math.sqrt(e[a.Matrix3.getElementIndex(m,m)]-e[a.Matrix3.getElementIndex(y,y)]-e[a.Matrix3.getElementIndex(v,v)]+1);var w=Z;w[m]=.5*i,i=.5/i,l=(e[a.Matrix3.getElementIndex(v,y)]-e[a.Matrix3.getElementIndex(y,v)])*i,w[y]=(e[a.Matrix3.getElementIndex(y,m)]+e[a.Matrix3.getElementIndex(m,y)])*i,w[v]=(e[a.Matrix3.getElementIndex(v,m)]+e[a.Matrix3.getElementIndex(m,v)])*i,o=-w[0],s=-w[1],u=-w[2]}return t.defined(n)?(n.x=o,n.y=s,n.z=u,n.w=l,n):new J(o,s,u,l)};var Q=new J,K=new J,$=new J,ee=new J;J.fromHeadingPitchRoll=function(e,t){return r.Check.typeOf.object("headingPitchRoll",e),ee=J.fromAxisAngle(n.Cartesian3.UNIT_X,e.roll,Q),$=J.fromAxisAngle(n.Cartesian3.UNIT_Y,-e.pitch,t),t=J.multiply($,ee,$),K=J.fromAxisAngle(n.Cartesian3.UNIT_Z,-e.heading,Q),J.multiply(K,t,t)};var te=new n.Cartesian3,re=new n.Cartesian3,ne=new J,ie=new J,ae=new J;J.packedLength=4,J.pack=function(e,n,i){return r.Check.typeOf.object("value",e),r.Check.defined("array",n),i=t.defaultValue(i,0),n[i++]=e.x,n[i++]=e.y,n[i++]=e.z,n[i]=e.w,n},J.unpack=function(e,n,i){return r.Check.defined("array",e),n=t.defaultValue(n,0),t.defined(i)||(i=new J),i.x=e[n],i.y=e[n+1],i.z=e[n+2],i.w=e[n+3],i},J.packedInterpolationLength=3,J.convertPackedArrayForInterpolation=function(e,r,n,i){J.unpack(e,4*n,ae),J.conjugate(ae,ae);for(var a=0,o=n-r+1;a<o;a++){var s=3*a;J.unpack(e,4*(r+a),ne),J.multiply(ne,ae,ne),ne.w<0&&J.negate(ne,ne),J.computeAxis(ne,te);var u=J.computeAngle(ne);t.defined(i)||(i=[]),i[s]=te.x*u,i[s+1]=te.y*u,i[s+2]=te.z*u}},J.unpackInterpolationResult=function(e,r,i,a,o){t.defined(o)||(o=new J),n.Cartesian3.fromArray(e,0,re);var s=n.Cartesian3.magnitude(re);return J.unpack(r,4*a,ie),0===s?J.clone(J.IDENTITY,ne):J.fromAxisAngle(re,s,ne),J.multiply(ne,ie,o)},J.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.x=e.x,r.y=e.y,r.z=e.z,r.w=e.w,r):new J(e.x,e.y,e.z,e.w)},J.conjugate=function(e,t){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},J.magnitudeSquared=function(e){return r.Check.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},J.magnitude=function(e){return Math.sqrt(J.magnitudeSquared(e))},J.normalize=function(e,t){r.Check.typeOf.object("result",t);var n=1/J.magnitude(e),i=e.x*n,a=e.y*n,o=e.z*n,s=e.w*n;return t.x=i,t.y=a,t.z=o,t.w=s,t},J.inverse=function(e,t){r.Check.typeOf.object("result",t);var n=J.magnitudeSquared(e);return t=J.conjugate(e,t),J.multiplyByScalar(t,1/n,t)},J.add=function(e,t,n){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},J.subtract=function(e,t,n){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},J.negate=function(e,t){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},J.dot=function(e,t){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},J.multiply=function(e,t,n){r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",n);var i=e.x,a=e.y,o=e.z,s=e.w,u=t.x,l=t.y,f=t.z,d=t.w,c=s*u+i*d+a*f-o*l,h=s*l-i*f+a*d+o*u,p=s*f+i*l-a*u+o*d,m=s*d-i*u-a*l-o*f;return n.x=c,n.y=h,n.z=p,n.w=m,n},J.multiplyByScalar=function(e,t,n){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.number("scalar",t),r.Check.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},J.divideByScalar=function(e,t,n){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.number("scalar",t),r.Check.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},J.computeAxis=function(e,t){r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t);var i=e.w;if(Math.abs(i-1)<n.CesiumMath.EPSILON6)return t.x=t.y=t.z=0,t;var a=1/Math.sqrt(1-i*i);return t.x=e.x*a,t.y=e.y*a,t.z=e.z*a,t},J.computeAngle=function(e){return r.Check.typeOf.object("quaternion",e),Math.abs(e.w-1)<n.CesiumMath.EPSILON6?0:2*Math.acos(e.w)};var oe=new J;J.lerp=function(e,t,n,i){return r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",n),r.Check.typeOf.object("result",i),oe=J.multiplyByScalar(t,n,oe),i=J.multiplyByScalar(e,1-n,i),J.add(oe,i,i)};var se=new J,ue=new J,le=new J;J.slerp=function(e,t,i,a){r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",i),r.Check.typeOf.object("result",a);var o=J.dot(e,t),s=t;if(o<0&&(o=-o,s=se=J.negate(t,se)),1-o<n.CesiumMath.EPSILON6)return J.lerp(e,s,i,a);var u=Math.acos(o);return ue=J.multiplyByScalar(e,Math.sin((1-i)*u),ue),le=J.multiplyByScalar(s,Math.sin(i*u),le),a=J.add(ue,le,a),J.multiplyByScalar(a,1/Math.sin(u),a)},J.log=function(e,t){r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t);var i=n.CesiumMath.acosClamped(e.w),a=0;return 0!==i&&(a=i/Math.sin(i)),n.Cartesian3.multiplyByScalar(e,a,t)},J.exp=function(e,t){r.Check.typeOf.object("cartesian",e),r.Check.typeOf.object("result",t);var i=n.Cartesian3.magnitude(e),a=0;return 0!==i&&(a=Math.sin(i)/i),t.x=e.x*a,t.y=e.y*a,t.z=e.z*a,t.w=Math.cos(i),t};var fe=new n.Cartesian3,de=new n.Cartesian3,ce=new J,he=new J;J.computeInnerQuadrangle=function(e,t,i,a){r.Check.typeOf.object("q0",e),r.Check.typeOf.object("q1",t),r.Check.typeOf.object("q2",i),r.Check.typeOf.object("result",a);var o=J.conjugate(t,ce);J.multiply(o,i,he);var s=J.log(he,fe);J.multiply(o,e,he);var u=J.log(he,de);return n.Cartesian3.add(s,u,s),n.Cartesian3.multiplyByScalar(s,.25,s),n.Cartesian3.negate(s,s),J.exp(s,ce),J.multiply(t,ce,a)},J.squad=function(e,t,n,i,a,o){r.Check.typeOf.object("q0",e),r.Check.typeOf.object("q1",t),r.Check.typeOf.object("s0",n),r.Check.typeOf.object("s1",i),r.Check.typeOf.number("t",a),r.Check.typeOf.object("result",o);var s=J.slerp(e,t,a,ce),u=J.slerp(n,i,a,he);return J.slerp(s,u,2*a*(1-a),o)};for(var pe=new J,me=1.9011074535173003,ye=H.supportsTypedArrays()?new Float32Array(8):[],ve=H.supportsTypedArrays()?new Float32Array(8):[],we=H.supportsTypedArrays()?new Float32Array(8):[],Ce=H.supportsTypedArrays()?new Float32Array(8):[],ge=0;ge<7;++ge){var Ee=ge+1,Oe=2*Ee+1;ye[ge]=1/(Ee*Oe),ve[ge]=Ee/Oe}function _e(e,t,n){r.Check.defined("array",e),r.Check.defined("itemToFind",t),r.Check.defined("comparator",n);var i,a,o=0,s=e.length-1;while(o<=s)if(i=~~((o+s)/2),a=n(e[i],t),a<0)o=i+1;else{if(!(a>0))return i;s=i-1}return~(s+1)}function xe(e,t,r,n,i){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=r,this.yPoleOffset=n,this.ut1MinusUtc=i}function be(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,r=0,n=t[r++],i=function(e,t,r,n){r||(r=" ");var i=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return n?e+i:i+e},a=function(e,t,r,n,a,o){var s=n-e.length;return s>0&&(e=r||!a?i(e,n,o,r):e.slice(0,t.length)+i("",s,"0",!0)+e.slice(t.length)),e},o=function(e,t,r,n,o,s,u){var l=e>>>0;return r=r&&l&&{2:"0b",8:"0",16:"0x"}[t]||"",e=r+i(l.toString(t),s||0,"0",!1),a(e,r,n,o,u)},s=function(e,t,r,n,i,o){return null!=n&&(e=e.slice(0,n)),a(e,"",t,r,i,o)},u=function(e,n,u,l,f,d,c){var h,p,m,y,v;if("%%"==e)return"%";for(var w=!1,C="",g=!1,E=!1,O=" ",_=u.length,x=0;u&&x<_;x++)switch(u.charAt(x)){case" ":C=" ";break;case"+":C="+";break;case"-":w=!0;break;case"'":O=u.charAt(x+1);break;case"0":g=!0;break;case"#":E=!0;break}if(l=l?"*"==l?+t[r++]:"*"==l.charAt(0)?+t[l.slice(1,-1)]:+l:0,l<0&&(l=-l,w=!0),!isFinite(l))throw new Error("sprintf: (minimum-)width must be finite");switch(d=d?"*"==d?+t[r++]:"*"==d.charAt(0)?+t[d.slice(1,-1)]:+d:"fFeE".indexOf(c)>-1?6:"d"==c?0:void 0,v=n?t[n.slice(0,-1)]:t[r++],c){case"s":return s(String(v),w,l,d,g,O);case"c":return s(String.fromCharCode(+v),w,l,d,g);case"b":return o(v,2,E,w,l,d,g);case"o":return o(v,8,E,w,l,d,g);case"x":return o(v,16,E,w,l,d,g);case"X":return o(v,16,E,w,l,d,g).toUpperCase();case"u":return o(v,10,E,w,l,d,g);case"i":case"d":return h=+v||0,h=Math.round(h-h%1),p=h<0?"-":C,v=p+i(String(Math.abs(h)),d,"0",!1),a(v,p,w,l,g);case"e":case"E":case"f":case"F":case"g":case"G":return h=+v,p=h<0?"-":C,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(c.toLowerCase())],y=["toString","toUpperCase"]["eEfFgG".indexOf(c)%2],v=p+Math.abs(h)[m](d),a(v,p,w,l,g)[y]();default:return e}};return n.replace(e,u)}function De(e,t,r,n,i,a,o,s){this.year=e,this.month=t,this.day=r,this.hour=n,this.minute=i,this.second=a,this.millisecond=o,this.isLeapSecond=s}function qe(e){if(null===e||isNaN(e))throw new r.DeveloperError("year is required and must be a number.");return e%4===0&&e%100!==0||e%400===0}function Ae(e,t){this.julianDate=e,this.offset=t}ye[7]=me/136,ve[7]=8*me/17,J.fastSlerp=function(e,t,n,i){r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",n),r.Check.typeOf.object("result",i);var a,o=J.dot(e,t);o>=0?a=1:(a=-1,o=-o);for(var s=o-1,u=1-n,l=n*n,f=u*u,d=7;d>=0;--d)we[d]=(ye[d]*l-ve[d])*s,Ce[d]=(ye[d]*f-ve[d])*s;var c=a*n*(1+we[0]*(1+we[1]*(1+we[2]*(1+we[3]*(1+we[4]*(1+we[5]*(1+we[6]*(1+we[7])))))))),h=u*(1+Ce[0]*(1+Ce[1]*(1+Ce[2]*(1+Ce[3]*(1+Ce[4]*(1+Ce[5]*(1+Ce[6]*(1+Ce[7])))))))),p=J.multiplyByScalar(e,h,pe);return J.multiplyByScalar(t,c,i),J.add(p,i,i)},J.fastSquad=function(e,t,n,i,a,o){r.Check.typeOf.object("q0",e),r.Check.typeOf.object("q1",t),r.Check.typeOf.object("s0",n),r.Check.typeOf.object("s1",i),r.Check.typeOf.number("t",a),r.Check.typeOf.object("result",o);var s=J.fastSlerp(e,t,a,ce),u=J.fastSlerp(n,i,a,he);return J.fastSlerp(s,u,2*a*(1-a),o)},J.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.x===r.x&&e.y===r.y&&e.z===r.z&&e.w===r.w},J.equalsEpsilon=function(e,r,n){return n=t.defaultValue(n,0),e===r||t.defined(e)&&t.defined(r)&&Math.abs(e.x-r.x)<=n&&Math.abs(e.y-r.y)<=n&&Math.abs(e.z-r.z)<=n&&Math.abs(e.w-r.w)<=n},J.ZERO=Object.freeze(new J(0,0,0,0)),J.IDENTITY=Object.freeze(new J(0,0,0,1)),J.prototype.clone=function(e){return J.clone(this,e)},J.prototype.equals=function(e){return J.equals(this,e)},J.prototype.equalsEpsilon=function(e,t){return J.equalsEpsilon(this,e,t)},J.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var Se={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5},Re=Object.freeze(Se),Te={UTC:0,TAI:1},Me=Object.freeze(Te),Ie=new De,Pe=[31,28,31,30,31,30,31,31,30,31,30,31],Ue=29;function Ne(e,t){return Ke.compare(e.julianDate,t.julianDate)}var Fe=new Ae;function ke(e){Fe.julianDate=e;var t=Ke.leapSeconds,r=_e(t,Fe,Ne);r<0&&(r=~r),r>=t.length&&(r=t.length-1);var n=t[r].offset;if(r>0){var i=Ke.secondsDifference(t[r].julianDate,e);i>n&&(r--,n=t[r].offset)}Ke.addSeconds(e,n,e)}function je(e,t){Fe.julianDate=e;var r=Ke.leapSeconds,n=_e(r,Fe,Ne);if(n<0&&(n=~n),0===n)return Ke.addSeconds(e,-r[0].offset,t);if(n>=r.length)return Ke.addSeconds(e,-r[n-1].offset,t);var i=Ke.secondsDifference(r[n].julianDate,e);return 0===i?Ke.addSeconds(e,-r[n].offset,t):i<=1?void 0:Ke.addSeconds(e,-r[--n].offset,t)}function ze(e,t,r){var n=t/Re.SECONDS_PER_DAY|0;return e+=n,t-=Re.SECONDS_PER_DAY*n,t<0&&(e--,t+=Re.SECONDS_PER_DAY),r.dayNumber=e,r.secondsOfDay=t,r}function Le(e,t,r,n,i,a,o){var s=(t-14)/12|0,u=e+4800+s,l=(1461*u/4|0)+(367*(t-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+r-32075;n-=12,n<0&&(n+=24);var f=a+(n*Re.SECONDS_PER_HOUR+i*Re.SECONDS_PER_MINUTE+o*Re.SECONDS_PER_MILLISECOND);return f>=43200&&(l-=1),[l,f]}var Ve=/^(\d{4})$/,Be=/^(\d{4})-(\d{2})$/,We=/^(\d{4})-?(\d{3})$/,Ye=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,He=/^(\d{4})-?(\d{2})-?(\d{2})$/,Je=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Xe=/^(\d{2})(\.\d+)?/.source+Je.source,Ge=/^(\d{2}):?(\d{2})(\.\d+)?/.source+Je.source,Ze=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+Je.source,Qe="Invalid ISO 8601 date.";function Ke(e,r,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=t.defaultValue(e,0),r=t.defaultValue(r,0),n=t.defaultValue(n,Me.UTC);var i=0|e;r+=(e-i)*Re.SECONDS_PER_DAY,ze(i,r,this),n===Me.UTC&&ke(this)}Ke.fromGregorianDate=function(e,n){if(!(e instanceof De))throw new r.DeveloperError("date must be a valid GregorianDate.");var i=Le(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return t.defined(n)?(ze(i[0],i[1],n),ke(n),n):new Ke(i[0],i[1],Me.UTC)},Ke.fromDate=function(e,n){if(!(e instanceof Date)||isNaN(e.getTime()))throw new r.DeveloperError("date must be a valid JavaScript Date.");var i=Le(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return t.defined(n)?(ze(i[0],i[1],n),ke(n),n):new Ke(i[0],i[1],Me.UTC)},Ke.fromIso8601=function(e,n){if("string"!==typeof e)throw new r.DeveloperError(Qe);e=e.replace(",",".");var i,a,o,s,u,l=e.split("T"),f=1,d=1,c=0,h=0,p=0,m=0,y=l[0],v=l[1];if(!t.defined(y))throw new r.DeveloperError(Qe);if(l=y.match(He),null!==l){if(s=y.split("-").length-1,s>0&&2!==s)throw new r.DeveloperError(Qe);i=+l[1],f=+l[2],d=+l[3]}else if(l=y.match(Be),null!==l)i=+l[1],f=+l[2];else if(l=y.match(Ve),null!==l)i=+l[1];else{var w;if(l=y.match(We),null!==l){if(i=+l[1],w=+l[2],o=qe(i),w<1||o&&w>366||!o&&w>365)throw new r.DeveloperError(Qe)}else{if(l=y.match(Ye),null===l)throw new r.DeveloperError(Qe);i=+l[1];var C=+l[2],g=+l[3]||0;if(s=y.split("-").length-1,s>0&&(!t.defined(l[3])&&1!==s||t.defined(l[3])&&2!==s))throw new r.DeveloperError(Qe);var E=new Date(Date.UTC(i,0,4));w=7*C+g-E.getUTCDay()-3}a=new Date(Date.UTC(i,0,1)),a.setUTCDate(w),f=a.getUTCMonth()+1,d=a.getUTCDate()}if(o=qe(i),f<1||f>12||d<1||(2!==f||!o)&&d>Pe[f-1]||o&&2===f&&d>Ue)throw new r.DeveloperError(Qe);if(t.defined(v)){if(l=v.match(Ze),null!==l){if(s=v.split(":").length-1,s>0&&2!==s&&3!==s)throw new r.DeveloperError(Qe);c=+l[1],h=+l[2],p=+l[3],m=1e3*+(l[4]||0),u=5}else if(l=v.match(Ge),null!==l){if(s=v.split(":").length-1,s>2)throw new r.DeveloperError(Qe);c=+l[1],h=+l[2],p=60*+(l[3]||0),u=4}else{if(l=v.match(Xe),null===l)throw new r.DeveloperError(Qe);c=+l[1],h=60*+(l[2]||0),u=3}if(h>=60||p>=61||c>24||24===c&&(h>0||p>0||m>0))throw new r.DeveloperError(Qe);var O=l[u],_=+l[u+1],x=+(l[u+2]||0);switch(O){case"+":c-=_,h-=x;break;case"-":c+=_,h+=x;break;case"Z":break;default:h+=new Date(Date.UTC(i,f-1,d,c,h)).getTimezoneOffset();break}}var b=60===p;b&&p--;while(h>=60)h-=60,c++;while(c>=24)c-=24,d++;a=o&&2===f?Ue:Pe[f-1];while(d>a)d-=a,f++,f>12&&(f-=12,i++),a=o&&2===f?Ue:Pe[f-1];while(h<0)h+=60,c--;while(c<0)c+=24,d--;while(d<1)f--,f<1&&(f+=12,i--),a=o&&2===f?Ue:Pe[f-1],d+=a;var D=Le(i,f,d,c,h,p,m);return t.defined(n)?(ze(D[0],D[1],n),ke(n)):n=new Ke(D[0],D[1],Me.UTC),b&&Ke.addSeconds(n,1,n),n},Ke.now=function(e){return Ke.fromDate(new Date,e)};var $e=new Ke(0,0,Me.TAI);function et(e){if(e instanceof et)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=tt.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}Ke.toGregorianDate=function(e,n){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var i=!1,a=je(e,$e);t.defined(a)||(Ke.addSeconds(e,-1,$e),a=je($e,$e),i=!0);var o=a.dayNumber,s=a.secondsOfDay;s>=43200&&(o+=1);var u=o+68569|0,l=4*u/146097|0;u=u-((146097*l+3)/4|0)|0;var f=4e3*(u+1)/1461001|0;u=u-(1461*f/4|0)+31|0;var d=80*u/2447|0,c=u-(2447*d/80|0)|0;u=d/11|0;var h=d+2-12*u|0,p=100*(l-49)+f+u|0,m=s/Re.SECONDS_PER_HOUR|0,y=s-m*Re.SECONDS_PER_HOUR,v=y/Re.SECONDS_PER_MINUTE|0;y-=v*Re.SECONDS_PER_MINUTE;var w=0|y,C=(y-w)/Re.SECONDS_PER_MILLISECOND;return m+=12,m>23&&(m-=24),i&&(w+=1),t.defined(n)?(n.year=p,n.month=h,n.day=c,n.hour=m,n.minute=v,n.second=w,n.millisecond=C,n.isLeapSecond=i,n):new De(p,h,c,m,v,w,C,i)},Ke.toDate=function(e){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var n=Ke.toGregorianDate(e,Ie),i=n.second;return n.isLeapSecond&&(i-=1),new Date(Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,i,n.millisecond))},Ke.toIso8601=function(e,n){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var i,a=Ke.toGregorianDate(e,Ie),o=a.year,s=a.month,u=a.day,l=a.hour,f=a.minute,d=a.second,c=a.millisecond;return 1e4===o&&1===s&&1===u&&0===l&&0===f&&0===d&&0===c&&(o=9999,s=12,u=31,l=24),t.defined(n)||0===c?t.defined(n)&&0!==n?(i=(.01*c).toFixed(n).replace(".","").slice(0,n),be("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",o,s,u,l,f,d,i)):be("%04d-%02d-%02dT%02d:%02d:%02dZ",o,s,u,l,f,d):(i=(.01*c).toString().replace(".",""),be("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",o,s,u,l,f,d,i))},Ke.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.dayNumber=e.dayNumber,r.secondsOfDay=e.secondsOfDay,r):new Ke(e.dayNumber,e.secondsOfDay,Me.TAI)},Ke.compare=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");var i=e.dayNumber-n.dayNumber;return 0!==i?i:e.secondsOfDay-n.secondsOfDay},Ke.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.dayNumber===r.dayNumber&&e.secondsOfDay===r.secondsOfDay},Ke.equalsEpsilon=function(e,r,n){return n=t.defaultValue(n,0),e===r||t.defined(e)&&t.defined(r)&&Math.abs(Ke.secondsDifference(e,r))<=n},Ke.totalDays=function(e){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");return e.dayNumber+e.secondsOfDay/Re.SECONDS_PER_DAY},Ke.secondsDifference=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");var i=(e.dayNumber-n.dayNumber)*Re.SECONDS_PER_DAY;return i+(e.secondsOfDay-n.secondsOfDay)},Ke.daysDifference=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");var i=e.dayNumber-n.dayNumber,a=(e.secondsOfDay-n.secondsOfDay)/Re.SECONDS_PER_DAY;return i+a},Ke.computeTaiMinusUtc=function(e){Fe.julianDate=e;var t=Ke.leapSeconds,r=_e(t,Fe,Ne);return r<0&&(r=~r,--r,r<0&&(r=0)),t[r].offset},Ke.addSeconds=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("seconds is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");return ze(e.dayNumber,e.secondsOfDay+n,i)},Ke.addMinutes=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("minutes is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var a=e.secondsOfDay+n*Re.SECONDS_PER_MINUTE;return ze(e.dayNumber,a,i)},Ke.addHours=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("hours is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var a=e.secondsOfDay+n*Re.SECONDS_PER_HOUR;return ze(e.dayNumber,a,i)},Ke.addDays=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("days is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var a=e.dayNumber+n;return ze(a,e.secondsOfDay,i)},Ke.lessThan=function(e,t){return Ke.compare(e,t)<0},Ke.lessThanOrEquals=function(e,t){return Ke.compare(e,t)<=0},Ke.greaterThan=function(e,t){return Ke.compare(e,t)>0},Ke.greaterThanOrEquals=function(e,t){return Ke.compare(e,t)>=0},Ke.prototype.clone=function(e){return Ke.clone(this,e)},Ke.prototype.equals=function(e){return Ke.equals(this,e)},Ke.prototype.equalsEpsilon=function(e,t){return Ke.equalsEpsilon(this,e,t)},Ke.prototype.toString=function(){return Ke.toIso8601(this)},Ke.leapSeconds=[new Ae(new Ke(2441317,43210,Me.TAI),10),new Ae(new Ke(2441499,43211,Me.TAI),11),new Ae(new Ke(2441683,43212,Me.TAI),12),new Ae(new Ke(2442048,43213,Me.TAI),13),new Ae(new Ke(2442413,43214,Me.TAI),14),new Ae(new Ke(2442778,43215,Me.TAI),15),new Ae(new Ke(2443144,43216,Me.TAI),16),new Ae(new Ke(2443509,43217,Me.TAI),17),new Ae(new Ke(2443874,43218,Me.TAI),18),new Ae(new Ke(2444239,43219,Me.TAI),19),new Ae(new Ke(2444786,43220,Me.TAI),20),new Ae(new Ke(2445151,43221,Me.TAI),21),new Ae(new Ke(2445516,43222,Me.TAI),22),new Ae(new Ke(2446247,43223,Me.TAI),23),new Ae(new Ke(2447161,43224,Me.TAI),24),new Ae(new Ke(2447892,43225,Me.TAI),25),new Ae(new Ke(2448257,43226,Me.TAI),26),new Ae(new Ke(2448804,43227,Me.TAI),27),new Ae(new Ke(2449169,43228,Me.TAI),28),new Ae(new Ke(2449534,43229,Me.TAI),29),new Ae(new Ke(2450083,43230,Me.TAI),30),new Ae(new Ke(2450630,43231,Me.TAI),31),new Ae(new Ke(2451179,43232,Me.TAI),32),new Ae(new Ke(2453736,43233,Me.TAI),33),new Ae(new Ke(2454832,43234,Me.TAI),34),new Ae(new Ke(2456109,43235,Me.TAI),35),new Ae(new Ke(2457204,43236,Me.TAI),36),new Ae(new Ke(2457754,43237,Me.TAI),37)],et.prototype.scheme=null,et.prototype.authority=null,et.prototype.path="",et.prototype.query=null,et.prototype.fragment=null;var tt=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");et.prototype.getScheme=function(){return this.scheme},et.prototype.getAuthority=function(){return this.authority},et.prototype.getPath=function(){return this.path},et.prototype.getQuery=function(){return this.query},et.prototype.getFragment=function(){return this.fragment},et.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},et.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},et.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},et.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(it,ot).replace(rt,at)),this.path&&(this.path=this.path.replace(rt,at)),this.query&&(this.query=this.query.replace(rt,at)),this.fragment&&(this.fragment=this.fragment.replace(rt,at))};var rt=/%[0-9a-z]{2}/gi,nt=/[a-zA-Z0-9\-\._~]/,it=/(.*@)?([^@:]*)(:.*)?/;function at(e){var t=unescape(e);return nt.test(t)?t:e.toUpperCase()}function ot(e,t,r,n){return(t||"")+r.toLowerCase()+(n||"")}function st(e){return 0!==e.length&&"/"===e[e.length-1]||(e+="/"),e}function ut(e,r){if(null===e||"object"!==typeof e)return e;r=t.defaultValue(r,!1);var n=new e.constructor;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];r&&(a=ut(a,r)),n[i]=a}return n}function lt(e,r,n){n=t.defaultValue(n,!1);var i,a,o,s={},u=t.defined(e),l=t.defined(r);if(u)for(i in e)e.hasOwnProperty(i)&&(a=e[i],l&&n&&"object"===typeof a&&r.hasOwnProperty(i)?(o=r[i],s[i]="object"===typeof o?lt(a,o,n):a):s[i]=a);if(l)for(i in r)r.hasOwnProperty(i)&&!s.hasOwnProperty(i)&&(o=r[i],s[i]=o);return s}function ft(e,t){var r;return"undefined"!==typeof document&&(r=document),ft._implementation(e,t,r)}function dt(e,n){if(!t.defined(e))throw new r.DeveloperError("uri is required.");var i="",a=e.lastIndexOf("/");return-1!==a&&(i=e.substring(0,a+1)),n?(e=new et(e),t.defined(e.query)&&(i+="?"+e.query),t.defined(e.fragment)&&(i+="#"+e.fragment),i):i}function ct(e){if(!t.defined(e))throw new r.DeveloperError("uri is required.");var n=new et(e);n.normalize();var i=n.path,a=i.lastIndexOf("/");return-1!==a&&(i=i.substr(a+1)),a=i.lastIndexOf("."),i=-1===a?"":i.substr(a+1),i}et.prototype.resolve=function(e){var t=new et;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},et.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],n=""==t[0];n&&t.shift(),""==t[0]&&t.shift();while(t.length)e=t.shift(),".."==e?r.pop():"."!=e&&r.push(e);"."!=e&&".."!=e||r.push(""),n&&r.unshift(""),this.path=r.join("/")},et.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},ft._implementation=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("relative uri is required.");if(!t.defined(n)){if("undefined"===typeof i)return e;n=t.defaultValue(i.baseURI,i.location.href)}var a=new et(n),o=new et(e);return o.resolve(a).toString()};var ht,pt=/^blob:/i;function mt(e){return r.Check.typeOf.string("uri",e),pt.test(e)}function yt(e){t.defined(ht)||(ht=document.createElement("a")),ht.href=window.location.href;var r=ht.host,n=ht.protocol;return ht.href=e,ht.href=ht.href,n!==ht.protocol||r!==ht.host}var vt=/^data:/i;function wt(e){return r.Check.typeOf.string("uri",e),vt.test(e)}function Ct(e){var r=t.when.defer(),n=document.createElement("script");n.async=!0,n.src=e;var i=document.getElementsByTagName("head")[0];return n.onload=function(){n.onload=void 0,i.removeChild(n),r.resolve()},n.onerror=function(e){r.reject(e)},i.appendChild(n),r.promise}function gt(e){if(!t.defined(e))throw new r.DeveloperError("obj is required.");var n="";for(var i in e)if(e.hasOwnProperty(i)){var a=e[i],o=encodeURIComponent(i)+"=";if(Array.isArray(a))for(var s=0,u=a.length;s<u;++s)n+=o+encodeURIComponent(a[s])+"&";else n+=o+encodeURIComponent(a)+"&"}return n=n.slice(0,-1),n}function Et(e){if(!t.defined(e))throw new r.DeveloperError("queryString is required.");var n={};if(""===e)return n;for(var i=e.replace(/\+/g,"%20").split(/[&;]/),a=0,o=i.length;a<o;++a){var s=i[a].split("="),u=decodeURIComponent(s[0]),l=s[1];l=t.defined(l)?decodeURIComponent(l):"";var f=n[u];"string"===typeof f?n[u]=[f,l]:Array.isArray(f)?f.push(l):n[u]=l}return n}var Ot={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},_t=Object.freeze(Ot),xt={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},bt=Object.freeze(xt);function Dt(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var r=t.defaultValue(e.throttleByServer,!1),n=t.defaultValue(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=t.defaultValue(e.priority,0),this.throttle=n,this.throttleByServer=r,this.type=t.defaultValue(e.type,bt.OTHER),this.serverKey=void 0,this.state=_t.UNISSUED,this.deferred=void 0,this.cancelled=!1}function qt(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0;n<r.length;++n){var i=r[n],a=i.indexOf(": ");if(a>0){var o=i.substring(0,a),s=i.substring(a+2);t[o]=s}}return t}function At(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"===typeof this.responseHeaders&&(this.responseHeaders=qt(this.responseHeaders))}function St(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function Rt(e,t){return t-e}function Tt(e){r.Check.typeOf.object("options",e),r.Check.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function Mt(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function It(e,t){return e.priority-t.priority}Dt.prototype.cancel=function(){this.cancelled=!0},Dt.prototype.clone=function(e){return t.defined(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new Dt(this)},At.prototype.toString=function(){var e="Request has failed.";return t.defined(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},Object.defineProperties(St.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),St.prototype.addEventListener=function(e,t){r.Check.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var n=this;return function(){n.removeEventListener(e,t)}},St.prototype.removeEventListener=function(e,t){r.Check.typeOf.func("listener",e);for(var n=this._listeners,i=this._scopes,a=-1,o=0;o<n.length;o++)if(n[o]===e&&i[o]===t){a=o;break}return-1!==a&&(this._insideRaiseEvent?(this._toRemove.push(a),n[a]=void 0,i[a]=void 0):(n.splice(a,1),i.splice(a,1)),!0)},St.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var r=this._listeners,n=this._scopes,i=r.length;for(e=0;e<i;e++){var a=r[e];t.defined(a)&&r[e].apply(n[e],arguments)}var o=this._toRemove;if(i=o.length,i>0){for(o.sort(Rt),e=0;e<i;e++){var s=o[e];r.splice(s,1),n.splice(s,1)}o.length=0}this._insideRaiseEvent=!1},Object.defineProperties(Tt.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),Tt.prototype.reserve=function(e){e=t.defaultValue(e,this._length),this._array.length=e},Tt.prototype.heapify=function(e){e=t.defaultValue(e,0);var r=this._length,n=this._comparator,i=this._array,a=-1,o=!0;while(o){var s=2*(e+1),u=s-1;a=u<r&&n(i[u],i[e])<0?u:e,s<r&&n(i[s],i[a])<0&&(a=s),a!==e?(Mt(i,a,e),e=a):o=!1}},Tt.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},Tt.prototype.insert=function(e){r.Check.defined("element",e);var n,i=this._array,a=this._comparator,o=this._maximumLength,s=this._length++;s<i.length?i[s]=e:i.push(e);while(0!==s){var u=Math.floor((s-1)/2);if(!(a(i[s],i[u])<0))break;Mt(i,s,u),s=u}return t.defined(o)&&this._length>o&&(n=i[o],this._length=o),n},Tt.prototype.pop=function(e){if(e=t.defaultValue(e,0),0!==this._length){r.Check.typeOf.number.lessThan("index",e,this._length);var n=this._array,i=n[e];return Mt(n,e,--this._length),this.heapify(e),i}};var Pt={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},Ut=20,Nt=new Tt({comparator:It});Nt.maximumLength=Ut,Nt.reserve(Ut);var Ft=[],kt={},jt="undefined"!==typeof document?new et(document.location.href):new et,zt=new St;function Lt(){}function Vt(e){t.defined(e.priorityFunction)&&(e.priority=e.priorityFunction())}function Bt(e){var r=t.defaultValue(Lt.requestsByServer[e],Lt.maximumRequestsPerServer);return kt[e]<r}function Wt(e){return e.state===_t.UNISSUED&&(e.state=_t.ISSUED,e.deferred=t.when.defer()),e.deferred.promise}function Yt(e){return function(t){e.state!==_t.CANCELLED&&(--Pt.numberOfActiveRequests,--kt[e.serverKey],zt.raiseEvent(),e.state=_t.RECEIVED,e.deferred.resolve(t))}}function Ht(e){return function(t){e.state!==_t.CANCELLED&&(++Pt.numberOfFailedRequests,--Pt.numberOfActiveRequests,--kt[e.serverKey],zt.raiseEvent(t),e.state=_t.FAILED,e.deferred.reject(t))}}function Jt(e){var t=Wt(e);return e.state=_t.ACTIVE,Ft.push(e),++Pt.numberOfActiveRequests,++Pt.numberOfActiveRequestsEver,++kt[e.serverKey],e.requestFunction().then(Yt(e)).otherwise(Ht(e)),t}function Xt(e){var r=e.state===_t.ACTIVE;e.state=_t.CANCELLED,++Pt.numberOfCancelledRequests,e.deferred.reject(),r&&(--Pt.numberOfActiveRequests,--kt[e.serverKey],++Pt.numberOfCancelledActiveRequests),t.defined(e.cancelFunction)&&e.cancelFunction()}function Gt(){Lt.debugShowStatistics&&(0===Pt.numberOfActiveRequests&&Pt.lastNumberOfActiveRequests>0&&(Pt.numberOfAttemptedRequests>0&&(console.log("Number of attempted requests: "+Pt.numberOfAttemptedRequests),Pt.numberOfAttemptedRequests=0),Pt.numberOfCancelledRequests>0&&(console.log("Number of cancelled requests: "+Pt.numberOfCancelledRequests),Pt.numberOfCancelledRequests=0),Pt.numberOfCancelledActiveRequests>0&&(console.log("Number of cancelled active requests: "+Pt.numberOfCancelledActiveRequests),Pt.numberOfCancelledActiveRequests=0),Pt.numberOfFailedRequests>0&&(console.log("Number of failed requests: "+Pt.numberOfFailedRequests),Pt.numberOfFailedRequests=0)),Pt.lastNumberOfActiveRequests=Pt.numberOfActiveRequests)}Lt.maximumRequests=50,Lt.maximumRequestsPerServer=6,Lt.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},Lt.throttleRequests=!0,Lt.debugShowStatistics=!1,Lt.requestCompletedEvent=zt,Object.defineProperties(Lt,{statistics:{get:function(){return Pt}},priorityHeapLength:{get:function(){return Ut},set:function(e){if(e<Ut)while(Nt.length>e){var t=Nt.pop();Xt(t)}Ut=e,Nt.maximumLength=e,Nt.reserve(e)}}}),Lt.update=function(){var e,t,r=0,n=Ft.length;for(e=0;e<n;++e)t=Ft[e],t.cancelled&&Xt(t),t.state===_t.ACTIVE?r>0&&(Ft[e-r]=t):++r;Ft.length-=r;var i=Nt.internalArray,a=Nt.length;for(e=0;e<a;++e)Vt(i[e]);Nt.resort();var o=Math.max(Lt.maximumRequests-Ft.length,0),s=0;while(s<o&&Nt.length>0)t=Nt.pop(),t.cancelled?Xt(t):!t.throttleByServer||Bt(t.serverKey)?(Jt(t),++s):Xt(t);Gt()},Lt.getServerKey=function(e){r.Check.typeOf.string("url",e);var n=new et(e).resolve(jt);n.normalize();var i=n.authority;/:/.test(i)||(i=i+":"+("https"===n.scheme?"443":"80"));var a=kt[i];return t.defined(a)||(kt[i]=0),i},Lt.request=function(e){if(r.Check.typeOf.object("request",e),r.Check.typeOf.string("request.url",e.url),r.Check.typeOf.func("request.requestFunction",e.requestFunction),wt(e.url)||mt(e.url))return zt.raiseEvent(),e.state=_t.RECEIVED,e.requestFunction();if(++Pt.numberOfAttemptedRequests,t.defined(e.serverKey)||(e.serverKey=Lt.getServerKey(e.url)),!Lt.throttleRequests||!e.throttleByServer||Bt(e.serverKey)){if(!Lt.throttleRequests||!e.throttle)return Jt(e);if(!(Ft.length>=Lt.maximumRequests)){Vt(e);var n=Nt.insert(e);if(t.defined(n)){if(n===e)return;Xt(n)}return Wt(e)}}},Lt.clearForSpecs=function(){while(Nt.length>0){var e=Nt.pop();Xt(e)}for(var t=Ft.length,r=0;r<t;++r)Xt(Ft[r]);Ft.length=0,kt={},Pt.numberOfAttemptedRequests=0,Pt.numberOfActiveRequests=0,Pt.numberOfCancelledRequests=0,Pt.numberOfCancelledActiveRequests=0,Pt.numberOfFailedRequests=0,Pt.numberOfActiveRequestsEver=0,Pt.lastNumberOfActiveRequests=0},Lt.numberOfActiveRequestsByServer=function(e){return kt[e]},Lt.requestHeap=Nt;var Zt={},Qt={};function Kt(e){var r=new et(e);r.normalize();var n=r.getAuthority();if(t.defined(n)){if(-1!==n.indexOf("@")){var i=n.split("@");n=i[1]}if(-1===n.indexOf(":")){var a=r.getScheme();if(t.defined(a)||(a=window.location.protocol,a=a.substring(0,a.length-1)),"http"===a)n+=":80";else{if("https"!==a)return;n+=":443"}}return n}}Zt.add=function(e,n){if(!t.defined(e))throw new r.DeveloperError("host is required.");if(!t.defined(n)||n<=0)throw new r.DeveloperError("port is required to be greater than 0.");var i=e.toLowerCase()+":"+n;t.defined(Qt[i])||(Qt[i]=!0)},Zt.remove=function(e,n){if(!t.defined(e))throw new r.DeveloperError("host is required.");if(!t.defined(n)||n<=0)throw new r.DeveloperError("port is required to be greater than 0.");var i=e.toLowerCase()+":"+n;t.defined(Qt[i])&&delete Qt[i]},Zt.contains=function(e){if(!t.defined(e))throw new r.DeveloperError("url is required.");var n=Kt(e);return!(!t.defined(n)||!t.defined(Qt[n]))},Zt.clear=function(){Qt={}};var $t,er=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(t){return!1}}();function tr(e,r,n,i){var a,o=e.query;if(!t.defined(o)||0===o.length)return{};if(-1===o.indexOf("=")){var s={};s[o]=void 0,a=s}else a=Et(o);r._queryParameters=n?ar(a,r._queryParameters,i):a,e.query=void 0}function rr(e,r){var n=r._queryParameters,i=Object.keys(n);1!==i.length||t.defined(n[i[0]])?e.query=gt(n):e.query=i[0]}function nr(e,r){return t.defined(e)?t.defined(e.clone)?e.clone():ut(e):r}function ir(e){if(e.state===_t.ISSUED||e.state===_t.ACTIVE)throw new o.RuntimeError("The Resource is already being fetched.");e.state=_t.UNISSUED,e.deferred=void 0}function ar(e,r,n){if(!n)return lt(e,r);var i=ut(e,!0);for(var a in r)if(r.hasOwnProperty(a)){var o=i[a],s=r[a];t.defined(o)?(Array.isArray(o)||(o=i[a]=[o]),i[a]=o.concat(s)):i[a]=Array.isArray(s)?s.slice():s}return i}function or(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),"string"===typeof e&&(e={url:e}),r.Check.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=nr(e.templateValues,{}),this._queryParameters=nr(e.queryParameters,{}),this.headers=nr(e.headers,{}),this.request=t.defaultValue(e.request,new Dt),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=t.defaultValue(e.retryAttempts,0),this._retryCount=0;var n=new et(e.url);tr(n,this,!0,!0),n.fragment=void 0,this._url=n.toString()}function sr(e){var r=e.resource,n=e.flipY,i=e.preferImageBitmap,a=r.request;a.url=r.url,a.requestFunction=function(){var e=!1;r.isDataUri||r.isBlobUri||(e=r.isCrossOriginUrl);var o=t.when.defer();return or._Implementations.createImage(a,e,o,n,i),o.promise};var o=Lt.request(a);if(t.defined(o))return o.otherwise((function(e){return a.state!==_t.FAILED?t.when.reject(e):r.retryOnError(e).then((function(o){return o?(a.state=_t.UNISSUED,a.deferred=void 0,sr({resource:r,flipY:n,preferImageBitmap:i})):t.when.reject(e)}))}))}function ur(e,r,n){var i={};i[r]=n,e.setQueryParameters(i);var a=e.request;a.url=e.url,a.requestFunction=function(){var r=t.when.defer();return window[n]=function(e){r.resolve(e);try{delete window[n]}catch(t){window[n]=void 0}},or._Implementations.loadAndExecuteScript(e.url,n,r),r.promise};var o=Lt.request(a);if(t.defined(o))return o.otherwise((function(i){return a.state!==_t.FAILED?t.when.reject(i):e.retryOnError(i).then((function(o){return o?(a.state=_t.UNISSUED,a.deferred=void 0,ur(e,r,n)):t.when.reject(i)}))}))}or.createIfNeeded=function(e){return e instanceof or?e.getDerivedResource({request:e.request}):"string"!==typeof e?e:new or({url:e})},or.supportsImageBitmapOptions=function(){if(t.defined($t))return $t;if("function"!==typeof createImageBitmap)return $t=t.when.resolve(!1),$t;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWP4////fwAJ+wP9CNHoHgAAAABJRU5ErkJggg==";return $t=or.fetchBlob({url:e}).then((function(e){return createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none"})})).then((function(e){return!0})).otherwise((function(){return!1})),$t},Object.defineProperties(or,{isBlobSupported:{get:function(){return er}}}),Object.defineProperties(or.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new et(e);tr(t,this,!1),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return ct(this._url)}},isDataUri:{get:function(){return wt(this._url)}},isBlobUri:{get:function(){return mt(this._url)}},isCrossOriginUrl:{get:function(){return yt(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),or.prototype.getUrlComponent=function(e,r){if(this.isDataUri)return this._url;var n=new et(this._url);e&&rr(n,this);var i=n.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),a=this._templateValues;return i=i.replace(/{(.*?)}/g,(function(e,r){var n=a[r];return t.defined(n)?encodeURIComponent(n):e})),r&&t.defined(this.proxy)&&(i=this.proxy.getURL(i)),i},or.prototype.setQueryParameters=function(e,t){this._queryParameters=t?ar(this._queryParameters,e,!1):ar(e,this._queryParameters,!1)},or.prototype.appendQueryParameters=function(e){this._queryParameters=ar(e,this._queryParameters,!0)},or.prototype.setTemplateValues=function(e,t){this._templateValues=t?lt(this._templateValues,e):lt(e,this._templateValues)},or.prototype.getDerivedResource=function(e){var r=this.clone();if(r._retryCount=0,t.defined(e.url)){var n=new et(e.url),i=t.defaultValue(e.preserveQueryParameters,!1);tr(n,r,!0,i),n.fragment=void 0,r._url=n.resolve(new et(ft(this._url))).toString()}return t.defined(e.queryParameters)&&(r._queryParameters=lt(e.queryParameters,r._queryParameters)),t.defined(e.templateValues)&&(r._templateValues=lt(e.templateValues,r.templateValues)),t.defined(e.headers)&&(r.headers=lt(e.headers,r.headers)),t.defined(e.proxy)&&(r.proxy=e.proxy),t.defined(e.request)&&(r.request=e.request),t.defined(e.retryCallback)&&(r.retryCallback=e.retryCallback),t.defined(e.retryAttempts)&&(r.retryAttempts=e.retryAttempts),r},or.prototype.retryOnError=function(e){var r=this.retryCallback;if("function"!==typeof r||this._retryCount>=this.retryAttempts)return t.when(!1);var n=this;return t.when(r(this,e)).then((function(e){return++n._retryCount,e}))},or.prototype.clone=function(e){return t.defined(e)||(e=new or({url:this._url})),e._url=this._url,e._queryParameters=ut(this._queryParameters),e._templateValues=ut(this._templateValues),e.headers=ut(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},or.prototype.getBaseUri=function(e){return dt(this.getUrlComponent(e),e)},or.prototype.appendForwardSlash=function(){this._url=st(this._url)},or.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},or.fetchArrayBuffer=function(e){var t=new or(e);return t.fetchArrayBuffer()},or.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},or.fetchBlob=function(e){var t=new or(e);return t.fetchBlob()},or.prototype.fetchImage=function(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var r=t.defaultValue(e.preferImageBitmap,!1),n=t.defaultValue(e.preferBlob,!1),i=t.defaultValue(e.flipY,!1);if(ir(this.request),!er||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return sr({resource:this,flipY:i,preferImageBitmap:r});var a,o,s,u,l=this.fetchBlob();return t.defined(l)?or.supportsImageBitmapOptions().then((function(e){return a=e,o=a&&r,l})).then((function(e){if(t.defined(e)){if(u=e,o)return or.createImageBitmapFromBlob(e,{flipY:i,premultiplyAlpha:!1});var r=window.URL.createObjectURL(e);return s=new or({url:r}),sr({resource:s,flipY:i,preferImageBitmap:!1})}})).then((function(e){if(t.defined(e))return e.blob=u,o||window.URL.revokeObjectURL(s.url),e})).otherwise((function(e){return t.defined(s)&&window.URL.revokeObjectURL(s.url),e.blob=u,t.when.reject(e)})):void 0},or.fetchImage=function(e){var t=new or(e);return t.fetchImage({flipY:e.flipY,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},or.prototype.fetchText=function(){return this.fetch({responseType:"text"})},or.fetchText=function(e){var t=new or(e);return t.fetchText()},or.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(t.defined(e))return e.then((function(e){if(t.defined(e))return JSON.parse(e)}))},or.fetchJson=function(e){var t=new or(e);return t.fetchJson()},or.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},or.fetchXML=function(e){var t=new or(e);return t.fetchXML()},or.prototype.fetchJsonp=function(e){var r;e=t.defaultValue(e,"callback"),ir(this.request);do{r="loadJsonp"+Math.random().toString().substring(2,8)}while(t.defined(window[r]));return ur(this,e,r)},or.fetchJsonp=function(e){var t=new or(e);return t.fetchJsonp(e.callbackParameterName)},or.prototype._makeRequest=function(e){var r=this;ir(r.request);var n=r.request;n.url=r.url,n.requestFunction=function(){var i=e.responseType,a=lt(e.headers,r.headers),o=e.overrideMimeType,s=e.method,u=e.data,l=t.when.defer(),f=or._Implementations.loadWithXhr(r.url,i,s,u,a,l,o);return t.defined(f)&&t.defined(f.abort)&&(n.cancelFunction=function(){f.abort()}),l.promise};var i=Lt.request(n);if(t.defined(i))return i.then((function(e){return e})).otherwise((function(i){return n.state!==_t.FAILED?t.when.reject(i):r.retryOnError(i).then((function(a){return a?(n.state=_t.UNISSUED,n.deferred=void 0,r.fetch(e)):t.when.reject(i)}))}))};var lr=/^data:(.*?)(;base64)?,(.*)$/;function fr(e,t){var r=decodeURIComponent(t);return e?atob(r):r}function dr(e,t){for(var r=fr(e,t),n=new ArrayBuffer(r.length),i=new Uint8Array(n),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);return n}function cr(e,n){n=t.defaultValue(n,"");var i=e[1],a=!!e[2],o=e[3];switch(n){case"":case"text":return fr(a,o);case"arraybuffer":return dr(a,o);case"blob":var s=dr(a,o);return new Blob([s],{type:i});case"document":var u=new DOMParser;return u.parseFromString(fr(a,o),i);case"json":return JSON.parse(fr(a,o));default:throw new r.DeveloperError("Unhandled responseType: "+n)}}function hr(e,t,r){var n=new Image;n.onload=function(){r.resolve(n)},n.onerror=function(e){r.reject(e)},t&&(Zt.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e}function pr(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function mr(e,t,r,n,i,a,s){var u=require("url").parse(e),l="https:"===u.protocol?require("https"):require("http"),f=require("zlib"),d={protocol:u.protocol,hostname:u.hostname,port:u.port,path:u.path,query:u.query,method:r,headers:i};l.request(d).on("response",(function(e){if(e.statusCode<200||e.statusCode>=300)a.reject(new At(e.statusCode,e,e.headers));else{var r=[];e.on("data",(function(e){r.push(e)})),e.on("end",(function(){var n=Buffer.concat(r);"gzip"===e.headers["content-encoding"]?f.gunzip(n,(function(e,r){e?a.reject(new o.RuntimeError("Error decompressing response.")):a.resolve(pr(r,t))})):a.resolve(pr(n,t))}))}})).on("error",(function(e){a.reject(new At)})).end()}or.prototype.fetch=function(e){return e=nr(e,{}),e.method="GET",this._makeRequest(e)},or.fetch=function(e){var t=new or(e);return t.fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},or.prototype.delete=function(e){return e=nr(e,{}),e.method="DELETE",this._makeRequest(e)},or.delete=function(e){var t=new or(e);return t.delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},or.prototype.head=function(e){return e=nr(e,{}),e.method="HEAD",this._makeRequest(e)},or.head=function(e){var t=new or(e);return t.head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},or.prototype.options=function(e){return e=nr(e,{}),e.method="OPTIONS",this._makeRequest(e)},or.options=function(e){var t=new or(e);return t.options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},or.prototype.post=function(e,t){return r.Check.defined("data",e),t=nr(t,{}),t.method="POST",t.data=e,this._makeRequest(t)},or.post=function(e){var t=new or(e);return t.post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},or.prototype.put=function(e,t){return r.Check.defined("data",e),t=nr(t,{}),t.method="PUT",t.data=e,this._makeRequest(t)},or.put=function(e){var t=new or(e);return t.put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},or.prototype.patch=function(e,t){return r.Check.defined("data",e),t=nr(t,{}),t.method="PATCH",t.data=e,this._makeRequest(t)},or.patch=function(e){var t=new or(e);return t.patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},or._Implementations={},or._Implementations.createImage=function(e,r,n,i,a){var s=e.url;or.supportsImageBitmapOptions().then((function(u){if(u&&a){var l="blob",f="GET",d=t.when.defer(),c=or._Implementations.loadWithXhr(s,l,f,void 0,void 0,d,void 0,void 0,void 0);return t.defined(c)&&t.defined(c.abort)&&(e.cancelFunction=function(){c.abort()}),d.promise.then((function(e){if(t.defined(e))return or.createImageBitmapFromBlob(e,{flipY:i,premultiplyAlpha:!1});n.reject(new o.RuntimeError("Successfully retrieved "+s+" but it contained no content."))})).then(n.resolve)}hr(s,r,n)})).otherwise(n.reject)},or.createImageBitmapFromBlob=function(e,t){return r.Check.defined("options",t),r.Check.typeOf.bool("options.flipY",t.flipY),r.Check.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none"})};var yr="undefined"===typeof XMLHttpRequest;function vr(e){if(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=t.defaultValue(e.addNewLeapSeconds,!0),t.defined(e.data))Cr(this,e.data);else if(t.defined(e.url)){var r=or.createIfNeeded(e.url),n=this;this._downloadPromise=t.when(r.fetchJson(),(function(e){Cr(n,e)}),(function(){n._dataError="An error occurred while retrieving the EOP data from the URL "+r.url+"."}))}else Cr(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function wr(e,t){return Ke.compare(e.julianDate,t)}function Cr(e,r){if(t.defined(r.columnNames))if(t.defined(r.samples)){var n=r.columnNames.indexOf("modifiedJulianDateUtc"),i=r.columnNames.indexOf("xPoleWanderRadians"),a=r.columnNames.indexOf("yPoleWanderRadians"),o=r.columnNames.indexOf("ut1MinusUtcSeconds"),s=r.columnNames.indexOf("xCelestialPoleOffsetRadians"),u=r.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=r.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||i<0||a<0||o<0||s<0||u<0||l<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var f,d=e._samples=r.samples,c=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=i,e._yPoleWanderRadiansColumn=a,e._ut1MinusUtcSecondsColumn=o,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=u,e._taiMinusUtcSecondsColumn=l,e._columnCount=r.columnNames.length,e._lastIndex=void 0;for(var h=e._addNewLeapSeconds,p=0,m=d.length;p<m;p+=e._columnCount){var y=d[p+n],v=d[p+l],w=y+Re.MODIFIED_JULIAN_DATE_DIFFERENCE,C=new Ke(w,v,Me.TAI);if(c.push(C),h){if(v!==f&&t.defined(f)){var g=Ke.leapSeconds,E=_e(g,C,wr);if(E<0){var O=new Ae(C,v);g.splice(~E,0,O)}}f=v}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function gr(e,t,r,n,i){var a=r*n;i.xPoleWander=t[a+e._xPoleWanderRadiansColumn],i.yPoleWander=t[a+e._yPoleWanderRadiansColumn],i.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn],i.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn],i.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function Er(e,t,r){return t+e*(r-t)}function Or(e,t,r,n,i,a,o){var s=e._columnCount;if(a>t.length-1)return o.xPoleWander=0,o.yPoleWander=0,o.xPoleOffset=0,o.yPoleOffset=0,o.ut1MinusUtc=0,o;var u=t[i],l=t[a];if(u.equals(l)||n.equals(u))return gr(e,r,i,s,o),o;if(n.equals(l))return gr(e,r,a,s,o),o;var f=Ke.secondsDifference(n,u)/Ke.secondsDifference(l,u),d=i*s,c=a*s,h=r[d+e._ut1MinusUtcSecondsColumn],p=r[c+e._ut1MinusUtcSecondsColumn],m=p-h;if(m>.5||m<-.5){var y=r[d+e._taiMinusUtcSecondsColumn],v=r[c+e._taiMinusUtcSecondsColumn];y!==v&&(l.equals(n)?h=p:p-=v-y)}return o.xPoleWander=Er(f,r[d+e._xPoleWanderRadiansColumn],r[c+e._xPoleWanderRadiansColumn]),o.yPoleWander=Er(f,r[d+e._yPoleWanderRadiansColumn],r[c+e._yPoleWanderRadiansColumn]),o.xPoleOffset=Er(f,r[d+e._xCelestialPoleOffsetRadiansColumn],r[c+e._xCelestialPoleOffsetRadiansColumn]),o.yPoleOffset=Er(f,r[d+e._yCelestialPoleOffsetRadiansColumn],r[c+e._yCelestialPoleOffsetRadiansColumn]),o.ut1MinusUtc=Er(f,h,p),o}function _r(e,r,n){this.heading=t.defaultValue(e,0),this.pitch=t.defaultValue(r,0),this.roll=t.defaultValue(n,0)}or._Implementations.loadWithXhr=function(e,r,n,i,a,s,u){var l=lr.exec(e);if(null===l){if(!yr){var f=new XMLHttpRequest;if(Zt.contains(e)&&(f.withCredentials=!0),f.open(n,e,!0),t.defined(u)&&t.defined(f.overrideMimeType)&&f.overrideMimeType(u),t.defined(a))for(var d in a)a.hasOwnProperty(d)&&f.setRequestHeader(d,a[d]);t.defined(r)&&(f.responseType=r);var c=!1;return"string"===typeof e&&(c=0===e.indexOf("file://")||"undefined"!==typeof window&&"file://"===window.location.origin),f.onload=function(){if(!(f.status<200||f.status>=300)||c&&0===f.status){var e=f.response,i=f.responseType;if("HEAD"===n||"OPTIONS"===n){var a=f.getAllResponseHeaders(),u=a.trim().split(/[\r\n]+/),l={};return u.forEach((function(e){var t=e.split(": "),r=t.shift();l[r]=t.join(": ")})),void s.resolve(l)}if(204===f.status)s.resolve();else if(!t.defined(e)||t.defined(r)&&i!==r)if("json"===r&&"string"===typeof e)try{s.resolve(JSON.parse(e))}catch(d){s.reject(d)}else(""===i||"document"===i)&&t.defined(f.responseXML)&&f.responseXML.hasChildNodes()?s.resolve(f.responseXML):""!==i&&"text"!==i||!t.defined(f.responseText)?s.reject(new o.RuntimeError("Invalid XMLHttpRequest response type.")):s.resolve(f.responseText);else s.resolve(e)}else s.reject(new At(f.status,f.response,f.getAllResponseHeaders()))},f.onerror=function(e){s.reject(new At)},f.send(i),f}mr(e,r,n,i,a,s)}else s.resolve(cr(l,r))},or._Implementations.loadAndExecuteScript=function(e,t,r){return Ct(e).otherwise(r.reject)},or._DefaultImplementations={},or._DefaultImplementations.createImage=or._Implementations.createImage,or._DefaultImplementations.loadWithXhr=or._Implementations.loadWithXhr,or._DefaultImplementations.loadAndExecuteScript=or._Implementations.loadAndExecuteScript,or.DEFAULT=Object.freeze(new or({url:"undefined"===typeof document?"":document.location.href.split("?")[0]})),vr.NONE=Object.freeze({getPromiseToLoad:function(){return t.when()},compute:function(e,r){return t.defined(r)?(r.xPoleWander=0,r.yPoleWander=0,r.xPoleOffset=0,r.yPoleOffset=0,r.ut1MinusUtc=0):r=new xe(0,0,0,0,0),r}}),vr.prototype.getPromiseToLoad=function(){return t.when(this._downloadPromise)},vr.prototype.compute=function(e,r){if(t.defined(this._samples)){if(t.defined(r)||(r=new xe(0,0,0,0,0)),0===this._samples.length)return r.xPoleWander=0,r.yPoleWander=0,r.xPoleOffset=0,r.yPoleOffset=0,r.ut1MinusUtc=0,r;var n=this._dates,i=this._lastIndex,a=0,s=0;if(t.defined(i)){var u=n[i],l=n[i+1],f=Ke.lessThanOrEquals(u,e),d=!t.defined(l),c=d||Ke.greaterThanOrEquals(l,e);if(f&&c)return a=i,!d&&l.equals(e)&&++a,s=a+1,Or(this,n,this._samples,e,a,s,r),r}var h=_e(n,e,Ke.compare,this._dateColumn);return h>=0?(h<n.length-1&&n[h+1].equals(e)&&++h,a=h,s=h):(s=~h,a=s-1,a<0&&(a=0)),this._lastIndex=a,Or(this,n,this._samples,e,a,s,r),r}if(t.defined(this._dataError))throw new o.RuntimeError(this._dataError)},_r.fromQuaternion=function(e,i){if(!t.defined(e))throw new r.DeveloperError("quaternion is required");t.defined(i)||(i=new _r);var a=2*(e.w*e.y-e.z*e.x),o=1-2*(e.x*e.x+e.y*e.y),s=2*(e.w*e.x+e.y*e.z),u=1-2*(e.y*e.y+e.z*e.z),l=2*(e.w*e.z+e.x*e.y);return i.heading=-Math.atan2(l,u),i.roll=Math.atan2(s,o),i.pitch=-n.CesiumMath.asinClamped(a),i},_r.fromDegrees=function(e,i,a,o){if(!t.defined(e))throw new r.DeveloperError("heading is required");if(!t.defined(i))throw new r.DeveloperError("pitch is required");if(!t.defined(a))throw new r.DeveloperError("roll is required");return t.defined(o)||(o=new _r),o.heading=e*n.CesiumMath.RADIANS_PER_DEGREE,o.pitch=i*n.CesiumMath.RADIANS_PER_DEGREE,o.roll=a*n.CesiumMath.RADIANS_PER_DEGREE,o},_r.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.heading=e.heading,r.pitch=e.pitch,r.roll=e.roll,r):new _r(e.heading,e.pitch,e.roll)},_r.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.heading===r.heading&&e.pitch===r.pitch&&e.roll===r.roll},_r.equalsEpsilon=function(e,r,i,a){return e===r||t.defined(e)&&t.defined(r)&&n.CesiumMath.equalsEpsilon(e.heading,r.heading,i,a)&&n.CesiumMath.equalsEpsilon(e.pitch,r.pitch,i,a)&&n.CesiumMath.equalsEpsilon(e.roll,r.roll,i,a)},_r.prototype.clone=function(e){return _r.clone(this,e)},_r.prototype.equals=function(e){return _r.equals(this,e)},_r.prototype.equalsEpsilon=function(e,t,r){return _r.equalsEpsilon(this,e,t,r)},_r.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};var xr,br,Dr,qr=/((?:.*\/)|^)Cesium\.js$/;function Ar(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var n=e[t].getAttribute("src"),i=qr.exec(n);if(null!==i)return i[1]}}function Sr(e){return"undefined"===typeof document?e:(t.defined(xr)||(xr=document.createElement("a")),xr.href=e,xr.href=xr.href,xr.href)}function Rr(){if(t.defined(br))return br;var e;if(e="undefined"!==typeof CESIUM_BASE_URL?CESIUM_BASE_URL:"object"===typeof define&&t.defined(define.amd)&&!define.amd.toUrlUndefined&&t.defined(require.toUrl)?ft("..",Ir("Core/buildModuleUrl.js")):Ar(),!t.defined(e))throw new r.DeveloperError("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return br=new or({url:Sr(e)}),br.appendForwardSlash(),br}function Tr(e){return Sr(require.toUrl("../"+e))}function Mr(e){var t=Rr().getDerivedResource({url:e});return t.url}function Ir(e){t.defined(Dr)||(Dr="object"===typeof define&&t.defined(define.amd)&&!define.amd.toUrlUndefined&&t.defined(require.toUrl)?Tr:Mr);var r=Dr(e);return r}function Pr(e,t,r){this.x=e,this.y=t,this.s=r}function Ur(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._xysFileUrlTemplate=or.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=t.defaultValue(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=t.defaultValue(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new Ke(this._sampleZeroJulianEphemerisDate,0,Me.TAI),this._stepSizeDays=t.defaultValue(e.stepSizeDays,1),this._samplesPerXysFile=t.defaultValue(e.samplesPerXysFile,1e3),this._totalSamples=t.defaultValue(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var r=this._interpolationOrder,n=this._denominators=new Array(r+1),i=this._xTable=new Array(r+1),a=Math.pow(this._stepSizeDays,r),o=0;o<=r;++o){n[o]=a,i[o]=o*this._stepSizeDays;for(var s=0;s<=r;++s)s!==o&&(n[o]*=o-s);n[o]=1/n[o]}this._work=new Array(r+1),this._coef=new Array(r+1)}Ir._cesiumScriptRegex=qr,Ir._buildModuleUrlFromBaseUrl=Mr,Ir._clearBaseResource=function(){br=void 0},Ir.setBaseUrl=function(e){br=or.DEFAULT.getDerivedResource({url:e})},Ir.getCesiumBaseUrl=Rr,Ir.getModUrl=function(e){return Ir(e)};var Nr=new Ke(0,0,Me.TAI);function Fr(e,t,r){var n=Nr;return n.dayNumber=t,n.secondsOfDay=r,Ke.daysDifference(n,e._sampleZeroDateTT)}function kr(e,r){if(e._chunkDownloadsInProgress[r])return e._chunkDownloadsInProgress[r];var n,i=t.when.defer();e._chunkDownloadsInProgress[r]=i;var a=e._xysFileUrlTemplate;return n=t.defined(a)?a.getDerivedResource({templateValues:{0:r}}):new or({url:Ir("Assets/IAU2006_XYS/IAU2006_XYS_"+r+".json")}),t.when(n.fetchJson(),(function(t){e._chunkDownloadsInProgress[r]=!1;for(var n=e._samples,a=t.samples,o=r*e._samplesPerXysFile*3,s=0,u=a.length;s<u;++s)n[o+s]=a[s];i.resolve()})),i.promise}Ur.prototype.preload=function(e,r,n,i){var a=Fr(this,e,r),o=Fr(this,n,i),s=a/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var u=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);for(var l=s/this._samplesPerXysFile|0,f=u/this._samplesPerXysFile|0,d=[],c=l;c<=f;++c)d.push(kr(this,c));return t.when.all(d)},Ur.prototype.computeXysRadians=function(e,r,n){var i=Fr(this,e,r);if(!(i<0)){var a=i/this._stepSizeDays|0;if(!(a>=this._totalSamples)){var o=this._interpolationOrder,s=a-(o/2|0);s<0&&(s=0);var u=s+o;u>=this._totalSamples&&(u=this._totalSamples-1,s=u-o,s<0&&(s=0));var l=!1,f=this._samples;if(t.defined(f[3*s])||(kr(this,s/this._samplesPerXysFile|0),l=!0),t.defined(f[3*u])||(kr(this,u/this._samplesPerXysFile|0),l=!0),!l){t.defined(n)?(n.x=0,n.y=0,n.s=0):n=new Pr(0,0,0);var d,c,h=i-s*this._stepSizeDays,p=this._work,m=this._denominators,y=this._coef,v=this._xTable;for(d=0;d<=o;++d)p[d]=h-v[d];for(d=0;d<=o;++d){for(y[d]=1,c=0;c<=o;++c)c!==d&&(y[d]*=p[c]);y[d]*=m[d];var w=3*(s+d);n.x+=y[d]*f[w++],n.y+=y[d]*f[w++],n.s+=y[d]*f[w]}return n}}}};var jr={},zr={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Lr={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Vr={},Br={east:new n.Cartesian3,north:new n.Cartesian3,up:new n.Cartesian3,west:new n.Cartesian3,south:new n.Cartesian3,down:new n.Cartesian3},Wr=new n.Cartesian3,Yr=new n.Cartesian3,Hr=new n.Cartesian3;jr.localFrameToFixedFrameGenerator=function(e,o){if(!zr.hasOwnProperty(e)||!zr[e].hasOwnProperty(o))throw new r.DeveloperError("firstAxis and secondAxis must be east, north, up, west, south or down.");var s,u=zr[e][o],l=e+o;return t.defined(Vr[l])?s=Vr[l]:(s=function(s,l,f){if(!t.defined(s))throw new r.DeveloperError("origin is required.");if(t.defined(f)||(f=new a.Matrix4),n.Cartesian3.equalsEpsilon(s,n.Cartesian3.ZERO,n.CesiumMath.EPSILON14))n.Cartesian3.unpack(Lr[e],0,Wr),n.Cartesian3.unpack(Lr[o],0,Yr),n.Cartesian3.unpack(Lr[u],0,Hr);else if(n.CesiumMath.equalsEpsilon(s.x,0,n.CesiumMath.EPSILON14)&&n.CesiumMath.equalsEpsilon(s.y,0,n.CesiumMath.EPSILON14)){var d=n.CesiumMath.sign(s.z);n.Cartesian3.unpack(Lr[e],0,Wr),"east"!==e&&"west"!==e&&n.Cartesian3.multiplyByScalar(Wr,d,Wr),n.Cartesian3.unpack(Lr[o],0,Yr),"east"!==o&&"west"!==o&&n.Cartesian3.multiplyByScalar(Yr,d,Yr),n.Cartesian3.unpack(Lr[u],0,Hr),"east"!==u&&"west"!==u&&n.Cartesian3.multiplyByScalar(Hr,d,Hr)}else{l=t.defaultValue(l,i.Ellipsoid.WGS84),l.geodeticSurfaceNormal(s,Br.up);var c=Br.up,h=Br.east;h.x=-s.y,h.y=s.x,h.z=0,n.Cartesian3.normalize(h,Br.east),n.Cartesian3.cross(c,h,Br.north),n.Cartesian3.multiplyByScalar(Br.up,-1,Br.down),n.Cartesian3.multiplyByScalar(Br.east,-1,Br.west),n.Cartesian3.multiplyByScalar(Br.north,-1,Br.south),Wr=Br[e],Yr=Br[o],Hr=Br[u]}return f[0]=Wr.x,f[1]=Wr.y,f[2]=Wr.z,f[3]=0,f[4]=Yr.x,f[5]=Yr.y,f[6]=Yr.z,f[7]=0,f[8]=Hr.x,f[9]=Hr.y,f[10]=Hr.z,f[11]=0,f[12]=s.x,f[13]=s.y,f[14]=s.z,f[15]=1,f},Vr[l]=s),s},jr.eastNorthUpToFixedFrame=jr.localFrameToFixedFrameGenerator("east","north"),jr.northEastDownToFixedFrame=jr.localFrameToFixedFrameGenerator("north","east"),jr.northUpEastToFixedFrame=jr.localFrameToFixedFrameGenerator("north","up"),jr.northWestUpToFixedFrame=jr.localFrameToFixedFrameGenerator("north","west");var Jr=new J,Xr=new n.Cartesian3(1,1,1),Gr=new a.Matrix4;jr.headingPitchRollToFixedFrame=function(e,i,o,s,u){r.Check.typeOf.object("HeadingPitchRoll",i),s=t.defaultValue(s,jr.eastNorthUpToFixedFrame);var l=J.fromHeadingPitchRoll(i,Jr),f=a.Matrix4.fromTranslationQuaternionRotationScale(n.Cartesian3.ZERO,l,Xr,Gr);return u=s(e,o,u),a.Matrix4.multiply(u,f,u)};var Zr=new a.Matrix4,Qr=new a.Matrix3;jr.headingPitchRollQuaternion=function(e,t,n,i,o){r.Check.typeOf.object("HeadingPitchRoll",t);var s=jr.headingPitchRollToFixedFrame(e,t,n,i,Zr),u=a.Matrix4.getMatrix3(s,Qr);return J.fromRotationMatrix(u,o)};var Kr=new n.Cartesian3(1,1,1),$r=new n.Cartesian3,en=new a.Matrix4,tn=new a.Matrix4,rn=new a.Matrix3,nn=new J;jr.fixedFrameToHeadingPitchRoll=function(e,o,s,u){r.Check.defined("transform",e),o=t.defaultValue(o,i.Ellipsoid.WGS84),s=t.defaultValue(s,jr.eastNorthUpToFixedFrame),t.defined(u)||(u=new _r);var l=a.Matrix4.getTranslation(e,$r);if(n.Cartesian3.equals(l,n.Cartesian3.ZERO))return u.heading=0,u.pitch=0,u.roll=0,u;var f=a.Matrix4.inverseTransformation(s(l,o,en),en),d=a.Matrix4.setScale(e,Kr,tn);d=a.Matrix4.setTranslation(d,n.Cartesian3.ZERO,d),f=a.Matrix4.multiply(f,d,f);var c=J.fromRotationMatrix(a.Matrix4.getMatrix3(f,rn),nn);return c=J.normalize(c,c),_r.fromQuaternion(c,u)};var an=24110.54841,on=8640184.812866,sn=.093104,un=-62e-7,ln=11772758384668e-32,fn=72921158553e-15,dn=n.CesiumMath.TWO_PI/86400,cn=new Ke;jr.computeTemeToPseudoFixedMatrix=function(e,i){if(!t.defined(e))throw new r.DeveloperError("date is required.");cn=Ke.addSeconds(e,-Ke.computeTaiMinusUtc(e),cn);var o,s=cn.dayNumber,u=cn.secondsOfDay,l=s-2451545;o=u>=43200?(l+.5)/Re.DAYS_PER_JULIAN_CENTURY:(l-.5)/Re.DAYS_PER_JULIAN_CENTURY;var f=an+o*(on+o*(sn+o*un)),d=f*dn%n.CesiumMath.TWO_PI,c=fn+ln*(s-2451545.5),h=(u+.5*Re.SECONDS_PER_DAY)%Re.SECONDS_PER_DAY,p=d+c*h,m=Math.cos(p),y=Math.sin(p);return t.defined(i)?(i[0]=m,i[1]=-y,i[2]=0,i[3]=y,i[4]=m,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i):new a.Matrix3(m,y,0,-y,m,0,0,0,1)},jr.iau2006XysData=new Ur,jr.earthOrientationParameters=vr.NONE;var hn=32.184,pn=2451545;jr.preloadIcrfFixed=function(e){var r=e.start.dayNumber,n=e.start.secondsOfDay+hn,i=e.stop.dayNumber,a=e.stop.secondsOfDay+hn,o=jr.iau2006XysData.preload(r,n,i,a),s=jr.earthOrientationParameters.getPromiseToLoad();return t.when.all([o,s])},jr.computeIcrfToFixedMatrix=function(e,n){if(!t.defined(e))throw new r.DeveloperError("date is required.");t.defined(n)||(n=new a.Matrix3);var i=jr.computeFixedToIcrfMatrix(e,n);if(t.defined(i))return a.Matrix3.transpose(i,n)};var mn=new Pr(0,0,0),yn=new xe(0,0,0,0,0,0),vn=new a.Matrix3,wn=new a.Matrix3;jr.computeFixedToIcrfMatrix=function(e,i){if(!t.defined(e))throw new r.DeveloperError("date is required.");t.defined(i)||(i=new a.Matrix3);var o=jr.earthOrientationParameters.compute(e,yn);if(t.defined(o)){var s=e.dayNumber,u=e.secondsOfDay+hn,l=jr.iau2006XysData.computeXysRadians(s,u,mn);if(t.defined(l)){var f=l.x+o.xPoleOffset,d=l.y+o.yPoleOffset,c=1/(1+Math.sqrt(1-f*f-d*d)),h=vn;h[0]=1-c*f*f,h[3]=-c*f*d,h[6]=f,h[1]=-c*f*d,h[4]=1-c*d*d,h[7]=d,h[2]=-f,h[5]=-d,h[8]=1-c*(f*f+d*d);var p=a.Matrix3.fromRotationZ(-l.s,wn),m=a.Matrix3.multiply(h,p,vn),y=e.dayNumber,v=e.secondsOfDay-Ke.computeTaiMinusUtc(e)+o.ut1MinusUtc,w=y-2451545,C=v/Re.SECONDS_PER_DAY,g=.779057273264+C+.00273781191135448*(w+C);g=g%1*n.CesiumMath.TWO_PI;var E=a.Matrix3.fromRotationZ(g,wn),O=a.Matrix3.multiply(m,E,vn),_=Math.cos(o.xPoleWander),x=Math.cos(o.yPoleWander),b=Math.sin(o.xPoleWander),D=Math.sin(o.yPoleWander),q=s-pn+u/Re.SECONDS_PER_DAY;q/=36525;var A=-47e-6*q*n.CesiumMath.RADIANS_PER_DEGREE/3600,S=Math.cos(A),R=Math.sin(A),T=wn;return T[0]=_*S,T[1]=_*R,T[2]=b,T[3]=-x*R+D*b*S,T[4]=x*S+D*b*R,T[5]=-D*_,T[6]=-D*R-x*b*S,T[7]=D*S-x*b*R,T[8]=x*_,a.Matrix3.multiply(O,T,i)}}};var Cn=new a.Cartesian4;jr.pointToWindowCoordinates=function(e,t,r,n){return n=jr.pointToGLWindowCoordinates(e,t,r,n),n.y=2*t[5]-n.y,n},jr.pointToGLWindowCoordinates=function(e,n,o,s){if(!t.defined(e))throw new r.DeveloperError("modelViewProjectionMatrix is required.");if(!t.defined(n))throw new r.DeveloperError("viewportTransformation is required.");if(!t.defined(o))throw new r.DeveloperError("point is required.");t.defined(s)||(s=new i.Cartesian2);var u=Cn;return a.Matrix4.multiplyByVector(e,a.Cartesian4.fromElements(o.x,o.y,o.z,1,u),u),a.Cartesian4.multiplyByScalar(u,1/u.w,u),a.Matrix4.multiplyByVector(n,u,u),i.Cartesian2.fromCartesian4(u,s)};var gn=new n.Cartesian3,En=new n.Cartesian3,On=new n.Cartesian3;jr.rotationMatrixFromPositionVelocity=function(e,o,s,u){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(o))throw new r.DeveloperError("velocity is required.");var l=t.defaultValue(s,i.Ellipsoid.WGS84).geodeticSurfaceNormal(e,gn),f=n.Cartesian3.cross(o,l,En);n.Cartesian3.equalsEpsilon(f,n.Cartesian3.ZERO,n.CesiumMath.EPSILON6)&&(f=n.Cartesian3.clone(n.Cartesian3.UNIT_X,f));var d=n.Cartesian3.cross(f,o,On);return n.Cartesian3.normalize(d,d),n.Cartesian3.cross(o,d,f),n.Cartesian3.negate(f,f),n.Cartesian3.normalize(f,f),t.defined(u)||(u=new a.Matrix3),u[0]=o.x,u[1]=o.y,u[2]=o.z,u[3]=f.x,u[4]=f.y,u[5]=f.z,u[6]=d.x,u[7]=d.y,u[8]=d.z,u};var _n=new a.Matrix4(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),xn=new i.Cartographic,bn=new n.Cartesian3,Dn=new n.Cartesian3,qn=new a.Matrix3,An=new a.Matrix4,Sn=new a.Matrix4;jr.basisTo2D=function(e,i,o){if(!t.defined(e))throw new r.DeveloperError("projection is required.");if(!t.defined(i))throw new r.DeveloperError("matrix is required.");if(!t.defined(o))throw new r.DeveloperError("result is required.");var s=a.Matrix4.getTranslation(i,Dn),u=e.ellipsoid,l=u.cartesianToCartographic(s,xn),f=e.project(l,bn);n.Cartesian3.fromElements(f.z,f.x,f.y,f);var d=jr.eastNorthUpToFixedFrame(s,u,An),c=a.Matrix4.inverseTransformation(d,Sn),h=a.Matrix4.getMatrix3(i,qn),p=a.Matrix4.multiplyByMatrix3(c,h,o);return a.Matrix4.multiply(_n,p,o),a.Matrix4.setTranslation(o,f,o),o},jr.wgs84To2DModelMatrix=function(e,i,o){if(!t.defined(e))throw new r.DeveloperError("projection is required.");if(!t.defined(i))throw new r.DeveloperError("center is required.");if(!t.defined(o))throw new r.DeveloperError("result is required.");var s=e.ellipsoid,u=jr.eastNorthUpToFixedFrame(i,s,An),l=a.Matrix4.inverseTransformation(u,Sn),f=s.cartesianToCartographic(i,xn),d=e.project(f,bn);n.Cartesian3.fromElements(d.z,d.x,d.y,d);var c=a.Matrix4.fromTranslation(d,An);return a.Matrix4.multiply(_n,l,o),a.Matrix4.multiply(c,o,o),o},e.FeatureDetection=H,e.Quaternion=J,e.Resource=or,e.Transforms=jr,e.buildModuleUrl=Ir}));