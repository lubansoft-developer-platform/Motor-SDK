{"version":3,"file":"EmWrapperManager-0f203c26.js","sources":["../../Source/Extension/Source/Worker/EmWrapperManager.js"],"sourcesContent":["import materem from \"../../../ThirdParty/Workers/materem.js\";\r\nimport when from \"../../../ThirdParty/when.js\";\r\nimport defined from \"../../../Core/defined.js\";\r\n\r\nexport let emMod;\r\n\r\n/**\r\n * mater em mgr\r\n */\r\nclass EmWrapperManager {\r\n    /**\r\n     *\r\n     * @param {string} wasmpath\r\n     * @returns {Promise<Boolean>}\r\n     */\r\n    static initWebAssembly(wasmpath) {\r\n        return initWebAssembly(wasmpath);\r\n    }\r\n}\r\n\r\nfunction initWebAssembly(wasmpath) {\r\n    let readyPromise = when.defer();\r\n    if (!defined(emMod)) {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open(\"GET\", wasmpath, true);\r\n        xhr.responseType = \"arraybuffer\";\r\n        xhr.send();\r\n\r\n        xhr.onload = function () {\r\n            var WebAssemblyType = {};\r\n            WebAssemblyType[\"wasmBinary\"] = xhr.response;\r\n            WebAssemblyType[\"onModuleLoaded\"] = function (inmod) {\r\n                emMod = inmod;\r\n                readyPromise.resolve(true);\r\n            };\r\n            //全局模块\r\n            materem(WebAssemblyType);\r\n        };\r\n    } else {\r\n        readyPromise.resolve(true);\r\n    }\r\n    return readyPromise.promise;\r\n}\r\n\r\nexport default EmWrapperManager;\r\n"],"names":["when","defined","emMod","materem"],"mappings":";;;IAMA;IACA;IACA;IACA,MAAM,gBAAgB,CAAC;IACvB;IACA;IACA;IACA;IACA;IACA,IAAI,OAAO,eAAe,CAAC,QAAQ,EAAE;IACrC,QAAQ,OAAO,eAAe,CAAC,QAAQ,CAAC,CAAC;IACzC,KAAK;IACL,CAAC;AACD;IACA,SAAS,eAAe,CAAC,QAAQ,EAAE;IACnC,IAAI,IAAI,YAAY,GAAGA,SAAI,CAAC,KAAK,EAAE,CAAC;IACpC,IAAI,IAAI,CAACC,YAAO,CAACC,aAAK,CAAC,EAAE;IACzB,QAAQ,MAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;IACzC,QAAQ,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;IACxC,QAAQ,GAAG,CAAC,YAAY,GAAG,aAAa,CAAC;IACzC,QAAQ,GAAG,CAAC,IAAI,EAAE,CAAC;AACnB;IACA,QAAQ,GAAG,CAAC,MAAM,GAAG,YAAY;IACjC,YAAY,IAAI,eAAe,GAAG,EAAE,CAAC;IACrC,YAAY,eAAe,CAAC,YAAY,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC;IACzD,YAAY,eAAe,CAAC,gBAAgB,CAAC,GAAG,UAAU,KAAK,EAAE;IACjE,gBAAgBA,aAAK,GAAG,KAAK,CAAC;IAC9B,gBAAgB,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC3C,aAAa,CAAC;IACd;IACA,YAAYC,eAAO,CAAC,eAAe,CAAC,CAAC;IACrC,SAAS,CAAC;IACV,KAAK,MAAM;IACX,QAAQ,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACnC,KAAK;IACL,IAAI,OAAO,YAAY,CAAC,OAAO,CAAC;IAChC;;;;;;;;"}