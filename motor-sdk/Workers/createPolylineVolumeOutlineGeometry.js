define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-eab74dc0","./Cartesian2-174fefc1","./BoundingSphere-37359cf8","./Transforms-6b57162d","./Matrix4-ed224189","./RuntimeError-86da6af2","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-b1ed7c2e","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./IndexDatatype-cb635cbc","./IntersectionTests-a310845d","./Plane-87957166","./arrayRemoveDuplicates-8b568181","./BoundingRectangle-9114b2ad","./AxisAlignedBoundingBox-804b7aeb","./EllipsoidTangentPlane-37f60f7a","./EllipsoidRhumbLine-de5cdc57","./PolygonPipeline-b585c3c1","./PolylineVolumeGeometryLibrary-faab6a71","./EllipsoidGeodesic-96429ebd","./PolylinePipeline-8d76037d"],(function(e,i,r,n,t,a,o,l,s,p,d,u,c,y,f,h,g,v,m,E,P,b,_,C,k){"use strict";function D(e,i){var r=new c.GeometryAttributes;r.position=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e});var n,a,o=i.length,l=r.position.values.length/3,s=e.length/3,f=s/o,h=y.IndexDatatype.createTypedArray(l,2*o*(f+1)),g=0;n=0;var v=n*o;for(a=0;a<o-1;a++)h[g++]=a+v,h[g++]=a+v+1;for(h[g++]=o-1+v,h[g++]=v,n=f-1,v=n*o,a=0;a<o-1;a++)h[g++]=a+v,h[g++]=a+v+1;for(h[g++]=o-1+v,h[g++]=v,n=0;n<f-1;n++){var m=o*n,E=m+o;for(a=0;a<o;a++)h[g++]=a+m,h[g++]=a+E}var P=new d.Geometry({attributes:r,indices:y.IndexDatatype.createTypedArray(l,h),boundingSphere:t.BoundingSphere.fromVertices(e),primitiveType:u.PrimitiveType.LINES});return P}function w(t){t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT);var a=t.polylinePositions,o=t.shapePositions;if(!e.defined(a))throw new i.DeveloperError("options.polylinePositions is required.");if(!e.defined(o))throw new i.DeveloperError("options.shapePositions is required.");this._positions=a,this._shape=o,this._ellipsoid=n.Ellipsoid.clone(e.defaultValue(t.ellipsoid,n.Ellipsoid.WGS84)),this._cornerType=e.defaultValue(t.cornerType,_.CornerType.ROUNDED),this._granularity=e.defaultValue(t.granularity,r.CesiumMath.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var l=1+a.length*r.Cartesian3.packedLength;l+=1+o.length*n.Cartesian2.packedLength,this.packedLength=l+n.Ellipsoid.packedLength+2}w.pack=function(t,a,o){if(!e.defined(t))throw new i.DeveloperError("value is required");if(!e.defined(a))throw new i.DeveloperError("array is required");var l;o=e.defaultValue(o,0);var s=t._positions,p=s.length;for(a[o++]=p,l=0;l<p;++l,o+=r.Cartesian3.packedLength)r.Cartesian3.pack(s[l],a,o);var d=t._shape;for(p=d.length,a[o++]=p,l=0;l<p;++l,o+=n.Cartesian2.packedLength)n.Cartesian2.pack(d[l],a,o);return n.Ellipsoid.pack(t._ellipsoid,a,o),o+=n.Ellipsoid.packedLength,a[o++]=t._cornerType,a[o]=t._granularity,a};var L=n.Ellipsoid.clone(n.Ellipsoid.UNIT_SPHERE),T={polylinePositions:void 0,shapePositions:void 0,ellipsoid:L,height:void 0,cornerType:void 0,granularity:void 0};w.unpack=function(t,a,o){if(!e.defined(t))throw new i.DeveloperError("array is required");var l;a=e.defaultValue(a,0);var s=t[a++],p=new Array(s);for(l=0;l<s;++l,a+=r.Cartesian3.packedLength)p[l]=r.Cartesian3.unpack(t,a);s=t[a++];var d=new Array(s);for(l=0;l<s;++l,a+=n.Cartesian2.packedLength)d[l]=n.Cartesian2.unpack(t,a);var u=n.Ellipsoid.unpack(t,a,L);a+=n.Ellipsoid.packedLength;var c=t[a++],y=t[a];return e.defined(o)?(o._positions=p,o._shape=d,o._ellipsoid=n.Ellipsoid.clone(u,o._ellipsoid),o._cornerType=c,o._granularity=y,o):(T.polylinePositions=p,T.shapePositions=d,T.cornerType=c,T.granularity=y,new w(T))};var G=new v.BoundingRectangle;function A(i,r){return e.defined(r)&&(i=w.unpack(i,r)),i._ellipsoid=n.Ellipsoid.clone(i._ellipsoid),w.createGeometry(i)}return w.createGeometry=function(e){var i=e._positions,n=g.arrayRemoveDuplicates(i,r.Cartesian3.equalsEpsilon),t=e._shape;if(t=_.PolylineVolumeGeometryLibrary.removeDuplicatesFromShape(t),!(n.length<2||t.length<3)){b.PolygonPipeline.computeWindingOrder2D(t)===b.WindingOrder.CLOCKWISE&&t.reverse();var a=v.BoundingRectangle.fromPoints(t,G),o=_.PolylineVolumeGeometryLibrary.computePositions(n,t,a,e,!1);return D(o,t)}},A}));