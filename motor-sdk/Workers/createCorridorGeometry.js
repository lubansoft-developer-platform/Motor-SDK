define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./BoundingSphere-bacc5cb6","./Matrix4-c65e6a1b","./RuntimeError-86da6af2","./Rectangle-c7d55cfa","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-70b679fd","./PrimitiveType-30fa6f85","./Transforms-7d49a8ab","./GeometryAttributes-9d45f9e2","./IndexDatatype-e52361bd","./IntersectionTests-6b77277e","./Plane-b4c954eb","./GeometryOffsetAttribute-f755a5cb","./VertexFormat-a00562ee","./arrayRemoveDuplicates-24a803e7","./EllipsoidTangentPlane-c567cc9c","./EllipsoidRhumbLine-4bc7760a","./PolygonPipeline-ac4549dc","./PolylineVolumeGeometryLibrary-7cf92acf","./EllipsoidGeodesic-1d7258d7","./PolylinePipeline-5cca45a5","./CorridorGeometryLibrary-3cc7180b"],(function(t,e,r,a,i,o,n,s,l,d,u,m,f,c,y,p,h,g,C,b,v,A,_,w,T,G,E){"use strict";var V=new r.Cartesian3,F=new r.Cartesian3,L=new r.Cartesian3,P=new r.Cartesian3,x=new r.Cartesian3,N=new r.Cartesian3,D=new r.Cartesian3,M=new r.Cartesian3;function O(t,e){for(var r=0;r<t.length;r++)t[r]=e.scaleToGeodeticSurface(t[r],t[r]);return t}function I(t,e,a,i,o,n){var s=t.normals,l=t.tangents,d=t.bitangents,u=r.Cartesian3.normalize(r.Cartesian3.cross(a,e,D),D);n.normal&&E.CorridorGeometryLibrary.addAttribute(s,e,i,o),n.tangent&&E.CorridorGeometryLibrary.addAttribute(l,u,i,o),n.bitangent&&E.CorridorGeometryLibrary.addAttribute(d,a,i,o)}function k(e,a,i){var o,n,s,l=e.positions,m=e.corners,f=e.endPositions,p=e.lefts,h=e.normals,g=new c.GeometryAttributes,C=0,b=0,v=0;for(n=0;n<l.length;n+=2)s=l[n].length-3,C+=s,v+=2*s,b+=l[n+1].length-3;for(C+=3,b+=3,n=0;n<m.length;n++){o=m[n];var A=m[n].leftPositions;t.defined(A)?(s=A.length,C+=s,v+=s):(s=m[n].rightPositions.length,b+=s,v+=s)}var _,w=t.defined(f);w&&(_=f[0].length-3,C+=_,b+=_,_/=3,v+=6*_);var T,G,x,O,k,S,R=C+b,H=new Float64Array(R),z=a.normal?new Float32Array(R):void 0,U=a.tangent?new Float32Array(R):void 0,B=a.bitangent?new Float32Array(R):void 0,Y={normals:z,tangents:U,bitangents:B},W=0,q=R-1,J=V,j=F,K=_/2,Q=y.IndexDatatype.createTypedArray(R/3,v),X=0;if(w){S=L,k=P;var Z=f[0];for(J=r.Cartesian3.fromArray(h,0,J),j=r.Cartesian3.fromArray(p,0,j),n=0;n<K;n++)S=r.Cartesian3.fromArray(Z,3*(K-1-n),S),k=r.Cartesian3.fromArray(Z,3*(K+n),k),E.CorridorGeometryLibrary.addAttribute(H,k,W),E.CorridorGeometryLibrary.addAttribute(H,S,void 0,q),I(Y,J,j,W,q,a),G=W/3,O=G+1,T=(q-2)/3,x=T-1,Q[X++]=T,Q[X++]=G,Q[X++]=x,Q[X++]=x,Q[X++]=G,Q[X++]=O,W+=3,q-=3}var $,tt,et=0,rt=0,at=l[et++],it=l[et++];for(H.set(at,W),H.set(it,q-it.length+1),j=r.Cartesian3.fromArray(p,rt,j),s=it.length-3,n=0;n<s;n+=3)$=i.geodeticSurfaceNormal(r.Cartesian3.fromArray(at,n,D),D),tt=i.geodeticSurfaceNormal(r.Cartesian3.fromArray(it,s-n,M),M),J=r.Cartesian3.normalize(r.Cartesian3.add($,tt,J),J),I(Y,J,j,W,q,a),G=W/3,O=G+1,T=(q-2)/3,x=T-1,Q[X++]=T,Q[X++]=G,Q[X++]=x,Q[X++]=x,Q[X++]=G,Q[X++]=O,W+=3,q-=3;for($=i.geodeticSurfaceNormal(r.Cartesian3.fromArray(at,s,D),D),tt=i.geodeticSurfaceNormal(r.Cartesian3.fromArray(it,s,M),M),J=r.Cartesian3.normalize(r.Cartesian3.add($,tt,J),J),rt+=3,n=0;n<m.length;n++){var ot;o=m[n];var nt,st,lt=o.leftPositions,dt=o.rightPositions,ut=N,mt=L,ft=P;if(J=r.Cartesian3.fromArray(h,rt,J),t.defined(lt)){for(I(Y,J,j,void 0,q,a),q-=3,nt=O,st=x,ot=0;ot<lt.length/3;ot++)ut=r.Cartesian3.fromArray(lt,3*ot,ut),Q[X++]=nt,Q[X++]=st-ot-1,Q[X++]=st-ot,E.CorridorGeometryLibrary.addAttribute(H,ut,void 0,q),mt=r.Cartesian3.fromArray(H,3*(st-ot-1),mt),ft=r.Cartesian3.fromArray(H,3*nt,ft),j=r.Cartesian3.normalize(r.Cartesian3.subtract(mt,ft,j),j),I(Y,J,j,void 0,q,a),q-=3;ut=r.Cartesian3.fromArray(H,3*nt,ut),mt=r.Cartesian3.subtract(r.Cartesian3.fromArray(H,3*st,mt),ut,mt),ft=r.Cartesian3.subtract(r.Cartesian3.fromArray(H,3*(st-ot),ft),ut,ft),j=r.Cartesian3.normalize(r.Cartesian3.add(mt,ft,j),j),I(Y,J,j,W,void 0,a),W+=3}else{for(I(Y,J,j,W,void 0,a),W+=3,nt=x,st=O,ot=0;ot<dt.length/3;ot++)ut=r.Cartesian3.fromArray(dt,3*ot,ut),Q[X++]=nt,Q[X++]=st+ot,Q[X++]=st+ot+1,E.CorridorGeometryLibrary.addAttribute(H,ut,W),mt=r.Cartesian3.fromArray(H,3*nt,mt),ft=r.Cartesian3.fromArray(H,3*(st+ot),ft),j=r.Cartesian3.normalize(r.Cartesian3.subtract(mt,ft,j),j),I(Y,J,j,W,void 0,a),W+=3;ut=r.Cartesian3.fromArray(H,3*nt,ut),mt=r.Cartesian3.subtract(r.Cartesian3.fromArray(H,3*(st+ot),mt),ut,mt),ft=r.Cartesian3.subtract(r.Cartesian3.fromArray(H,3*st,ft),ut,ft),j=r.Cartesian3.normalize(r.Cartesian3.negate(r.Cartesian3.add(ft,mt,j),j),j),I(Y,J,j,void 0,q,a),q-=3}for(at=l[et++],it=l[et++],at.splice(0,3),it.splice(it.length-3,3),H.set(at,W),H.set(it,q-it.length+1),s=it.length-3,rt+=3,j=r.Cartesian3.fromArray(p,rt,j),ot=0;ot<it.length;ot+=3)$=i.geodeticSurfaceNormal(r.Cartesian3.fromArray(at,ot,D),D),tt=i.geodeticSurfaceNormal(r.Cartesian3.fromArray(it,s-ot,M),M),J=r.Cartesian3.normalize(r.Cartesian3.add($,tt,J),J),I(Y,J,j,W,q,a),O=W/3,G=O-1,x=(q-2)/3,T=x+1,Q[X++]=T,Q[X++]=G,Q[X++]=x,Q[X++]=x,Q[X++]=G,Q[X++]=O,W+=3,q-=3;W-=3,q+=3}if(J=r.Cartesian3.fromArray(h,h.length-3,J),I(Y,J,j,W,q,a),w){W+=3,q-=3,S=L,k=P;var ct=f[1];for(n=0;n<K;n++)S=r.Cartesian3.fromArray(ct,3*(_-n-1),S),k=r.Cartesian3.fromArray(ct,3*n,k),E.CorridorGeometryLibrary.addAttribute(H,S,void 0,q),E.CorridorGeometryLibrary.addAttribute(H,k,W),I(Y,J,j,W,q,a),O=W/3,G=O-1,x=(q-2)/3,T=x+1,Q[X++]=T,Q[X++]=G,Q[X++]=x,Q[X++]=x,Q[X++]=G,Q[X++]=O,W+=3,q-=3}if(g.position=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:H}),a.st){var yt,pt,ht=new Float32Array(R/3*2),gt=0;if(w){C/=3,b/=3;var Ct,bt=Math.PI/(_+1);pt=1/(C-_+1),yt=1/(b-_+1);var vt=_/2;for(n=vt+1;n<_+1;n++)Ct=r.CesiumMath.PI_OVER_TWO+bt*n,ht[gt++]=yt*(1+Math.cos(Ct)),ht[gt++]=.5*(1+Math.sin(Ct));for(n=1;n<b-_+1;n++)ht[gt++]=n*yt,ht[gt++]=0;for(n=_;n>vt;n--)Ct=r.CesiumMath.PI_OVER_TWO-n*bt,ht[gt++]=1-yt*(1+Math.cos(Ct)),ht[gt++]=.5*(1+Math.sin(Ct));for(n=vt;n>0;n--)Ct=r.CesiumMath.PI_OVER_TWO-bt*n,ht[gt++]=1-pt*(1+Math.cos(Ct)),ht[gt++]=.5*(1+Math.sin(Ct));for(n=C-_;n>0;n--)ht[gt++]=n*pt,ht[gt++]=1;for(n=1;n<vt+1;n++)Ct=r.CesiumMath.PI_OVER_TWO+bt*n,ht[gt++]=pt*(1+Math.cos(Ct)),ht[gt++]=.5*(1+Math.sin(Ct))}else{for(C/=3,b/=3,pt=1/(C-1),yt=1/(b-1),n=0;n<b;n++)ht[gt++]=n*yt,ht[gt++]=0;for(n=C;n>0;n--)ht[gt++]=(n-1)*pt,ht[gt++]=1}g.st=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:ht})}return a.normal&&(g.normal=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:Y.normals})),a.tangent&&(g.tangent=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:Y.tangents})),a.bitangent&&(g.bitangent=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:Y.bitangents})),{attributes:g,indices:Q}}function S(t,e){if(!e.normal&&!e.tangent&&!e.bitangent&&!e.st)return t;var a,i,o=t.position.values;(e.normal||e.bitangent)&&(a=t.normal.values,i=t.bitangent.values);var n,s=t.position.values.length/18,l=3*s,d=2*s,u=2*l;if(e.normal||e.bitangent||e.tangent){var m=e.normal?new Float32Array(6*l):void 0,f=e.tangent?new Float32Array(6*l):void 0,c=e.bitangent?new Float32Array(6*l):void 0,y=V,p=F,h=L,g=P,C=x,b=N,v=u;for(n=0;n<l;n+=3){var A=v+u;y=r.Cartesian3.fromArray(o,n,y),p=r.Cartesian3.fromArray(o,n+l,p),h=r.Cartesian3.fromArray(o,(n+3)%l,h),p=r.Cartesian3.subtract(p,y,p),h=r.Cartesian3.subtract(h,y,h),g=r.Cartesian3.normalize(r.Cartesian3.cross(p,h,g),g),e.normal&&(E.CorridorGeometryLibrary.addAttribute(m,g,A),E.CorridorGeometryLibrary.addAttribute(m,g,A+3),E.CorridorGeometryLibrary.addAttribute(m,g,v),E.CorridorGeometryLibrary.addAttribute(m,g,v+3)),(e.tangent||e.bitangent)&&(b=r.Cartesian3.fromArray(a,n,b),e.bitangent&&(E.CorridorGeometryLibrary.addAttribute(c,b,A),E.CorridorGeometryLibrary.addAttribute(c,b,A+3),E.CorridorGeometryLibrary.addAttribute(c,b,v),E.CorridorGeometryLibrary.addAttribute(c,b,v+3)),e.tangent&&(C=r.Cartesian3.normalize(r.Cartesian3.cross(b,g,C),C),E.CorridorGeometryLibrary.addAttribute(f,C,A),E.CorridorGeometryLibrary.addAttribute(f,C,A+3),E.CorridorGeometryLibrary.addAttribute(f,C,v),E.CorridorGeometryLibrary.addAttribute(f,C,v+3))),v+=6}if(e.normal){for(m.set(a),n=0;n<l;n+=3)m[n+l]=-a[n],m[n+l+1]=-a[n+1],m[n+l+2]=-a[n+2];t.normal.values=m}else t.normal=void 0;if(e.bitangent?(c.set(i),c.set(i,l),t.bitangent.values=c):t.bitangent=void 0,e.tangent){var _=t.tangent.values;f.set(_),f.set(_,l),t.tangent.values=f}}if(e.st){var w=t.st.values,T=new Float32Array(6*d);T.set(w),T.set(w,d);for(var G=2*d,D=0;D<2;D++){for(T[G++]=w[0],T[G++]=w[1],n=2;n<d;n+=2){var M=w[n],O=w[n+1];T[G++]=M,T[G++]=O,T[G++]=M,T[G++]=O}T[G++]=w[0],T[G++]=w[1]}t.st.values=T}return t}function R(t,e,r){r[e++]=t[0],r[e++]=t[1],r[e++]=t[2];for(var a=3;a<t.length;a+=3){var i=t[a],o=t[a+1],n=t[a+2];r[e++]=i,r[e++]=o,r[e++]=n,r[e++]=i,r[e++]=o,r[e++]=n}return r[e++]=t[0],r[e++]=t[1],r[e++]=t[2],r}function H(e,r){var a=new C.VertexFormat({position:r.position,normal:r.normal||r.bitangent||e.shadowVolume,tangent:r.tangent,bitangent:r.normal||r.bitangent,st:r.st}),i=e.ellipsoid,o=E.CorridorGeometryLibrary.computePositions(e),n=k(o,a,i),s=e.height,l=e.extrudedHeight,m=n.attributes,f=n.indices,c=m.position.values,p=c.length,h=new Float64Array(6*p),b=new Float64Array(p);b.set(c);var v,A=new Float64Array(4*p);c=_.PolygonPipeline.scaleToGeodeticHeight(c,s,i),A=R(c,0,A),b=_.PolygonPipeline.scaleToGeodeticHeight(b,l,i),A=R(b,2*p,A),h.set(c),h.set(b,p),h.set(A,2*p),m.position.values=h,m=S(m,r);var w=p/3;if(e.shadowVolume){var T=m.normal.values;p=T.length;var G=new Float32Array(6*p);for(v=0;v<p;v++)T[v]=-T[v];G.set(T,p),G=R(T,4*p,G),m.extrudeDirection=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:G}),r.normal||(m.normal=void 0)}if(t.defined(e.offsetAttribute)){var V=new Uint8Array(6*w);if(e.offsetAttribute===g.GeometryOffsetAttribute.TOP)V=g.arrayFill(V,1,0,w),V=g.arrayFill(V,1,2*w,4*w);else{var F=e.offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1;V=g.arrayFill(V,F)}m.applyOffset=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:V})}var L=f.length,P=w+w,x=y.IndexDatatype.createTypedArray(h.length/3,2*L+3*P);x.set(f);var N,D,M,O,I=L;for(v=0;v<L;v+=3){var H=f[v],z=f[v+1],U=f[v+2];x[I++]=U+w,x[I++]=z+w,x[I++]=H+w}for(v=0;v<P;v+=2)N=v+P,D=N+P,M=N+1,O=D+1,x[I++]=N,x[I++]=D,x[I++]=M,x[I++]=M,x[I++]=D,x[I++]=O;return{attributes:m,indices:x}}var z=new r.Cartesian3,U=new r.Cartesian3,B=new a.Cartographic;function Y(t,e,a,i,o,n){var s=r.Cartesian3.subtract(e,t,z);r.Cartesian3.normalize(s,s);var l=a.geodeticSurfaceNormal(t,U),d=r.Cartesian3.cross(s,l,z);r.Cartesian3.multiplyByScalar(d,i,d);var u=o.latitude,m=o.longitude,f=n.latitude,c=n.longitude;r.Cartesian3.add(t,d,U),a.cartesianToCartographic(U,B);var y=B.latitude,p=B.longitude;u=Math.min(u,y),m=Math.min(m,p),f=Math.max(f,y),c=Math.max(c,p),r.Cartesian3.subtract(t,d,U),a.cartesianToCartographic(U,B),y=B.latitude,p=B.longitude,u=Math.min(u,y),m=Math.min(m,p),f=Math.max(f,y),c=Math.max(c,p),o.latitude=u,o.longitude=m,n.latitude=f,n.longitude=c}var W=new r.Cartesian3,q=new r.Cartesian3,J=new a.Cartographic,j=new a.Cartographic;function K(e,a,i,o,n){e=O(e,a);var l=b.arrayRemoveDuplicates(e,r.Cartesian3.equalsEpsilon),d=l.length;if(d<2||i<=0)return new s.Rectangle;var u,m,f=.5*i;if(J.latitude=Number.POSITIVE_INFINITY,J.longitude=Number.POSITIVE_INFINITY,j.latitude=Number.NEGATIVE_INFINITY,j.longitude=Number.NEGATIVE_INFINITY,o===w.CornerType.ROUNDED){var c=l[0];r.Cartesian3.subtract(c,l[1],W),r.Cartesian3.normalize(W,W),r.Cartesian3.multiplyByScalar(W,f,W),r.Cartesian3.add(c,W,q),a.cartesianToCartographic(q,B),u=B.latitude,m=B.longitude,J.latitude=Math.min(J.latitude,u),J.longitude=Math.min(J.longitude,m),j.latitude=Math.max(j.latitude,u),j.longitude=Math.max(j.longitude,m)}for(var y=0;y<d-1;++y)Y(l[y],l[y+1],a,f,J,j);var p=l[d-1];r.Cartesian3.subtract(p,l[d-2],W),r.Cartesian3.normalize(W,W),r.Cartesian3.multiplyByScalar(W,f,W),r.Cartesian3.add(p,W,q),Y(p,q,a,f,J,j),o===w.CornerType.ROUNDED&&(a.cartesianToCartographic(q,B),u=B.latitude,m=B.longitude,J.latitude=Math.min(J.latitude,u),J.longitude=Math.min(J.longitude,m),j.latitude=Math.max(j.latitude,u),j.longitude=Math.max(j.longitude,m));var h=t.defined(n)?n:new s.Rectangle;return h.north=j.latitude,h.south=J.latitude,h.east=j.longitude,h.west=J.longitude,h}function Q(i){i=t.defaultValue(i,t.defaultValue.EMPTY_OBJECT);var o=i.positions,n=i.width;e.Check.defined("options.positions",o),e.Check.defined("options.width",n);var s=t.defaultValue(i.height,0),l=t.defaultValue(i.extrudedHeight,s);this._positions=o,this._ellipsoid=a.Ellipsoid.clone(t.defaultValue(i.ellipsoid,a.Ellipsoid.WGS84)),this._vertexFormat=C.VertexFormat.clone(t.defaultValue(i.vertexFormat,C.VertexFormat.DEFAULT)),this._width=n,this._height=Math.max(s,l),this._extrudedHeight=Math.min(s,l),this._cornerType=t.defaultValue(i.cornerType,w.CornerType.ROUNDED),this._granularity=t.defaultValue(i.granularity,r.CesiumMath.RADIANS_PER_DEGREE),this._shadowVolume=t.defaultValue(i.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=i.offsetAttribute,this._rectangle=void 0,this.packedLength=1+o.length*r.Cartesian3.packedLength+a.Ellipsoid.packedLength+C.VertexFormat.packedLength+7}Q.pack=function(i,o,n){e.Check.defined("value",i),e.Check.defined("array",o),n=t.defaultValue(n,0);var s=i._positions,l=s.length;o[n++]=l;for(var d=0;d<l;++d,n+=r.Cartesian3.packedLength)r.Cartesian3.pack(s[d],o,n);return a.Ellipsoid.pack(i._ellipsoid,o,n),n+=a.Ellipsoid.packedLength,C.VertexFormat.pack(i._vertexFormat,o,n),n+=C.VertexFormat.packedLength,o[n++]=i._width,o[n++]=i._height,o[n++]=i._extrudedHeight,o[n++]=i._cornerType,o[n++]=i._granularity,o[n++]=i._shadowVolume?1:0,o[n]=t.defaultValue(i._offsetAttribute,-1),o};var X=a.Ellipsoid.clone(a.Ellipsoid.UNIT_SPHERE),Z=new C.VertexFormat,$={positions:void 0,ellipsoid:X,vertexFormat:Z,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};function tt(e,r){return t.defined(r)&&(e=Q.unpack(e,r)),e._ellipsoid=a.Ellipsoid.clone(e._ellipsoid),Q.createGeometry(e)}return Q.unpack=function(i,o,n){e.Check.defined("array",i),o=t.defaultValue(o,0);for(var s=i[o++],l=new Array(s),d=0;d<s;++d,o+=r.Cartesian3.packedLength)l[d]=r.Cartesian3.unpack(i,o);var u=a.Ellipsoid.unpack(i,o,X);o+=a.Ellipsoid.packedLength;var m=C.VertexFormat.unpack(i,o,Z);o+=C.VertexFormat.packedLength;var f=i[o++],c=i[o++],y=i[o++],p=i[o++],h=i[o++],g=1===i[o++],b=i[o];return t.defined(n)?(n._positions=l,n._ellipsoid=a.Ellipsoid.clone(u,n._ellipsoid),n._vertexFormat=C.VertexFormat.clone(m,n._vertexFormat),n._width=f,n._height=c,n._extrudedHeight=y,n._cornerType=p,n._granularity=h,n._shadowVolume=g,n._offsetAttribute=-1===b?void 0:b,n):($.positions=l,$.width=f,$.height=c,$.extrudedHeight=y,$.cornerType=p,$.granularity=h,$.shadowVolume=g,$.offsetAttribute=-1===b?void 0:b,new Q($))},Q.computeRectangle=function(r,i){r=t.defaultValue(r,t.defaultValue.EMPTY_OBJECT);var o=r.positions,n=r.width;e.Check.defined("options.positions",o),e.Check.defined("options.width",n);var s=t.defaultValue(r.ellipsoid,a.Ellipsoid.WGS84),l=t.defaultValue(r.cornerType,w.CornerType.ROUNDED);return K(o,s,n,l,i)},Q.createGeometry=function(e){var a=e._positions,o=e._width,n=e._ellipsoid;a=O(a,n);var s=b.arrayRemoveDuplicates(a,r.Cartesian3.equalsEpsilon);if(!(s.length<2||o<=0)){var l,f=e._height,c=e._extrudedHeight,y=!r.CesiumMath.equalsEpsilon(f,c,0,r.CesiumMath.EPSILON2),p=e._vertexFormat,h={ellipsoid:n,positions:s,width:o,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0};if(y)h.height=f,h.extrudedHeight=c,h.shadowVolume=e._shadowVolume,h.offsetAttribute=e._offsetAttribute,l=H(h,p);else{var C=E.CorridorGeometryLibrary.computePositions(h);if(l=k(C,p,n),l.attributes.position.values=_.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,f,n),t.defined(e._offsetAttribute)){var v=e._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,A=l.attributes.position.values.length,w=new Uint8Array(A/3);g.arrayFill(w,v),l.attributes.applyOffset=new u.GeometryAttribute({componentDatatype:d.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}}var T=l.attributes,G=i.BoundingSphere.fromVertices(T.position.values,void 0,3);return p.position||(l.attributes.position.values=void 0),new u.Geometry({attributes:T,indices:l.indices,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:G,offsetAttribute:e._offsetAttribute})}},Q.createShadowVolume=function(t,e,r){var a=t._granularity,i=t._ellipsoid,o=e(a,i),n=r(a,i);return new Q({positions:t._positions,width:t._width,cornerType:t._cornerType,ellipsoid:i,granularity:a,extrudedHeight:o,height:n,vertexFormat:C.VertexFormat.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(Q.prototype,{rectangle:{get:function(){return t.defined(this._rectangle)||(this._rectangle=K(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}}),tt}));