define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./BoundingSphere-bacc5cb6","./Matrix4-c65e6a1b","./RuntimeError-86da6af2","./Rectangle-c7d55cfa","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-70b679fd","./PrimitiveType-30fa6f85","./Transforms-7d49a8ab","./GeometryAttributes-9d45f9e2","./IndexDatatype-e52361bd","./IntersectionTests-6b77277e","./Plane-b4c954eb","./ArcType-39be7a32","./EllipsoidRhumbLine-4bc7760a","./EllipsoidGeodesic-1d7258d7","./PolylinePipeline-5cca45a5","./Color-cbe4364d"],(function(e,o,r,t,a,i,l,n,d,s,p,f,c,y,u,h,C,g,T,v,m,b){"use strict";function E(e,o,r,t,a,i,l){var n,d=m.PolylinePipeline.numberOfPoints(e,o,a),s=r.red,p=r.green,f=r.blue,c=r.alpha,y=t.red,u=t.green,h=t.blue,C=t.alpha;if(b.Color.equals(r,t)){for(n=0;n<d;n++)i[l++]=b.Color.floatToByte(s),i[l++]=b.Color.floatToByte(p),i[l++]=b.Color.floatToByte(f),i[l++]=b.Color.floatToByte(c);return l}var g=(y-s)/d,T=(u-p)/d,v=(h-f)/d,E=(C-c)/d,P=l;for(n=0;n<d;n++)i[P++]=b.Color.floatToByte(s+n*g),i[P++]=b.Color.floatToByte(p+n*T),i[P++]=b.Color.floatToByte(f+n*v),i[P++]=b.Color.floatToByte(c+n*E);return P}function P(a){a=e.defaultValue(a,e.defaultValue.EMPTY_OBJECT);var i=a.positions,l=a.colors,n=e.defaultValue(a.colorsPerVertex,!1);if(!e.defined(i)||i.length<2)throw new o.DeveloperError("At least two positions are required.");if(e.defined(l)&&(n&&l.length<i.length||!n&&l.length<i.length-1))throw new o.DeveloperError("colors has an invalid length.");this._positions=i,this._colors=l,this._colorsPerVertex=n,this._arcType=e.defaultValue(a.arcType,g.ArcType.GEODESIC),this._granularity=e.defaultValue(a.granularity,r.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=e.defaultValue(a.ellipsoid,t.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry";var d=1+i.length*r.Cartesian3.packedLength;d+=e.defined(l)?1+l.length*b.Color.packedLength:1,this.packedLength=d+t.Ellipsoid.packedLength+3}P.pack=function(a,i,l){if(!e.defined(a))throw new o.DeveloperError("value is required");if(!e.defined(i))throw new o.DeveloperError("array is required");var n;l=e.defaultValue(l,0);var d=a._positions,s=d.length;for(i[l++]=s,n=0;n<s;++n,l+=r.Cartesian3.packedLength)r.Cartesian3.pack(d[n],i,l);var p=a._colors;for(s=e.defined(p)?p.length:0,i[l++]=s,n=0;n<s;++n,l+=b.Color.packedLength)b.Color.pack(p[n],i,l);return t.Ellipsoid.pack(a._ellipsoid,i,l),l+=t.Ellipsoid.packedLength,i[l++]=a._colorsPerVertex?1:0,i[l++]=a._arcType,i[l]=a._granularity,i},P.unpack=function(a,i,l){if(!e.defined(a))throw new o.DeveloperError("array is required");var n;i=e.defaultValue(i,0);var d=a[i++],s=new Array(d);for(n=0;n<d;++n,i+=r.Cartesian3.packedLength)s[n]=r.Cartesian3.unpack(a,i);d=a[i++];var p=d>0?new Array(d):void 0;for(n=0;n<d;++n,i+=b.Color.packedLength)p[n]=b.Color.unpack(a,i);var f=t.Ellipsoid.unpack(a,i);i+=t.Ellipsoid.packedLength;var c=1===a[i++],y=a[i++],u=a[i];return e.defined(l)?(l._positions=s,l._colors=p,l._ellipsoid=f,l._colorsPerVertex=c,l._arcType=y,l._granularity=u,l):new P({positions:s,colors:p,ellipsoid:f,colorsPerVertex:c,arcType:y,granularity:u})};var _=new Array(2),B=new Array(2),A={positions:_,height:B,ellipsoid:void 0,minDistance:void 0,granularity:void 0};function w(o,r){return e.defined(r)&&(o=P.unpack(o,r)),o._ellipsoid=t.Ellipsoid.clone(o._ellipsoid),P.createGeometry(o)}return P.createGeometry=function(o){var t,i,l,n,d,c=o._positions,h=o._colors,C=o._colorsPerVertex,T=o._arcType,v=o._granularity,P=o._ellipsoid,w=r.CesiumMath.chordLength(v,P.maximumRadius),k=e.defined(h)&&!C,D=c.length,G=0;if(T===g.ArcType.GEODESIC||T===g.ArcType.RHUMB){var L,V,x;T===g.ArcType.GEODESIC?(L=r.CesiumMath.chordLength(v,P.maximumRadius),V=m.PolylinePipeline.numberOfPoints,x=m.PolylinePipeline.generateArc):(L=v,V=m.PolylinePipeline.numberOfPointsRhumbLine,x=m.PolylinePipeline.generateRhumbArc);var S=m.PolylinePipeline.extractHeights(c,P),R=A;if(T===g.ArcType.GEODESIC?R.minDistance=w:R.granularity=v,R.ellipsoid=P,k){var I=0;for(t=0;t<D-1;t++)I+=V(c[t],c[t+1],L)+1;i=new Float64Array(3*I),n=new Uint8Array(4*I),R.positions=_,R.height=B;var O=0;for(t=0;t<D-1;++t){_[0]=c[t],_[1]=c[t+1],B[0]=S[t],B[1]=S[t+1];var M=x(R);if(e.defined(h)){var U=M.length/3;d=h[t];for(var q=0;q<U;++q)n[O++]=b.Color.floatToByte(d.red),n[O++]=b.Color.floatToByte(d.green),n[O++]=b.Color.floatToByte(d.blue),n[O++]=b.Color.floatToByte(d.alpha)}i.set(M,G),G+=M.length}}else if(R.positions=c,R.height=S,i=new Float64Array(x(R)),e.defined(h)){for(n=new Uint8Array(i.length/3*4),t=0;t<D-1;++t){var N=c[t],F=c[t+1],H=h[t],W=h[t+1];G=E(N,F,H,W,w,n,G)}var Y=h[D-1];n[G++]=b.Color.floatToByte(Y.red),n[G++]=b.Color.floatToByte(Y.green),n[G++]=b.Color.floatToByte(Y.blue),n[G++]=b.Color.floatToByte(Y.alpha)}}else{l=k?2*D-2:D,i=new Float64Array(3*l),n=e.defined(h)?new Uint8Array(4*l):void 0;var z=0,J=0;for(t=0;t<D;++t){var j=c[t];if(k&&t>0&&(r.Cartesian3.pack(j,i,z),z+=3,d=h[t-1],n[J++]=b.Color.floatToByte(d.red),n[J++]=b.Color.floatToByte(d.green),n[J++]=b.Color.floatToByte(d.blue),n[J++]=b.Color.floatToByte(d.alpha)),k&&t===D-1)break;r.Cartesian3.pack(j,i,z),z+=3,e.defined(h)&&(d=h[t],n[J++]=b.Color.floatToByte(d.red),n[J++]=b.Color.floatToByte(d.green),n[J++]=b.Color.floatToByte(d.blue),n[J++]=b.Color.floatToByte(d.alpha))}}var K=new y.GeometryAttributes;K.position=new p.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:i}),e.defined(h)&&(K.color=new p.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:n,normalize:!0})),l=i.length/3;var Q=2*(l-1),X=u.IndexDatatype.createTypedArray(l,Q),Z=0;for(t=0;t<l-1;++t)X[Z++]=t,X[Z++]=t+1;return new p.Geometry({attributes:K,indices:X,primitiveType:f.PrimitiveType.LINES,boundingSphere:a.BoundingSphere.fromPoints(c)})},w}));