define(["./when-52cea266","./Check-ee5dd8a8","./Cartesian2-7c55a82d","./Rectangle-88e14f21","./BoundingSphere-f5553fb7","./Transforms-d0762529","./Matrix4-da50dd55","./RuntimeError-02840484","./WebGLConstants-52779751","./ComponentDatatype-fc6a16e1","./GeometryAttribute-60495dd3","./PrimitiveType-875d1f73","./GeometryAttributes-769ca2c2","./IndexDatatype-f9231b69","./IntersectionTests-ca78fc8a","./Plane-fdd70b9e","./ArcType-97079e95","./EllipsoidRhumbLine-90d09904","./EllipsoidGeodesic-69201d63","./PolylinePipeline-6fde5179","./Color-83f284c7"],(function(e,o,r,t,a,i,l,n,d,s,p,f,y,c,u,h,C,g,T,v,m){"use strict";function E(e,o,r,t,a,i,l){var n,d=v.PolylinePipeline.numberOfPoints(e,o,a),s=r.red,p=r.green,f=r.blue,y=r.alpha,c=t.red,u=t.green,h=t.blue,C=t.alpha;if(m.Color.equals(r,t)){for(n=0;n<d;n++)i[l++]=m.Color.floatToByte(s),i[l++]=m.Color.floatToByte(p),i[l++]=m.Color.floatToByte(f),i[l++]=m.Color.floatToByte(y);return l}var g=(c-s)/d,T=(u-p)/d,E=(h-f)/d,P=(C-y)/d,_=l;for(n=0;n<d;n++)i[_++]=m.Color.floatToByte(s+n*g),i[_++]=m.Color.floatToByte(p+n*T),i[_++]=m.Color.floatToByte(f+n*E),i[_++]=m.Color.floatToByte(y+n*P);return _}function P(a){a=e.defaultValue(a,e.defaultValue.EMPTY_OBJECT);var i=a.positions,l=a.colors,n=e.defaultValue(a.colorsPerVertex,!1);if(!e.defined(i)||i.length<2)throw new o.DeveloperError("At least two positions are required.");if(e.defined(l)&&(n&&l.length<i.length||!n&&l.length<i.length-1))throw new o.DeveloperError("colors has an invalid length.");this._positions=i,this._colors=l,this._colorsPerVertex=n,this._arcType=e.defaultValue(a.arcType,C.ArcType.GEODESIC),this._granularity=e.defaultValue(a.granularity,r.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=e.defaultValue(a.ellipsoid,t.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry";var d=1+i.length*r.Cartesian3.packedLength;d+=e.defined(l)?1+l.length*m.Color.packedLength:1,this.packedLength=d+t.Ellipsoid.packedLength+3}P.pack=function(a,i,l){if(!e.defined(a))throw new o.DeveloperError("value is required");if(!e.defined(i))throw new o.DeveloperError("array is required");var n;l=e.defaultValue(l,0);var d=a._positions,s=d.length;for(i[l++]=s,n=0;n<s;++n,l+=r.Cartesian3.packedLength)r.Cartesian3.pack(d[n],i,l);var p=a._colors;for(s=e.defined(p)?p.length:0,i[l++]=s,n=0;n<s;++n,l+=m.Color.packedLength)m.Color.pack(p[n],i,l);return t.Ellipsoid.pack(a._ellipsoid,i,l),l+=t.Ellipsoid.packedLength,i[l++]=a._colorsPerVertex?1:0,i[l++]=a._arcType,i[l]=a._granularity,i},P.unpack=function(a,i,l){if(!e.defined(a))throw new o.DeveloperError("array is required");var n;i=e.defaultValue(i,0);var d=a[i++],s=new Array(d);for(n=0;n<d;++n,i+=r.Cartesian3.packedLength)s[n]=r.Cartesian3.unpack(a,i);d=a[i++];var p=d>0?new Array(d):void 0;for(n=0;n<d;++n,i+=m.Color.packedLength)p[n]=m.Color.unpack(a,i);var f=t.Ellipsoid.unpack(a,i);i+=t.Ellipsoid.packedLength;var y=1===a[i++],c=a[i++],u=a[i];return e.defined(l)?(l._positions=s,l._colors=p,l._ellipsoid=f,l._colorsPerVertex=y,l._arcType=c,l._granularity=u,l):new P({positions:s,colors:p,ellipsoid:f,colorsPerVertex:y,arcType:c,granularity:u})};var _=new Array(2),B=new Array(2),A={positions:_,height:B,ellipsoid:void 0,minDistance:void 0,granularity:void 0};function w(o,r){return e.defined(r)&&(o=P.unpack(o,r)),o._ellipsoid=t.Ellipsoid.clone(o._ellipsoid),P.createGeometry(o)}return P.createGeometry=function(o){var t,i,l,n,d,u=o._positions,h=o._colors,g=o._colorsPerVertex,T=o._arcType,P=o._granularity,w=o._ellipsoid,b=r.CesiumMath.chordLength(P,w.maximumRadius),k=e.defined(h)&&!g,D=u.length,G=0;if(T===C.ArcType.GEODESIC||T===C.ArcType.RHUMB){var L,V,x;T===C.ArcType.GEODESIC?(L=r.CesiumMath.chordLength(P,w.maximumRadius),V=v.PolylinePipeline.numberOfPoints,x=v.PolylinePipeline.generateArc):(L=P,V=v.PolylinePipeline.numberOfPointsRhumbLine,x=v.PolylinePipeline.generateRhumbArc);var S=v.PolylinePipeline.extractHeights(u,w),R=A;if(T===C.ArcType.GEODESIC?R.minDistance=b:R.granularity=P,R.ellipsoid=w,k){var I=0;for(t=0;t<D-1;t++)I+=V(u[t],u[t+1],L)+1;i=new Float64Array(3*I),n=new Uint8Array(4*I),R.positions=_,R.height=B;var O=0;for(t=0;t<D-1;++t){_[0]=u[t],_[1]=u[t+1],B[0]=S[t],B[1]=S[t+1];var M=x(R);if(e.defined(h)){var U=M.length/3;d=h[t];for(var q=0;q<U;++q)n[O++]=m.Color.floatToByte(d.red),n[O++]=m.Color.floatToByte(d.green),n[O++]=m.Color.floatToByte(d.blue),n[O++]=m.Color.floatToByte(d.alpha)}i.set(M,G),G+=M.length}}else if(R.positions=u,R.height=S,i=new Float64Array(x(R)),e.defined(h)){for(n=new Uint8Array(i.length/3*4),t=0;t<D-1;++t){var N=u[t],F=u[t+1],H=h[t],W=h[t+1];G=E(N,F,H,W,b,n,G)}var Y=h[D-1];n[G++]=m.Color.floatToByte(Y.red),n[G++]=m.Color.floatToByte(Y.green),n[G++]=m.Color.floatToByte(Y.blue),n[G++]=m.Color.floatToByte(Y.alpha)}}else{l=k?2*D-2:D,i=new Float64Array(3*l),n=e.defined(h)?new Uint8Array(4*l):void 0;var z=0,J=0;for(t=0;t<D;++t){var j=u[t];if(k&&t>0&&(r.Cartesian3.pack(j,i,z),z+=3,d=h[t-1],n[J++]=m.Color.floatToByte(d.red),n[J++]=m.Color.floatToByte(d.green),n[J++]=m.Color.floatToByte(d.blue),n[J++]=m.Color.floatToByte(d.alpha)),k&&t===D-1)break;r.Cartesian3.pack(j,i,z),z+=3,e.defined(h)&&(d=h[t],n[J++]=m.Color.floatToByte(d.red),n[J++]=m.Color.floatToByte(d.green),n[J++]=m.Color.floatToByte(d.blue),n[J++]=m.Color.floatToByte(d.alpha))}}var K=new y.GeometryAttributes;K.position=new p.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:i}),e.defined(h)&&(K.color=new p.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:n,normalize:!0})),l=i.length/3;var Q=2*(l-1),X=c.IndexDatatype.createTypedArray(l,Q),Z=0;for(t=0;t<l-1;++t)X[Z++]=t,X[Z++]=t+1;return new p.Geometry({attributes:K,indices:X,primitiveType:f.PrimitiveType.LINES,boundingSphere:a.BoundingSphere.fromPoints(u)})},w}));