define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-ef6ea826","./Cartesian2-a652b463","./BoundingSphere-038d5fbc","./Transforms-c8a82813","./Matrix4-f54b529f","./RuntimeError-86da6af2","./WebGLConstants-3660bc8f","./ComponentDatatype-d28c2e26","./GeometryAttribute-dfebcc43","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./AttributeCompression-20de7c5b","./GeometryPipeline-f4ca2db7","./EncodedCartesian3-f0b88724","./IndexDatatype-6d2070e9","./IntersectionTests-b186d985","./Plane-a0c58786","./GeometryOffsetAttribute-dae9c424","./VertexFormat-06aa4e32","./GeometryInstance-0849bfce","./arrayRemoveDuplicates-e5b24eaf","./BoundingRectangle-13917389","./AxisAlignedBoundingBox-9187558e","./EllipsoidTangentPlane-dd3d1016","./ArcType-39be7a32","./EllipsoidRhumbLine-0c6cd7c8","./PolygonPipeline-28c8c9d7","./PolygonGeometryLibrary-887a96e9","./EllipsoidGeodesic-1abfd38d"],(function(e,t,r,a,o,i,n,s,l,u,p,c,m,y,d,g,h,f,v,b,P,_,w,C,x,T,A,I,E,G,N){"use strict";var O=new a.Cartographic,D=new a.Cartographic;function L(e,t,r,a){var o=a.cartesianToCartographic(e,O).height,i=a.cartesianToCartographic(t,D);i.height=o,a.cartographicToCartesian(i,t);var n=a.cartesianToCartographic(r,D);n.height=o-100,a.cartographicToCartesian(n,r)}var F=new C.BoundingRectangle,V=new r.Cartesian3,H=new r.Cartesian3,M=new r.Cartesian3,R=new r.Cartesian3,S=new r.Cartesian3,B=new r.Cartesian3,z=new r.Cartesian3,k=new r.Cartesian3,U=new r.Cartesian3,W=new a.Cartesian2,Y=new a.Cartesian2,Z=new r.Cartesian3,j=new i.Quaternion,Q=new n.Matrix3,q=new n.Matrix3;function K(t){var o=t.vertexFormat,s=t.geometry,l=t.shadowVolume,c=s.attributes.position.values,m=c.length,y=t.wall,d=t.top||y,g=t.bottom||y;let h=t.isPlaneMode;if(o.st||o.normal||o.tangent||o.bitangent||l){var f=t.boundingRectangle,v=t.tangentPlane,P=t.ellipsoid,_=t.stRotation,w=t.perPositionHeight,C=W;C.x=f.x,C.y=f.y;var x,T=o.st?new Float32Array(m/3*2):void 0;o.normal&&(x=w&&d&&!y?s.attributes.normal.values:new Float32Array(m));var A=o.tangent?new Float32Array(m):void 0,I=o.bitangent?new Float32Array(m):void 0,E=l?new Float32Array(m):void 0,G=0,N=0,O=H,D=M,F=R,K=!0,J=Q,X=q;if(0!==_){var $=i.Quaternion.fromAxisAngle(v._plane.normal,_,j);J=n.Matrix3.fromQuaternion($,J),$=i.Quaternion.fromAxisAngle(v._plane.normal,-_,j),X=n.Matrix3.fromQuaternion($,X)}else J=n.Matrix3.clone(n.Matrix3.IDENTITY,J),X=n.Matrix3.clone(n.Matrix3.IDENTITY,X);var ee=0,te=0;d&&g&&(ee=m/2,te=m/3,m/=2);for(var re=0;re<m;re+=3){var ae=r.Cartesian3.fromArray(c,re,Z);if(o.st){var oe=n.Matrix3.multiplyByVector(J,ae,V);oe=P.scaleToGeodeticSurface(oe,oe);var ie=v.projectPointOntoPlane(oe,Y);a.Cartesian2.subtract(ie,C,ie);var ne=r.CesiumMath.clamp(ie.x/f.width,0,1),se=r.CesiumMath.clamp(ie.y/f.height,0,1);g&&(T[G+te]=ne,T[G+1+te]=se),d&&(T[G]=ne,T[G+1]=se),G+=2}if(o.normal||o.tangent||o.bitangent||l){var le=N+1,ue=N+2;if(y){if(re+3<m){var pe=r.Cartesian3.fromArray(c,re+3,S);if(K){var ce=r.Cartesian3.fromArray(c,re+m,B);w&&!h?L(ae,pe,ce,P):h&&(pe.z=ae.z,ce.z=pe.z-100),r.Cartesian3.subtract(pe,ae,pe),r.Cartesian3.subtract(ce,ae,ce),O=r.Cartesian3.normalize(r.Cartesian3.cross(ce,pe,O),O),K=!1}r.Cartesian3.equalsEpsilon(pe,ae,r.CesiumMath.EPSILON10)&&(K=!0)}(o.tangent||o.bitangent)&&(F=P.geodeticSurfaceNormal(ae,F),o.tangent&&(D=r.Cartesian3.normalize(r.Cartesian3.cross(F,O,D),D)))}else O=h?r.Cartesian3.UNIT_Z:P.geodeticSurfaceNormal(ae,O),(o.tangent||o.bitangent)&&(w&&(z=r.Cartesian3.fromArray(x,N,z),k=r.Cartesian3.cross(r.Cartesian3.UNIT_Z,z,k),k=r.Cartesian3.normalize(n.Matrix3.multiplyByVector(X,k,k),k),o.bitangent&&(U=r.Cartesian3.normalize(r.Cartesian3.cross(z,k,U),U))),D=r.Cartesian3.cross(r.Cartesian3.UNIT_Z,O,D),D=r.Cartesian3.normalize(n.Matrix3.multiplyByVector(X,D,D),D),o.bitangent&&(F=r.Cartesian3.normalize(r.Cartesian3.cross(O,D,F),F)));o.normal&&(t.wall?(x[N+ee]=O.x,x[le+ee]=O.y,x[ue+ee]=O.z):g&&(x[N+ee]=-O.x,x[le+ee]=-O.y,x[ue+ee]=-O.z),(d&&!w||y)&&(x[N]=O.x,x[le]=O.y,x[ue]=O.z)),l&&(y&&(O=P.geodeticSurfaceNormal(ae,O)),E[N+ee]=-O.x,E[le+ee]=-O.y,E[ue+ee]=-O.z),o.tangent&&(t.wall?(A[N+ee]=D.x,A[le+ee]=D.y,A[ue+ee]=D.z):g&&(A[N+ee]=-D.x,A[le+ee]=-D.y,A[ue+ee]=-D.z),d&&(w?(A[N]=k.x,A[le]=k.y,A[ue]=k.z):(A[N]=D.x,A[le]=D.y,A[ue]=D.z))),o.bitangent&&(g&&(I[N+ee]=F.x,I[le+ee]=F.y,I[ue+ee]=F.z),d&&(w?(I[N]=U.x,I[le]=U.y,I[ue]=U.z):(I[N]=F.x,I[le]=F.y,I[ue]=F.z))),N+=3}}o.st&&(s.attributes.st=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:T})),o.normal&&(s.attributes.normal=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:x})),o.tangent&&(s.attributes.tangent=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:A})),o.bitangent&&(s.attributes.bitangent=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:I})),l&&(s.attributes.extrudeDirection=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:E}))}if(t.extrude&&e.defined(t.offsetAttribute)){var me=c.length/3,ye=new Uint8Array(me);if(t.offsetAttribute===b.GeometryOffsetAttribute.TOP)d&&g||y?ye=b.arrayFill(ye,1,0,me/2):d&&(ye=b.arrayFill(ye,1));else{var de=t.offsetAttribute===b.GeometryOffsetAttribute.NONE?0:1;ye=b.arrayFill(ye,de)}s.attributes.applyOffset=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:ye})}return s}var J=new a.Cartographic,X=new a.Cartographic,$={westOverIDL:0,eastOverIDL:0},ee=new N.EllipsoidGeodesic;function te(t,o,i,n,s){if(s=e.defaultValue(s,new a.Rectangle),!e.defined(t)||t.length<3)return s.west=0,s.north=0,s.south=0,s.east=0,s;if(i===A.ArcType.RHUMB)return a.Rectangle.fromCartesianArray(t,o,s);ee.ellipsoid.equals(o)||(ee=new N.EllipsoidGeodesic(void 0,void 0,o)),s.west=Number.POSITIVE_INFINITY,s.east=Number.NEGATIVE_INFINITY,s.south=Number.POSITIVE_INFINITY,s.north=Number.NEGATIVE_INFINITY,$.westOverIDL=Number.POSITIVE_INFINITY,$.eastOverIDL=Number.NEGATIVE_INFINITY;for(var l,u=1/r.CesiumMath.chordLength(n,o.maximumRadius),p=t.length,c=o.cartesianToCartographic(t[0],X),m=J,y=1;y<p;y++)l=m,m=c,c=o.cartesianToCartographic(t[y],l),ee.setEndPoints(m,c),ae(ee,u,s,$);return l=m,m=c,c=o.cartesianToCartographic(t[0],l),ee.setEndPoints(m,c),ae(ee,u,s,$),s.east-s.west>$.eastOverIDL-$.westOverIDL&&(s.west=$.westOverIDL,s.east=$.eastOverIDL,s.east>r.CesiumMath.PI&&(s.east=s.east-r.CesiumMath.TWO_PI),s.west>r.CesiumMath.PI&&(s.west=s.west-r.CesiumMath.TWO_PI)),s}var re=new a.Cartographic;function ae(e,t,a,o){for(var i=e.surfaceDistance,n=Math.ceil(i*t),s=n>0?i/(n-1):Number.POSITIVE_INFINITY,l=0,u=0;u<n;u++){var p=e.interpolateUsingSurfaceDistance(l,re);l+=s;var c=p.longitude,m=p.latitude;a.west=Math.min(a.west,c),a.east=Math.max(a.east,c),a.south=Math.min(a.south,m),a.north=Math.max(a.north,m);var y=c>=0?c:c+r.CesiumMath.TWO_PI;o.westOverIDL=Math.min(o.westOverIDL,y),o.eastOverIDL=Math.max(o.eastOverIDL,y)}}var oe=[];function ie(e,t,a,o,i,n,s,l,u,p){var c,m={walls:[]};if(n||s){var y,d,g=G.PolygonGeometryLibrary.createGeometryFromPositions(e,t,a,i,l,u,p),f=g.attributes.position.values,b=g.indices;if(n&&s){var P=f.concat(f);y=P.length/3,(d=h.IndexDatatype.createTypedArray(y,2*b.length)).set(b);var w=b.length,C=y/2;for(c=0;c<w;c+=3){var x=d[c]+C,A=d[c+1]+C,I=d[c+2]+C;d[c+w]=I,d[c+1+w]=A,d[c+2+w]=x}if(g.attributes.position.values=P,i&&l.normal){var N=g.attributes.normal.values;g.attributes.normal.values=new Float32Array(P.length),g.attributes.normal.values.set(N)}g.indices=d}else if(s){for(y=f.length/3,d=h.IndexDatatype.createTypedArray(y,b.length),c=0;c<b.length;c+=3)d[c]=b[c+2],d[c+1]=b[c+1],d[c+2]=b[c];g.indices=d}m.topAndBottom=new _.GeometryInstance({geometry:g})}var O=o.outerRing,D=(p?v.Plane.fromPointNormal(O[0],r.Cartesian3.UNIT_Z):T.EllipsoidTangentPlane.fromPoints(O,e)).projectPointsOntoPlane(O,oe),L=E.PolygonPipeline.computeWindingOrder2D(D);L===E.WindingOrder.CLOCKWISE&&(O=O.slice().reverse());var F=G.PolygonGeometryLibrary.computeWallGeometry(O,e,a,i,u,p);m.walls.push(new _.GeometryInstance({geometry:F}));var V=o.holes;for(c=0;c<V.length;c++){var H=V[c];D=(p?v.Plane.fromPointNormal(H[0],r.Cartesian3.UNIT_Z):T.EllipsoidTangentPlane.fromPoints(H,e)).projectPointsOntoPlane(H,oe),(L=E.PolygonPipeline.computeWindingOrder2D(D))===E.WindingOrder.COUNTER_CLOCKWISE&&(H=H.slice().reverse()),F=G.PolygonGeometryLibrary.computeWallGeometry(H,e,a,i,u,p),m.walls.push(new _.GeometryInstance({geometry:F}))}return m}function ne(t){var o=t.polygonHierarchy,i=e.defaultValue(t.vertexFormat,P.VertexFormat.DEFAULT),n=e.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84),s=e.defaultValue(t.granularity,r.CesiumMath.RADIANS_PER_DEGREE),l=e.defaultValue(t.stRotation,0),u=e.defaultValue(t.perPositionHeight,!1),p=u&&e.defined(t.extrudedHeight),c=e.defaultValue(t.height,0),m=e.defaultValue(t.extrudedHeight,c);if(!p){var y=Math.max(c,m);m=Math.min(c,m),c=y}this._vertexFormat=P.VertexFormat.clone(i),this._ellipsoid=a.Ellipsoid.clone(n),this._granularity=s,this._stRotation=l,this._height=c,this._extrudedHeight=m,this._closeTop=e.defaultValue(t.closeTop,!0),this._closeBottom=e.defaultValue(t.closeBottom,!0),this._polygonHierarchy=o,this._perPositionHeight=u,this._perPositionHeightExtrude=p,this._shadowVolume=e.defaultValue(t.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=t.offsetAttribute,this._arcType=e.defaultValue(t.arcType,A.ArcType.GEODESIC),this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this.packedLength=G.PolygonGeometryLibrary.computeHierarchyPackedLength(o)+a.Ellipsoid.packedLength+P.VertexFormat.packedLength+12}ne.fromPositions=function(t){return new ne({polygonHierarchy:{positions:(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).positions},height:t.height,extrudedHeight:t.extrudedHeight,vertexFormat:t.vertexFormat,stRotation:t.stRotation,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,closeTop:t.closeTop,closeBottom:t.closeBottom,offsetAttribute:t.offsetAttribute,arcType:t.arcType})},ne.createBorderLine=function(e){let t,a,i=e.positions,n=e.height;if(!0===e.compressPlane){let e=1/0;i.forEach((t=>{e=Math.min(e,t.z)})),t=i.map((t=>new r.Cartesian3(t.x,t.y,e+n))),a=i.map((t=>new r.Cartesian3(t.x,t.y,e)))}else t=i.map((e=>new r.Cartesian3(e.x,e.y,e.z+n))),a=i.map((e=>new r.Cartesian3(e.x,e.y,e.z)));let s=[...a,...t],l=[];s.forEach((e=>{l.push(e.x,e.y,e.z)}));let y=[];t.pop(),t.forEach(((e,t)=>{y.push(t,t+1)})),y.push(t.length,0);let d=a.length,g=y.map((e=>e+d));y.push(...g),g.forEach((e=>{y.push(e-d,e)}));let h=o.BoundingSphere.fromPoints(i);return new p.Geometry({attributes:new m.GeometryAttributes({position:new p.GeometryAttribute({values:new Float64Array(l),componentsPerAttribute:3,componentDatatype:u.ComponentDatatype.DOUBLE})}),indices:new Uint16Array(y),primitiveType:c.PrimitiveType.LINES,boundingSphere:h})},ne.fromPositionsPlaneMode=function(e){let t,a,i=e.positions,n=e.height,s=new Array(2*i.length);i.forEach(((e,t)=>{s[2*t]=e.x,s[2*t+1]=e.y}));let l=E.earcut(s);if(!0===e.compressPlane){let e=1/0;i.forEach((t=>{e=Math.min(e,t.z)})),t=i.map((t=>new r.Cartesian3(t.x,t.y,e+n))),a=i.map((t=>new r.Cartesian3(t.x,t.y,e)))}else t=i.map((e=>new r.Cartesian3(e.x,e.y,e.z+n))),a=i.map((e=>new r.Cartesian3(e.x,e.y,e.z)));let y=[...a],d=[...l.slice().reverse()];if(e.height){let e=a.length;a.forEach(((t,r)=>{r+1===e?d.push(r,0,e,r,e,r+e):d.push(r,r+1,r+e+1,r,r+e+1,r+e)})),y.push(...t);let r=l.map((t=>t+e));d.push(...r)}let g=new Array(3*y.length);y.forEach(((e,t)=>{g[3*t]=e.x,g[3*t+1]=e.y,g[3*t+2]=e.z}));let h=o.BoundingSphere.fromPoints(i);return o.BoundingSphere.expandDistance(h,n/2,r.Cartesian3.UNIT_Z,h),new p.Geometry({attributes:new m.GeometryAttributes({position:new p.GeometryAttribute({values:new Float64Array(g),componentsPerAttribute:3,componentDatatype:u.ComponentDatatype.DOUBLE})}),indices:new Uint16Array(d),primitiveType:c.PrimitiveType.TRIANGLES,boundingSphere:h})},ne.pack=function(t,r,o){return o=e.defaultValue(o,0),o=G.PolygonGeometryLibrary.packPolygonHierarchy(t._polygonHierarchy,r,o),a.Ellipsoid.pack(t._ellipsoid,r,o),ne.isPlaneMode?(r[o++]=0,r[o++]=0,r[o++]=1):o+=a.Ellipsoid.packedLength,P.VertexFormat.pack(t._vertexFormat,r,o),o+=P.VertexFormat.packedLength,r[o++]=t._height,r[o++]=t._extrudedHeight,r[o++]=t._granularity,r[o++]=t._stRotation,r[o++]=t._perPositionHeightExtrude?1:0,r[o++]=t._perPositionHeight?1:0,r[o++]=t._closeTop?1:0,r[o++]=t._closeBottom?1:0,r[o++]=t._shadowVolume?1:0,r[o++]=e.defaultValue(t._offsetAttribute,-1),r[o++]=t._arcType,r[o]=t.packedLength,r};var se=a.Ellipsoid.clone(a.Ellipsoid.UNIT_SPHERE),le=new P.VertexFormat,ue={polygonHierarchy:{}};return ne.unpack=function(t,r,o){r=e.defaultValue(r,0);var i=G.PolygonGeometryLibrary.unpackPolygonHierarchy(t,r);r=i.startingIndex,delete i.startingIndex;let n=0===t[r+1];var s=a.Ellipsoid.unpack(t,r,se);r+=a.Ellipsoid.packedLength;var l=P.VertexFormat.unpack(t,r,le);r+=P.VertexFormat.packedLength;var u=t[r++],p=t[r++],c=t[r++],m=t[r++],y=1===t[r++],d=1===t[r++],g=1===t[r++],h=1===t[r++],f=1===t[r++],v=t[r++],b=t[r++],_=t[r];return e.defined(o)||(o=new ne(ue)),o._polygonHierarchy=i,o._ellipsoid=a.Ellipsoid.clone(s,o._ellipsoid),o._vertexFormat=P.VertexFormat.clone(l,o._vertexFormat),o._height=u,o._extrudedHeight=p,o._granularity=c,o._stRotation=m,o._perPositionHeightExtrude=y,o._perPositionHeight=d,o._closeTop=g,o._closeBottom=h,o._shadowVolume=f,o._isPlaneMode=n,o._offsetAttribute=-1===v?void 0:v,o._arcType=b,o.packedLength=_,o},ne.computeRectangle=function(t,o){var i=e.defaultValue(t.granularity,r.CesiumMath.RADIANS_PER_DEGREE),n=e.defaultValue(t.arcType,A.ArcType.GEODESIC),s=t.polygonHierarchy,l=e.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84);return te(s.positions,l,n,i,o)},ne.createGeometry=function(t){var a=t._vertexFormat,i=t._ellipsoid,n=t._granularity,s=t._stRotation,l=t._polygonHierarchy,c=t._perPositionHeight,m=t._closeTop,y=t._closeBottom,g=t._arcType;let f=t._isPlaneMode;var P=l.positions;if(!(P.length<3)){var w;w=f?v.Plane.fromPointNormal(P[0],r.Cartesian3.UNIT_Z):T.EllipsoidTangentPlane.fromPoints(P,i);var C=G.PolygonGeometryLibrary.polygonsFromHierarchy(l,f?void 0:w.projectPointsOntoPlane.bind(w),!c,i),x=C.hierarchy,A=C.polygons;if(0!==x.length){var I;P=x[0].outerRing,I=f?G.PolygonGeometryLibrary.computeBoundingRectanglePlaneMode(P,F):G.PolygonGeometryLibrary.computeBoundingRectangle(w.plane.normal,w.projectPointOntoPlane.bind(w),P,s,F);var N,O=[],D=t._height,L=t._extrudedHeight,V={perPositionHeight:c,vertexFormat:a,geometry:void 0,tangentPlane:w,boundingRectangle:I,ellipsoid:i,stRotation:s,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:g,isPlaneMode:f};if(t._perPositionHeightExtrude||!r.CesiumMath.equalsEpsilon(D,L,0,r.CesiumMath.EPSILON2))for(V.extrude=!0,V.top=m,V.bottom=y,V.shadowVolume=t._shadowVolume,V.offsetAttribute=t._offsetAttribute,N=0;N<A.length;N++){var H,M=ie(i,A[N],n,x[N],c,m,y,a,g,f);m&&y?(H=M.topAndBottom,V.geometry=G.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(H.geometry,D,L,i,c,f)):m?((H=M.topAndBottom).geometry.attributes.position.values=E.PolygonPipeline.scaleToGeodeticHeight(H.geometry.attributes.position.values,D,i,!c,f),V.geometry=H.geometry):y&&((H=M.topAndBottom).geometry.attributes.position.values=E.PolygonPipeline.scaleToGeodeticHeight(H.geometry.attributes.position.values,L,i,!0,f),V.geometry=H.geometry),(m||y)&&(V.wall=!1,H.geometry=K(V),O.push(H));var R=M.walls;V.wall=!0;for(var S=0;S<R.length;S++){var B=R[S];V.geometry=G.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(B.geometry,D,L,i,c,f),B.geometry=K(V),O.push(B)}}else for(N=0;N<A.length;N++){var z=new _.GeometryInstance({geometry:G.PolygonGeometryLibrary.createGeometryFromPositions(i,A[N],n,c,a,g,f)});if(z.geometry.attributes.position.values=E.PolygonPipeline.scaleToGeodeticHeight(z.geometry.attributes.position.values,D,i,!c,f),V.geometry=z.geometry,z.geometry=K(V),e.defined(t._offsetAttribute)){var k=z.geometry.attributes.position.values.length,U=new Uint8Array(k/3),W=t._offsetAttribute===b.GeometryOffsetAttribute.NONE?0:1;b.arrayFill(U,W),z.geometry.attributes.applyOffset=new p.GeometryAttribute({componentDatatype:u.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:U})}O.push(z)}var Y=d.GeometryPipeline.combineInstances(O)[0];Y.attributes.position.values=new Float64Array(Y.attributes.position.values),Y.indices=h.IndexDatatype.createTypedArray(Y.attributes.position.values.length/3,Y.indices);var Z=Y.attributes,j=o.BoundingSphere.fromVertices(Z.position.values);return a.position||delete Z.position,new p.Geometry({attributes:Z,indices:Y.indices,primitiveType:Y.primitiveType,boundingSphere:j,offsetAttribute:t._offsetAttribute})}}},ne.createShadowVolume=function(e,t,r){var a=e._granularity,o=e._ellipsoid,i=t(a,o),n=r(a,o);return new ne({polygonHierarchy:e._polygonHierarchy,ellipsoid:o,stRotation:e._stRotation,granularity:a,perPositionHeight:!1,extrudedHeight:i,height:n,vertexFormat:P.VertexFormat.POSITION_ONLY,shadowVolume:!0,arcType:e._arcType})},Object.defineProperties(ne.prototype,{rectangle:{get:function(){if(!e.defined(this._rectangle)){var t=this._polygonHierarchy.positions;this._rectangle=te(t,this._ellipsoid,this._arcType,this._granularity)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return e.defined(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];var r=e._ellipsoid,a=e._polygonHierarchy.positions,o=e.rectangle;return p.Geometry._textureCoordinateRotationPoints(a,t,r,o)}(this)),this._textureCoordinateRotationPoints}}}),function(t,r){return e.defined(r)&&(t=ne.unpack(t,r)),t._ellipsoid=a.Ellipsoid.clone(t._ellipsoid),ne.createGeometry(t)}}));