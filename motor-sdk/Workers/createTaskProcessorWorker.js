define(["./when-45f3d25d"],(function(e){"use strict";function r(r){var n,t=r.name,s=r.message;n=e.defined(t)&&e.defined(s)?t+": "+s:r.toString();var a=r.stack;return e.defined(a)&&(n+="\n"+a),n}function n(r,n,t){var s;try{return s=r(n,t),s}catch(a){return e.when.reject(a)}}function t(t){var s;return function(a){var i=a.data,o=[],f={id:i.id,result:void 0,error:void 0};return e.when(n(t,i.parameters,o)).then((function(e){f.result=e})).otherwise((function(e){e instanceof Error?f.error={name:e.name,message:e.message,stack:e.stack}:f.error=e})).always((function(){e.defined(s)||(s=e.defaultValue(self.webkitPostMessage,self.postMessage)),i.canTransferArrayBuffer||(o.length=0);try{s(f,o)}catch(n){f.result=void 0,f.error="postMessage failed with error: "+r(n)+"\n  with responseMessage: "+JSON.stringify(f),s(f)}}))}}return t}));