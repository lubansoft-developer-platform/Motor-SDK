define(["exports","./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./Matrix4-c65e6a1b","./Rectangle-c7d55cfa"],(function(e,a,t,r,n,i,s){"use strict";function c(e){this._ellipsoid=a.defaultValue(e,n.Ellipsoid.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(c.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),c.prototype.project=function(e,t){var n=this._semimajorAxis,i=e.longitude*n,s=e.latitude*n,c=e.height;return a.defined(t)?(t.x=i,t.y=s,t.z=c,t):new r.Cartesian3(i,s,c)},c.prototype.unproject=function(e,r){if(!a.defined(e))throw new t.DeveloperError("cartesian is required");var i=this._oneOverSemimajorAxis,s=e.x*i,c=e.y*i,u=e.z;return a.defined(r)?(r.longitude=s,r.latitude=c,r.height=u,r):new n.Cartographic(s,c,u)};var u={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},d=Object.freeze(u);function o(e,t){this.start=a.defaultValue(e,0),this.stop=a.defaultValue(t,0)}function C(e,t){this.center=r.Cartesian3.clone(a.defaultValue(e,r.Cartesian3.ZERO)),this.radius=a.defaultValue(t,0)}var l=new r.Cartesian3,f=new r.Cartesian3,h=new r.Cartesian3,y=new r.Cartesian3,p=new r.Cartesian3,v=new r.Cartesian3,m=new r.Cartesian3,x=new r.Cartesian3,g=new r.Cartesian3,z=new r.Cartesian3,b=new r.Cartesian3,w=new r.Cartesian3,O=4/3*r.CesiumMath.PI;C.fromPoints=function(e,t){if(a.defined(t)||(t=new C),!a.defined(e)||0===e.length)return t.center=r.Cartesian3.clone(r.Cartesian3.ZERO,t.center),t.radius=0,t;var n,i=r.Cartesian3.clone(e[0],m),s=r.Cartesian3.clone(i,l),c=r.Cartesian3.clone(i,f),u=r.Cartesian3.clone(i,h),d=r.Cartesian3.clone(i,y),o=r.Cartesian3.clone(i,p),O=r.Cartesian3.clone(i,v),S=e.length;for(n=1;n<S;n++){r.Cartesian3.clone(e[n],i);var q=i.x,j=i.y,k=i.z;q<s.x&&r.Cartesian3.clone(i,s),q>d.x&&r.Cartesian3.clone(i,d),j<c.y&&r.Cartesian3.clone(i,c),j>o.y&&r.Cartesian3.clone(i,o),k<u.z&&r.Cartesian3.clone(i,u),k>O.z&&r.Cartesian3.clone(i,O)}var E=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(d,s,x)),R=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(o,c,x)),M=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(O,u,x)),I=s,P=d,V=E;R>V&&(V=R,I=c,P=o),M>V&&(V=M,I=u,P=O);var T=g;T.x=.5*(I.x+P.x),T.y=.5*(I.y+P.y),T.z=.5*(I.z+P.z);var B=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(P,T,x)),D=Math.sqrt(B),Z=z;Z.x=s.x,Z.y=c.y,Z.z=u.z;var _=b;_.x=d.x,_.y=o.y,_.z=O.z;var N=r.Cartesian3.midpoint(Z,_,w),A=0;for(n=0;n<S;n++){r.Cartesian3.clone(e[n],i);var G=r.Cartesian3.magnitude(r.Cartesian3.subtract(i,N,x));G>A&&(A=G);var W=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(i,T,x));if(W>B){var U=Math.sqrt(W);D=.5*(D+U),B=D*D;var H=U-D;T.x=(D*T.x+H*i.x)/U,T.y=(D*T.y+H*i.y)/U,T.z=(D*T.z+H*i.z)/U}}return D<A?(r.Cartesian3.clone(T,t.center),t.radius=D):(r.Cartesian3.clone(N,t.center),t.radius=A),t},C.fromInstancePoints=function(e,t,n){if(a.defined(t)||(t=new C),!a.defined(e)||0===n)return t.center=r.Cartesian3.clone(r.Cartesian3.ZERO,t.center),t.radius=0,t;var i,s=r.Cartesian3.clone(e[0],m),c=r.Cartesian3.clone(s,l),u=r.Cartesian3.clone(s,f),d=r.Cartesian3.clone(s,h),o=r.Cartesian3.clone(s,y),O=r.Cartesian3.clone(s,p),S=r.Cartesian3.clone(s,v);for(i=1;i<n;i++){r.Cartesian3.clone(e[i],s);var q=s.x,j=s.y,k=s.z;q<c.x&&r.Cartesian3.clone(s,c),q>o.x&&r.Cartesian3.clone(s,o),j<u.y&&r.Cartesian3.clone(s,u),j>O.y&&r.Cartesian3.clone(s,O),k<d.z&&r.Cartesian3.clone(s,d),k>S.z&&r.Cartesian3.clone(s,S)}var E=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(o,c,x)),R=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(O,u,x)),M=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(S,d,x)),I=c,P=o,V=E;R>V&&(V=R,I=u,P=O),M>V&&(V=M,I=d,P=S);var T=g;T.x=.5*(I.x+P.x),T.y=.5*(I.y+P.y),T.z=.5*(I.z+P.z);var B=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(P,T,x)),D=Math.sqrt(B),Z=z;Z.x=c.x,Z.y=u.y,Z.z=d.z;var _=b;_.x=o.x,_.y=O.y,_.z=S.z;var N=r.Cartesian3.midpoint(Z,_,w),A=0;for(i=0;i<n;i++){r.Cartesian3.clone(e[i],s);var G=r.Cartesian3.magnitude(r.Cartesian3.subtract(s,N,x));G>A&&(A=G);var W=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(s,T,x));if(W>B){var U=Math.sqrt(W);D=.5*(D+U),B=D*D;var H=U-D;T.x=(D*T.x+H*s.x)/U,T.y=(D*T.y+H*s.y)/U,T.z=(D*T.z+H*s.z)/U}}return D<A?(r.Cartesian3.clone(T,t.center),t.radius=D):(r.Cartesian3.clone(N,t.center),t.radius=A),t},C.isIntersect=function(e,a){let t=r.Cartesian3.distance(e.center,a.center);return!(t>e.radius+a.radius)},C.isInclude=function(e,a){let t=r.Cartesian3.distance(e.center,a.center);return e.radius>t+a.radius};var S=new c,q=new r.Cartesian3,j=new r.Cartesian3,k=new n.Cartographic,E=new n.Cartographic;C.fromRectangle2D=function(e,a,t){return C.fromRectangleWithHeights2D(e,a,0,0,t)},C.fromRectangleWithHeights2D=function(e,t,n,i,c){if(a.defined(c)||(c=new C),!a.defined(e))return c.center=r.Cartesian3.clone(r.Cartesian3.ZERO,c.center),c.radius=0,c;t=a.defaultValue(t,S),s.Rectangle.southwest(e,k),k.height=n,s.Rectangle.northeast(e,E),E.height=i;var u=t.project(k,q),d=t.project(E,j),o=d.x-u.x,l=d.y-u.y,f=d.z-u.z;c.radius=.5*Math.sqrt(o*o+l*l+f*f);var h=c.center;return h.x=u.x+.5*o,h.y=u.y+.5*l,h.z=u.z+.5*f,c};var R=[];C.fromRectangle3D=function(e,t,i,c){if(t=a.defaultValue(t,n.Ellipsoid.WGS84),i=a.defaultValue(i,0),a.defined(c)||(c=new C),!a.defined(e))return c.center=r.Cartesian3.clone(r.Cartesian3.ZERO,c.center),c.radius=0,c;var u=s.Rectangle.subsample(e,t,i,R);return C.fromPoints(u,c)},C.fromVertices=function(e,n,i,s){if(a.defined(s)||(s=new C),!a.defined(e)||0===e.length)return s.center=r.Cartesian3.clone(r.Cartesian3.ZERO,s.center),s.radius=0,s;n=a.defaultValue(n,r.Cartesian3.ZERO),i=a.defaultValue(i,3),t.Check.typeOf.number.greaterThanOrEquals("stride",i,3);var c=m;c.x=e[0]+n.x,c.y=e[1]+n.y,c.z=e[2]+n.z;var u,d=r.Cartesian3.clone(c,l),o=r.Cartesian3.clone(c,f),O=r.Cartesian3.clone(c,h),S=r.Cartesian3.clone(c,y),q=r.Cartesian3.clone(c,p),j=r.Cartesian3.clone(c,v),k=e.length;for(u=0;u<k;u+=i){var E=e[u]+n.x,R=e[u+1]+n.y,M=e[u+2]+n.z;c.x=E,c.y=R,c.z=M,E<d.x&&r.Cartesian3.clone(c,d),E>S.x&&r.Cartesian3.clone(c,S),R<o.y&&r.Cartesian3.clone(c,o),R>q.y&&r.Cartesian3.clone(c,q),M<O.z&&r.Cartesian3.clone(c,O),M>j.z&&r.Cartesian3.clone(c,j)}var I=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(S,d,x)),P=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(q,o,x)),V=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(j,O,x)),T=d,B=S,D=I;P>D&&(D=P,T=o,B=q),V>D&&(D=V,T=O,B=j);var Z=g;Z.x=.5*(T.x+B.x),Z.y=.5*(T.y+B.y),Z.z=.5*(T.z+B.z);var _=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(B,Z,x)),N=Math.sqrt(_),A=z;A.x=d.x,A.y=o.y,A.z=O.z;var G=b;G.x=S.x,G.y=q.y,G.z=j.z;var W=r.Cartesian3.midpoint(A,G,w),U=0;for(u=0;u<k;u+=i){c.x=e[u]+n.x,c.y=e[u+1]+n.y,c.z=e[u+2]+n.z;var H=r.Cartesian3.magnitude(r.Cartesian3.subtract(c,W,x));H>U&&(U=H);var L=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(c,Z,x));if(L>_){var X=Math.sqrt(L);N=.5*(N+X),_=N*N;var F=X-N;Z.x=(N*Z.x+F*c.x)/X,Z.y=(N*Z.y+F*c.y)/X,Z.z=(N*Z.z+F*c.z)/X}}return N<U?(r.Cartesian3.clone(Z,s.center),s.radius=N):(r.Cartesian3.clone(W,s.center),s.radius=U),s},C.fromEncodedCartesianVertices=function(e,t,n){if(a.defined(n)||(n=new C),!a.defined(e)||!a.defined(t)||e.length!==t.length||0===e.length)return n.center=r.Cartesian3.clone(r.Cartesian3.ZERO,n.center),n.radius=0,n;var i=m;i.x=e[0]+t[0],i.y=e[1]+t[1],i.z=e[2]+t[2];var s,c=r.Cartesian3.clone(i,l),u=r.Cartesian3.clone(i,f),d=r.Cartesian3.clone(i,h),o=r.Cartesian3.clone(i,y),O=r.Cartesian3.clone(i,p),S=r.Cartesian3.clone(i,v),q=e.length;for(s=0;s<q;s+=3){var j=e[s]+t[s],k=e[s+1]+t[s+1],E=e[s+2]+t[s+2];i.x=j,i.y=k,i.z=E,j<c.x&&r.Cartesian3.clone(i,c),j>o.x&&r.Cartesian3.clone(i,o),k<u.y&&r.Cartesian3.clone(i,u),k>O.y&&r.Cartesian3.clone(i,O),E<d.z&&r.Cartesian3.clone(i,d),E>S.z&&r.Cartesian3.clone(i,S)}var R=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(o,c,x)),M=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(O,u,x)),I=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(S,d,x)),P=c,V=o,T=R;M>T&&(T=M,P=u,V=O),I>T&&(T=I,P=d,V=S);var B=g;B.x=.5*(P.x+V.x),B.y=.5*(P.y+V.y),B.z=.5*(P.z+V.z);var D=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(V,B,x)),Z=Math.sqrt(D),_=z;_.x=c.x,_.y=u.y,_.z=d.z;var N=b;N.x=o.x,N.y=O.y,N.z=S.z;var A=r.Cartesian3.midpoint(_,N,w),G=0;for(s=0;s<q;s+=3){i.x=e[s]+t[s],i.y=e[s+1]+t[s+1],i.z=e[s+2]+t[s+2];var W=r.Cartesian3.magnitude(r.Cartesian3.subtract(i,A,x));W>G&&(G=W);var U=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(i,B,x));if(U>D){var H=Math.sqrt(U);Z=.5*(Z+H),D=Z*Z;var L=H-Z;B.x=(Z*B.x+L*i.x)/H,B.y=(Z*B.y+L*i.y)/H,B.z=(Z*B.z+L*i.z)/H}}return Z<G?(r.Cartesian3.clone(B,n.center),n.radius=Z):(r.Cartesian3.clone(A,n.center),n.radius=G),n},C.fromCornerPoints=function(e,n,i){t.Check.typeOf.object("corner",e),t.Check.typeOf.object("oppositeCorner",n),a.defined(i)||(i=new C);var s=r.Cartesian3.midpoint(e,n,i.center);return i.radius=r.Cartesian3.distance(s,n),i},C.fromEllipsoid=function(e,n){return t.Check.typeOf.object("ellipsoid",e),a.defined(n)||(n=new C),r.Cartesian3.clone(r.Cartesian3.ZERO,n.center),n.radius=e.maximumRadius,n};var M=new r.Cartesian3;C.fromBoundingSpheres=function(e,t){if(a.defined(t)||(t=new C),!a.defined(e)||0===e.length)return t.center=r.Cartesian3.clone(r.Cartesian3.ZERO,t.center),t.radius=0,t;var n=e.length;if(1===n)return C.clone(e[0],t);if(2===n)return C.union(e[0],e[1],t);var i,s=[];for(i=0;i<n;i++)s.push(e[i].center);t=C.fromPoints(s,t);var c=t.center,u=t.radius;for(i=0;i<n;i++){var d=e[i];u=Math.max(u,r.Cartesian3.distance(c,d.center,M)+d.radius)}return t.radius=u,t};var I=new r.Cartesian3,P=new r.Cartesian3,V=new r.Cartesian3;C.fromOrientedBoundingBox=function(e,n){t.Check.defined("orientedBoundingBox",e),a.defined(n)||(n=new C);var s=e.halfAxes,c=i.Matrix3.getColumn(s,0,I),u=i.Matrix3.getColumn(s,1,P),d=i.Matrix3.getColumn(s,2,V);return r.Cartesian3.add(c,u,c),r.Cartesian3.add(c,d,c),n.center=r.Cartesian3.clone(e.center,n.center),n.radius=r.Cartesian3.magnitude(c),n},C.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.center=r.Cartesian3.clone(e.center,t.center),t.radius=e.radius,t):new C(e.center,e.radius)},C.packedLength=4,C.pack=function(e,r,n){t.Check.typeOf.object("value",e),t.Check.defined("array",r),n=a.defaultValue(n,0);var i=e.center;return r[n++]=i.x,r[n++]=i.y,r[n++]=i.z,r[n]=e.radius,r},C.unpack=function(e,r,n){t.Check.defined("array",e),r=a.defaultValue(r,0),a.defined(n)||(n=new C);var i=n.center;return i.x=e[r++],i.y=e[r++],i.z=e[r++],n.radius=e[r],n};var T=new r.Cartesian3,B=new r.Cartesian3;C.union=function(e,n,i){t.Check.typeOf.object("left",e),t.Check.typeOf.object("right",n),a.defined(i)||(i=new C);var s=e.center,c=e.radius,u=n.center,d=n.radius,o=r.Cartesian3.subtract(u,s,T),l=r.Cartesian3.magnitude(o);if(c>=l+d)return e.clone(i),i;if(d>=l+c)return n.clone(i),i;var f=.5*(c+l+d),h=r.Cartesian3.multiplyByScalar(o,(-c+f)/l,B);return r.Cartesian3.add(h,s,h),r.Cartesian3.clone(h,i.center),i.radius=f,i};var D=new r.Cartesian3;C.expand=function(e,a,n){t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("point",a),n=C.clone(e,n);var i=r.Cartesian3.magnitude(r.Cartesian3.subtract(a,n.center,D));return i>n.radius&&(n.radius=i),n},C.intersectPlane=function(e,a){t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("plane",a);var n=e.center,i=e.radius,s=a.normal,c=r.Cartesian3.dot(s,n)+a.distance;return c<-i?d.OUTSIDE:c<i?d.INTERSECTING:d.INSIDE},C.transform=function(e,r,n){return t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("transform",r),a.defined(n)||(n=new C),n.center=i.Matrix4.multiplyByPoint(r,e.center,n.center),n.radius=i.Matrix4.getMaximumScale(r)*e.radius,n};var Z=new r.Cartesian3;C.distanceSquaredTo=function(e,a){t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("cartesian",a);var n=r.Cartesian3.subtract(e.center,a,Z);return r.Cartesian3.magnitudeSquared(n)-e.radius*e.radius},C.transformWithoutScale=function(e,r,n){return t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("transform",r),a.defined(n)||(n=new C),n.center=i.Matrix4.multiplyByPoint(r,e.center,n.center),n.radius=e.radius,n};var _=new r.Cartesian3;C.computePlaneDistances=function(e,n,i,s){t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("position",n),t.Check.typeOf.object("direction",i),a.defined(s)||(s=new o);var c=r.Cartesian3.subtract(e.center,n,_),u=r.Cartesian3.dot(i,c);return s.start=u-e.radius,s.stop=u+e.radius,s};for(var N=new r.Cartesian3,A=new r.Cartesian3,G=new r.Cartesian3,W=new r.Cartesian3,U=new r.Cartesian3,H=new n.Cartographic,L=new Array(8),X=0;X<8;++X)L[X]=new r.Cartesian3;var F=new c;C.projectTo2D=function(e,n,i){t.Check.typeOf.object("sphere",e),n=a.defaultValue(n,F);var s,c=n.ellipsoid,u=e.center,d=e.radius;s=r.Cartesian3.equals(u,r.Cartesian3.ZERO)?r.Cartesian3.clone(r.Cartesian3.UNIT_X,N):c.geodeticSurfaceNormal(u,N);var o=r.Cartesian3.cross(r.Cartesian3.UNIT_Z,s,A);r.Cartesian3.normalize(o,o);var l=r.Cartesian3.cross(s,o,G);r.Cartesian3.normalize(l,l),r.Cartesian3.multiplyByScalar(s,d,s),r.Cartesian3.multiplyByScalar(l,d,l),r.Cartesian3.multiplyByScalar(o,d,o);var f=r.Cartesian3.negate(l,U),h=r.Cartesian3.negate(o,W),y=L,p=y[0];r.Cartesian3.add(s,l,p),r.Cartesian3.add(p,o,p),p=y[1],r.Cartesian3.add(s,l,p),r.Cartesian3.add(p,h,p),p=y[2],r.Cartesian3.add(s,f,p),r.Cartesian3.add(p,h,p),p=y[3],r.Cartesian3.add(s,f,p),r.Cartesian3.add(p,o,p),r.Cartesian3.negate(s,s),p=y[4],r.Cartesian3.add(s,l,p),r.Cartesian3.add(p,o,p),p=y[5],r.Cartesian3.add(s,l,p),r.Cartesian3.add(p,h,p),p=y[6],r.Cartesian3.add(s,f,p),r.Cartesian3.add(p,h,p),p=y[7],r.Cartesian3.add(s,f,p),r.Cartesian3.add(p,o,p);for(var v=y.length,m=0;m<v;++m){var x=y[m];r.Cartesian3.add(u,x,x);var g=c.cartesianToCartographic(x,H);n.project(g,x)}i=C.fromPoints(y,i),u=i.center;var z=u.x,b=u.y,w=u.z;return u.x=w,u.y=z,u.z=b,i},C.isOccluded=function(e,a){return t.Check.typeOf.object("sphere",e),t.Check.typeOf.object("occluder",a),!a.isBoundingSphereVisible(e)},C.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&r.Cartesian3.equals(e.center,t.center)&&e.radius===t.radius},C.prototype.intersectPlane=function(e){return C.intersectPlane(this,e)},C.prototype.distanceSquaredTo=function(e){return C.distanceSquaredTo(this,e)},C.prototype.computePlaneDistances=function(e,a,t){return C.computePlaneDistances(this,e,a,t)},C.prototype.isOccluded=function(e){return C.isOccluded(this,e)},C.prototype.equals=function(e){return C.equals(this,e)},C.prototype.clone=function(e){return C.clone(this,e)},C.prototype.volume=function(){var e=this.radius;return O*e*e*e},C.prototype.getCornerAry=function(){var e=[],a=new r.Cartesian3,t=new r.Cartesian3(this.radius,0,0),n=new r.Cartesian3(0,this.radius,0),i=new r.Cartesian3(0,0,this.radius),s=r.Cartesian3.add(t,n,a);return r.Cartesian3.add(s,i,s),r.Cartesian3.add(s,this.center,s),e.push(s.clone()),r.Cartesian3.add(this.center,t,s),r.Cartesian3.add(s,n,s),r.Cartesian3.subtract(s,i,s),e.push(s.clone()),r.Cartesian3.add(this.center,t,s),r.Cartesian3.subtract(s,n,s),r.Cartesian3.add(s,i,s),e.push(s.clone()),r.Cartesian3.add(this.center,t,s),r.Cartesian3.subtract(s,n,s),r.Cartesian3.subtract(s,i,s),e.push(s.clone()),r.Cartesian3.subtract(this.center,t,s),r.Cartesian3.add(s,n,s),r.Cartesian3.add(s,i,s),e.push(s.clone()),r.Cartesian3.subtract(this.center,t,s),r.Cartesian3.add(s,n,s),r.Cartesian3.subtract(s,i,s),e.push(s.clone()),r.Cartesian3.subtract(this.center,t,s),r.Cartesian3.subtract(s,n,s),r.Cartesian3.add(s,i,s),e.push(s.clone()),r.Cartesian3.subtract(this.center,t,s),r.Cartesian3.subtract(s,n,s),r.Cartesian3.subtract(s,i,s),e.push(s.clone()),e},e.BoundingSphere=C,e.GeographicProjection=c,e.Intersect=d,e.Interval=o}));