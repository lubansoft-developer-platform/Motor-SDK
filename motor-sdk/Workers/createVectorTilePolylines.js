define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./Rectangle-c7d55cfa","./WebGLConstants-3660bc8f","./AttributeCompression-1e177d5e","./IndexDatatype-e52361bd","./createTaskProcessorWorker"],(function(a,e,r,n,t,i,s,u,c){"use strict";var o=32767,f=new n.Cartographic,p=new r.Cartesian3;function C(a,e,t,i,u){var c=a.length/3,C=a.subarray(0,c),d=a.subarray(c,2*c),b=a.subarray(2*c,3*c);s.AttributeCompression.zigZagDeltaDecode(C,d,b);for(var l=new Float64Array(a.length),w=0;w<c;++w){var h=C[w],v=d[w],y=b[w],k=r.CesiumMath.lerp(e.west,e.east,h/o),g=r.CesiumMath.lerp(e.south,e.north,v/o),A=r.CesiumMath.lerp(t,i,y/o),m=n.Cartographic.fromRadians(k,g,A,f),x=u.cartographicToCartesian(m,p);r.Cartesian3.pack(x,l,3*w)}return l}var d=new t.Rectangle,b=new n.Ellipsoid,l=new r.Cartesian3,w={min:void 0,max:void 0};function h(a){a=new Float64Array(a);var e=0;w.min=a[e++],w.max=a[e++],t.Rectangle.unpack(a,e,d),e+=t.Rectangle.packedLength,n.Ellipsoid.unpack(a,e,b),e+=n.Ellipsoid.packedLength,r.Cartesian3.unpack(a,e,l)}var v=new r.Cartesian3,y=new r.Cartesian3,k=new r.Cartesian3,g=new r.Cartesian3,A=new r.Cartesian3;function m(a,e){var n=new Uint16Array(a.positions),t=new Uint16Array(a.widths),i=new Uint32Array(a.counts),s=new Uint16Array(a.batchIds);h(a.packedBuffer);var c,o=d,f=b,p=l,m=w.min,x=w.max,E=C(n,o,m,x,f),D=E.length/3,I=4*D-4,R=new Float32Array(3*I),T=new Float32Array(3*I),U=new Float32Array(3*I),F=new Float32Array(2*I),N=new Uint16Array(I),P=0,L=0,M=0,S=0,_=i.length;for(c=0;c<_;++c){for(var G=i[c],W=t[c],B=s[c],z=0;z<G;++z){var H;if(0===z){var O=r.Cartesian3.unpack(E,3*S,v),Y=r.Cartesian3.unpack(E,3*(S+1),y);H=r.Cartesian3.subtract(O,Y,k),r.Cartesian3.add(O,H,H)}else H=r.Cartesian3.unpack(E,3*(S+z-1),k);var Z,j=r.Cartesian3.unpack(E,3*(S+z),g);if(z===G-1){var q=r.Cartesian3.unpack(E,3*(S+G-1),v),J=r.Cartesian3.unpack(E,3*(S+G-2),y);Z=r.Cartesian3.subtract(q,J,A),r.Cartesian3.add(q,Z,Z)}else Z=r.Cartesian3.unpack(E,3*(S+z+1),A);r.Cartesian3.subtract(H,p,H),r.Cartesian3.subtract(j,p,j),r.Cartesian3.subtract(Z,p,Z);for(var K=0===z?2:0,Q=z===G-1?2:4,V=K;V<Q;++V){r.Cartesian3.pack(j,R,P),r.Cartesian3.pack(H,T,P),r.Cartesian3.pack(Z,U,P),P+=3;var X=V-2<0?-1:1;F[L++]=V%2*2-1,F[L++]=X*W,N[M++]=B}}S+=G}var $=u.IndexDatatype.createTypedArray(I,6*D-6),aa=0,ea=0;for(_=D-1,c=0;c<_;++c)$[ea++]=aa,$[ea++]=aa+2,$[ea++]=aa+1,$[ea++]=aa+1,$[ea++]=aa+2,$[ea++]=aa+3,aa+=4;return e.push(R.buffer,T.buffer,U.buffer),e.push(F.buffer,N.buffer,$.buffer),{indexDatatype:2===$.BYTES_PER_ELEMENT?u.IndexDatatype.UNSIGNED_SHORT:u.IndexDatatype.UNSIGNED_INT,currentPositions:R.buffer,previousPositions:T.buffer,nextPositions:U.buffer,expandAndWidth:F.buffer,batchIds:N.buffer,indices:$.buffer}}var x=c(m);return x}));