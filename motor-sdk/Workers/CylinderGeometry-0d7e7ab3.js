define(["exports","./when-45f3d25d","./Check-34538dad","./Cartesian3-ef6ea826","./Cartesian2-a652b463","./BoundingSphere-038d5fbc","./ComponentDatatype-d28c2e26","./GeometryAttribute-dfebcc43","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./IndexDatatype-6d2070e9","./GeometryOffsetAttribute-dae9c424","./VertexFormat-06aa4e32","./CylinderGeometryLibrary-2621d9e9"],(function(t,e,a,r,n,o,i,s,m,u,d,p,f,y){"use strict";var l=new n.Cartesian2,c=new r.Cartesian3,b=new r.Cartesian3,v=new r.Cartesian3,A=new r.Cartesian3;function g(t){var a=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).length,r=t.topRadius,n=t.bottomRadius,o=e.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT),i=e.defaultValue(t.slices,128);this._length=a,this._topRadius=r,this._bottomRadius=n,this._vertexFormat=f.VertexFormat.clone(o),this._slices=i,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}g.packedLength=f.VertexFormat.packedLength+5,g.pack=function(t,a,r){return r=e.defaultValue(r,0),f.VertexFormat.pack(t._vertexFormat,a,r),r+=f.VertexFormat.packedLength,a[r++]=t._length,a[r++]=t._topRadius,a[r++]=t._bottomRadius,a[r++]=t._slices,a[r]=e.defaultValue(t._offsetAttribute,-1),a};var h,x=new f.VertexFormat,_={vertexFormat:x,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};g.unpack=function(t,a,r){a=e.defaultValue(a,0);var n=f.VertexFormat.unpack(t,a,x);a+=f.VertexFormat.packedLength;var o=t[a++],i=t[a++],s=t[a++],m=t[a++],u=t[a];return e.defined(r)?(r._vertexFormat=f.VertexFormat.clone(n,r._vertexFormat),r._length=o,r._topRadius=i,r._bottomRadius=s,r._slices=m,r._offsetAttribute=-1===u?void 0:u,r):(_.length=o,_.topRadius=i,_.bottomRadius=s,_.slices=m,_.offsetAttribute=-1===u?void 0:u,new g(_))},g.createGeometry=function(t){var a=t._length,f=t._topRadius,g=t._bottomRadius,h=t._vertexFormat,x=t._slices;if(!(a<=0||f<0||g<0||0===f&&0===g)){var _,C=x+x,F=x+C,w=C+C,G=y.CylinderGeometryLibrary.computePositions(a,f,g,x,!0),D=h.st?new Float32Array(2*w):void 0,R=h.normal?new Float32Array(3*w):void 0,V=h.tangent?new Float32Array(3*w):void 0,T=h.bitangent?new Float32Array(3*w):void 0,O=h.normal||h.tangent||h.bitangent;if(O){var L=h.tangent||h.bitangent,P=0,k=0,z=0,E=Math.atan2(g-f,a),M=c;M.z=Math.sin(E);var N=Math.cos(E),I=v,S=b;for(_=0;_<x;_++){var U=_/x*r.CesiumMath.TWO_PI,B=N*Math.cos(U),Y=N*Math.sin(U);O&&(M.x=B,M.y=Y,L&&(I=r.Cartesian3.normalize(r.Cartesian3.cross(r.Cartesian3.UNIT_Z,M,I),I)),h.normal&&(R[P++]=M.x,R[P++]=M.y,R[P++]=M.z,R[P++]=M.x,R[P++]=M.y,R[P++]=M.z),h.tangent&&(V[k++]=I.x,V[k++]=I.y,V[k++]=I.z,V[k++]=I.x,V[k++]=I.y,V[k++]=I.z),h.bitangent&&(S=r.Cartesian3.normalize(r.Cartesian3.cross(M,I,S),S),T[z++]=S.x,T[z++]=S.y,T[z++]=S.z,T[z++]=S.x,T[z++]=S.y,T[z++]=S.z))}for(_=0;_<x;_++)h.normal&&(R[P++]=0,R[P++]=0,R[P++]=-1),h.tangent&&(V[k++]=1,V[k++]=0,V[k++]=0),h.bitangent&&(T[z++]=0,T[z++]=-1,T[z++]=0);for(_=0;_<x;_++)h.normal&&(R[P++]=0,R[P++]=0,R[P++]=1),h.tangent&&(V[k++]=1,V[k++]=0,V[k++]=0),h.bitangent&&(T[z++]=0,T[z++]=1,T[z++]=0)}var Z=12*x-12,J=d.IndexDatatype.createTypedArray(w,Z),W=0,j=0;for(_=0;_<x-1;_++)J[W++]=j,J[W++]=j+2,J[W++]=j+3,J[W++]=j,J[W++]=j+3,J[W++]=j+1,j+=2;for(J[W++]=C-2,J[W++]=0,J[W++]=1,J[W++]=C-2,J[W++]=1,J[W++]=C-1,_=1;_<x-1;_++)J[W++]=C+_+1,J[W++]=C+_,J[W++]=C;for(_=1;_<x-1;_++)J[W++]=F,J[W++]=F+_,J[W++]=F+_+1;var q=0;if(h.st){var H=Math.max(f,g);for(_=0;_<w;_++){var K=r.Cartesian3.fromArray(G,3*_,A);D[q++]=(K.x+H)/(2*H),D[q++]=(K.y+H)/(2*H)}}var Q=new u.GeometryAttributes;h.position&&(Q.position=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:G})),h.normal&&(Q.normal=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),h.tangent&&(Q.tangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:V})),h.bitangent&&(Q.bitangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:T})),h.st&&(Q.st=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:D})),l.x=.5*a,l.y=Math.max(g,f);var X=new o.BoundingSphere(r.Cartesian3.ZERO,n.Cartesian2.magnitude(l));if(e.defined(t._offsetAttribute)){a=G.length;var $=new Uint8Array(a/3),tt=t._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1;p.arrayFill($,tt),Q.applyOffset=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:$})}return new s.Geometry({attributes:Q,indices:J,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:X,offsetAttribute:t._offsetAttribute})}},g.getUnitCylinder=function(){return e.defined(h)||(h=g.createGeometry(new g({topRadius:1,bottomRadius:1,length:1,vertexFormat:f.VertexFormat.POSITION_ONLY}))),h},t.CylinderGeometry=g}));