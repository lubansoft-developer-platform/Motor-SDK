define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-eab74dc0","./Cartesian2-174fefc1","./BoundingSphere-37359cf8","./Transforms-6b57162d","./Matrix4-ed224189","./RuntimeError-86da6af2","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-b1ed7c2e","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./IndexDatatype-cb635cbc","./GeometryOffsetAttribute-f755a5cb","./EllipsoidRhumbLine-de5cdc57","./PolygonPipeline-b585c3c1","./RectangleGeometryLibrary-36ffdf9a"],(function(e,t,i,r,a,n,o,l,u,s,d,c,p,f,g,h,y,m){"use strict";var b=new a.BoundingSphere,v=new a.BoundingSphere,_=new i.Cartesian3,E=new r.Rectangle;function A(e,t){var i=e._ellipsoid,r=t.height,a=t.width,n=t.northCap,o=t.southCap,l=r,u=2,g=0,h=4;n&&(u-=1,l-=1,g+=1,h-=2),o&&(u-=1,l-=1,g+=1,h-=2),g+=u*a+2*l-h;var y,b=new Float64Array(3*g),v=0,E=0,A=_;if(n)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,0,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;else for(y=0;y<a;y++)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;for(y=a-1,E=1;E<r;E++)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;if(E=r-1,!o)for(y=a-2;y>=0;y--)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;for(y=0,E=r-2;E>0;E--)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;for(var w=b.length/3*2,G=f.IndexDatatype.createTypedArray(b.length/3,w),R=0,P=0;P<b.length/3-1;P++)G[R++]=P,G[R++]=P+1;G[R++]=b.length/3-1,G[R++]=0;var D=new d.Geometry({attributes:new p.GeometryAttributes,primitiveType:c.PrimitiveType.LINES});return D.attributes.position=new d.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:b}),D.indices=G,D}function w(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,l=A(e,t),u=t.height,s=t.width,d=y.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,a,!1),c=d.length,p=new Float64Array(2*c);p.set(d);var g=y.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,a);p.set(g,c),l.attributes.position.values=p;var h=t.northCap,m=t.southCap,b=4;h&&(b-=1),m&&(b-=1);var v=2*(p.length/3+b),_=f.IndexDatatype.createTypedArray(p.length/3,v);c=p.length/6;for(var E,w=0,G=0;G<c-1;G++)_[w++]=G,_[w++]=G+1,_[w++]=G+c,_[w++]=G+c+1;if(_[w++]=c-1,_[w++]=0,_[w++]=c+c-1,_[w++]=c,_[w++]=0,_[w++]=c,h)E=u-1;else{var R=s-1;_[w++]=R,_[w++]=R+c,E=s+u-2}if(_[w++]=E,_[w++]=E+c,!m){var P=s+E-1;_[w++]=P,_[w]=P+c}return l.indices=_,l}function G(a){a=e.defaultValue(a,e.defaultValue.EMPTY_OBJECT);var n=a.rectangle,o=e.defaultValue(a.granularity,i.CesiumMath.RADIANS_PER_DEGREE),l=e.defaultValue(a.ellipsoid,r.Ellipsoid.WGS84),u=e.defaultValue(a.rotation,0);if(!e.defined(n))throw new t.DeveloperError("rectangle is required.");if(r.Rectangle.validate(n),n.north<n.south)throw new t.DeveloperError("options.rectangle.north must be greater than options.rectangle.south");var s=e.defaultValue(a.height,0),d=e.defaultValue(a.extrudedHeight,s);this._rectangle=r.Rectangle.clone(n),this._granularity=o,this._ellipsoid=l,this._surfaceHeight=Math.max(s,d),this._rotation=u,this._extrudedHeight=Math.min(s,d),this._offsetAttribute=a.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}G.packedLength=r.Rectangle.packedLength+r.Ellipsoid.packedLength+5,G.pack=function(i,a,n){if(!e.defined(i))throw new t.DeveloperError("value is required");if(!e.defined(a))throw new t.DeveloperError("array is required");return n=e.defaultValue(n,0),r.Rectangle.pack(i._rectangle,a,n),n+=r.Rectangle.packedLength,r.Ellipsoid.pack(i._ellipsoid,a,n),n+=r.Ellipsoid.packedLength,a[n++]=i._granularity,a[n++]=i._surfaceHeight,a[n++]=i._rotation,a[n++]=i._extrudedHeight,a[n]=e.defaultValue(i._offsetAttribute,-1),a};var R=new r.Rectangle,P=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),D={rectangle:R,ellipsoid:P,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};G.unpack=function(i,a,n){if(!e.defined(i))throw new t.DeveloperError("array is required");a=e.defaultValue(a,0);var o=r.Rectangle.unpack(i,a,R);a+=r.Rectangle.packedLength;var l=r.Ellipsoid.unpack(i,a,P);a+=r.Ellipsoid.packedLength;var u=i[a++],s=i[a++],d=i[a++],c=i[a++],p=i[a];return e.defined(n)?(n._rectangle=r.Rectangle.clone(o,n._rectangle),n._ellipsoid=r.Ellipsoid.clone(l,n._ellipsoid),n._surfaceHeight=s,n._rotation=d,n._extrudedHeight=c,n._offsetAttribute=-1===p?void 0:p,n):(D.granularity=u,D.height=s,D.rotation=d,D.extrudedHeight=c,D.offsetAttribute=-1===p?void 0:p,new G(D))};var C=new r.Cartographic;function L(t,i){return e.defined(i)&&(t=G.unpack(t,i)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),t._rectangle=r.Rectangle.clone(t._rectangle),G.createGeometry(t)}return G.createGeometry=function(t){var r,n,o=t._rectangle,l=t._ellipsoid,u=m.RectangleGeometryLibrary.computeOptions(o,t._granularity,t._rotation,0,E,C);if(!i.CesiumMath.equalsEpsilon(o.north,o.south,i.CesiumMath.EPSILON10)&&!i.CesiumMath.equalsEpsilon(o.east,o.west,i.CesiumMath.EPSILON10)){var p,f=t._surfaceHeight,h=t._extrudedHeight,_=!i.CesiumMath.equalsEpsilon(f,h,0,i.CesiumMath.EPSILON2);if(_){if(r=w(t,u),e.defined(t._offsetAttribute)){var G=r.attributes.position.values.length/3,R=new Uint8Array(G);t._offsetAttribute===g.GeometryOffsetAttribute.TOP?R=g.arrayFill(R,1,0,G/2):(p=t._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,R=g.arrayFill(R,p)),r.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:R})}var P=a.BoundingSphere.fromRectangle3D(o,l,f,v),D=a.BoundingSphere.fromRectangle3D(o,l,h,b);n=a.BoundingSphere.union(P,D)}else{if(r=A(t,u),r.attributes.position.values=y.PolygonPipeline.scaleToGeodeticHeight(r.attributes.position.values,f,l,!1),e.defined(t._offsetAttribute)){var L=r.attributes.position.values.length,x=new Uint8Array(L/3);p=t._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,g.arrayFill(x,p),r.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:x})}n=a.BoundingSphere.fromRectangle3D(o,l,f)}return new d.Geometry({attributes:r.attributes,indices:r.indices,primitiveType:c.PrimitiveType.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},L}));