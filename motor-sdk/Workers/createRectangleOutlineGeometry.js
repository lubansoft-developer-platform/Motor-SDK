define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-ef6ea826","./Cartesian2-a652b463","./BoundingSphere-038d5fbc","./Transforms-c8a82813","./Matrix4-f54b529f","./RuntimeError-86da6af2","./WebGLConstants-3660bc8f","./ComponentDatatype-d28c2e26","./GeometryAttribute-dfebcc43","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./IndexDatatype-6d2070e9","./GeometryOffsetAttribute-dae9c424","./EllipsoidRhumbLine-0c6cd7c8","./PolygonPipeline-28c8c9d7","./RectangleGeometryLibrary-1119b3bc"],(function(e,t,i,a,r,n,o,l,u,s,c,d,p,f,g,h,y,m){"use strict";var b=new r.BoundingSphere,_=new r.BoundingSphere,v=new i.Cartesian3,E=new a.Rectangle;function A(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=t.southCap,l=a,u=2,g=0,h=4;n&&(u-=1,l-=1,g+=1,h-=2),o&&(u-=1,l-=1,g+=1,h-=2),g+=u*r+2*l-h;var y,b=new Float64Array(3*g),_=0,E=0,A=v;if(n)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,0,A),b[_++]=A.x,b[_++]=A.y,b[_++]=A.z;else for(y=0;y<r;y++)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[_++]=A.x,b[_++]=A.y,b[_++]=A.z;for(y=r-1,E=1;E<a;E++)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[_++]=A.x,b[_++]=A.y,b[_++]=A.z;if(E=a-1,!o)for(y=r-2;y>=0;y--)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[_++]=A.x,b[_++]=A.y,b[_++]=A.z;for(y=0,E=a-2;E>0;E--)m.RectangleGeometryLibrary.computePosition(t,i,!1,E,y,A),b[_++]=A.x,b[_++]=A.y,b[_++]=A.z;for(var G=b.length/3*2,R=f.IndexDatatype.createTypedArray(b.length/3,G),P=0,w=0;w<b.length/3-1;w++)R[P++]=w,R[P++]=w+1;R[P++]=b.length/3-1,R[P++]=0;var C=new c.Geometry({attributes:new p.GeometryAttributes,primitiveType:d.PrimitiveType.LINES});return C.attributes.position=new c.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:b}),C.indices=R,C}function G(t){var r=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).rectangle,n=e.defaultValue(t.granularity,i.CesiumMath.RADIANS_PER_DEGREE),o=e.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84),l=e.defaultValue(t.rotation,0),u=e.defaultValue(t.height,0),s=e.defaultValue(t.extrudedHeight,u);this._rectangle=a.Rectangle.clone(r),this._granularity=n,this._ellipsoid=o,this._surfaceHeight=Math.max(u,s),this._rotation=l,this._extrudedHeight=Math.min(u,s),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}G.packedLength=a.Rectangle.packedLength+a.Ellipsoid.packedLength+5,G.pack=function(t,i,r){return r=e.defaultValue(r,0),a.Rectangle.pack(t._rectangle,i,r),r+=a.Rectangle.packedLength,a.Ellipsoid.pack(t._ellipsoid,i,r),r+=a.Ellipsoid.packedLength,i[r++]=t._granularity,i[r++]=t._surfaceHeight,i[r++]=t._rotation,i[r++]=t._extrudedHeight,i[r]=e.defaultValue(t._offsetAttribute,-1),i};var R=new a.Rectangle,P=a.Ellipsoid.clone(a.Ellipsoid.UNIT_SPHERE),w={rectangle:R,ellipsoid:P,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};G.unpack=function(t,i,r){i=e.defaultValue(i,0);var n=a.Rectangle.unpack(t,i,R);i+=a.Rectangle.packedLength;var o=a.Ellipsoid.unpack(t,i,P);i+=a.Ellipsoid.packedLength;var l=t[i++],u=t[i++],s=t[i++],c=t[i++],d=t[i];return e.defined(r)?(r._rectangle=a.Rectangle.clone(n,r._rectangle),r._ellipsoid=a.Ellipsoid.clone(o,r._ellipsoid),r._surfaceHeight=u,r._rotation=s,r._extrudedHeight=c,r._offsetAttribute=-1===d?void 0:d,r):(w.granularity=l,w.height=u,w.rotation=s,w.extrudedHeight=c,w.offsetAttribute=-1===d?void 0:d,new G(w))};var C=new a.Cartographic;return G.createGeometry=function(t){var a,n,o=t._rectangle,l=t._ellipsoid,u=m.RectangleGeometryLibrary.computeOptions(o,t._granularity,t._rotation,0,E,C);if(!i.CesiumMath.equalsEpsilon(o.north,o.south,i.CesiumMath.EPSILON10)&&!i.CesiumMath.equalsEpsilon(o.east,o.west,i.CesiumMath.EPSILON10)){var p,h=t._surfaceHeight,v=t._extrudedHeight;if(i.CesiumMath.equalsEpsilon(h,v,0,i.CesiumMath.EPSILON2)){if((a=A(t,u)).attributes.position.values=y.PolygonPipeline.scaleToGeodeticHeight(a.attributes.position.values,h,l,!1),e.defined(t._offsetAttribute)){var G=a.attributes.position.values.length,R=new Uint8Array(G/3);p=t._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,g.arrayFill(R,p),a.attributes.applyOffset=new c.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:R})}n=r.BoundingSphere.fromRectangle3D(o,l,h)}else{if(a=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,l=A(e,t),u=t.height,s=t.width,c=y.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,r,!1),d=c.length,p=new Float64Array(2*d);p.set(c);var g=y.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,r);p.set(g,d),l.attributes.position.values=p;var h=t.northCap,m=t.southCap,b=4;h&&(b-=1),m&&(b-=1);var _=2*(p.length/3+b),v=f.IndexDatatype.createTypedArray(p.length/3,_);d=p.length/6;for(var E,G=0,R=0;R<d-1;R++)v[G++]=R,v[G++]=R+1,v[G++]=R+d,v[G++]=R+d+1;if(v[G++]=d-1,v[G++]=0,v[G++]=d+d-1,v[G++]=d,v[G++]=0,v[G++]=d,h)E=u-1;else{var P=s-1;v[G++]=P,v[G++]=P+d,E=s+u-2}if(v[G++]=E,v[G++]=E+d,!m){var w=s+E-1;v[G++]=w,v[G]=w+d}return l.indices=v,l}(t,u),e.defined(t._offsetAttribute)){var P=a.attributes.position.values.length/3,w=new Uint8Array(P);t._offsetAttribute===g.GeometryOffsetAttribute.TOP?w=g.arrayFill(w,1,0,P/2):(p=t._offsetAttribute===g.GeometryOffsetAttribute.NONE?0:1,w=g.arrayFill(w,p)),a.attributes.applyOffset=new c.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var L=r.BoundingSphere.fromRectangle3D(o,l,h,_),x=r.BoundingSphere.fromRectangle3D(o,l,v,b);n=r.BoundingSphere.union(L,x)}return new c.Geometry({attributes:a.attributes,indices:a.indices,primitiveType:d.PrimitiveType.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},function(t,i){return e.defined(i)&&(t=G.unpack(t,i)),t._ellipsoid=a.Ellipsoid.clone(t._ellipsoid),t._rectangle=a.Rectangle.clone(t._rectangle),G.createGeometry(t)}}));