define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./BoundingSphere-bacc5cb6","./Matrix4-c65e6a1b","./RuntimeError-86da6af2","./Rectangle-c7d55cfa","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-70b679fd","./PrimitiveType-30fa6f85","./Transforms-7d49a8ab","./GeometryAttributes-9d45f9e2","./IndexDatatype-e52361bd","./GeometryOffsetAttribute-f755a5cb","./EllipsoidRhumbLine-4bc7760a","./PolygonPipeline-d22f3330","./RectangleGeometryLibrary-2696ecaf"],(function(e,t,i,r,a,n,o,l,u,s,d,p,c,f,g,h,y,b,m){"use strict";var v=new a.BoundingSphere,_=new a.BoundingSphere,E=new i.Cartesian3,A=new l.Rectangle;function w(e,t){var i=e._ellipsoid,r=t.height,a=t.width,n=t.northCap,o=t.southCap,l=r,u=2,c=0,h=4;n&&(u-=1,l-=1,c+=1,h-=2),o&&(u-=1,l-=1,c+=1,h-=2),c+=u*a+2*l-h;var y,b=new Float64Array(3*c),v=0,_=0,A=E;if(n)m.RectangleGeometryLibrary.computePosition(t,i,!1,_,0,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;else for(y=0;y<a;y++)m.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;for(y=a-1,_=1;_<r;_++)m.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;if(_=r-1,!o)for(y=a-2;y>=0;y--)m.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;for(y=0,_=r-2;_>0;_--)m.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,A),b[v++]=A.x,b[v++]=A.y,b[v++]=A.z;for(var w=b.length/3*2,G=g.IndexDatatype.createTypedArray(b.length/3,w),R=0,P=0;P<b.length/3-1;P++)G[R++]=P,G[R++]=P+1;G[R++]=b.length/3-1,G[R++]=0;var D=new d.Geometry({attributes:new f.GeometryAttributes,primitiveType:p.PrimitiveType.LINES});return D.attributes.position=new d.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:b}),D.indices=G,D}function G(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,l=w(e,t),u=t.height,s=t.width,d=b.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,a,!1),p=d.length,c=new Float64Array(2*p);c.set(d);var f=b.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,a);c.set(f,p),l.attributes.position.values=c;var h=t.northCap,y=t.southCap,m=4;h&&(m-=1),y&&(m-=1);var v=2*(c.length/3+m),_=g.IndexDatatype.createTypedArray(c.length/3,v);p=c.length/6;for(var E,A=0,G=0;G<p-1;G++)_[A++]=G,_[A++]=G+1,_[A++]=G+p,_[A++]=G+p+1;if(_[A++]=p-1,_[A++]=0,_[A++]=p+p-1,_[A++]=p,_[A++]=0,_[A++]=p,h)E=u-1;else{var R=s-1;_[A++]=R,_[A++]=R+p,E=s+u-2}if(_[A++]=E,_[A++]=E+p,!y){var P=s+E-1;_[A++]=P,_[A]=P+p}return l.indices=_,l}function R(a){a=e.defaultValue(a,e.defaultValue.EMPTY_OBJECT);var n=a.rectangle,o=e.defaultValue(a.granularity,i.CesiumMath.RADIANS_PER_DEGREE),u=e.defaultValue(a.ellipsoid,r.Ellipsoid.WGS84),s=e.defaultValue(a.rotation,0);if(!e.defined(n))throw new t.DeveloperError("rectangle is required.");if(l.Rectangle.validate(n),n.north<n.south)throw new t.DeveloperError("options.rectangle.north must be greater than options.rectangle.south");var d=e.defaultValue(a.height,0),p=e.defaultValue(a.extrudedHeight,d);this._rectangle=l.Rectangle.clone(n),this._granularity=o,this._ellipsoid=u,this._surfaceHeight=Math.max(d,p),this._rotation=s,this._extrudedHeight=Math.min(d,p),this._offsetAttribute=a.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}R.packedLength=l.Rectangle.packedLength+r.Ellipsoid.packedLength+5,R.pack=function(i,a,n){if(!e.defined(i))throw new t.DeveloperError("value is required");if(!e.defined(a))throw new t.DeveloperError("array is required");return n=e.defaultValue(n,0),l.Rectangle.pack(i._rectangle,a,n),n+=l.Rectangle.packedLength,r.Ellipsoid.pack(i._ellipsoid,a,n),n+=r.Ellipsoid.packedLength,a[n++]=i._granularity,a[n++]=i._surfaceHeight,a[n++]=i._rotation,a[n++]=i._extrudedHeight,a[n]=e.defaultValue(i._offsetAttribute,-1),a};var P=new l.Rectangle,D=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),C={rectangle:P,ellipsoid:D,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};R.unpack=function(i,a,n){if(!e.defined(i))throw new t.DeveloperError("array is required");a=e.defaultValue(a,0);var o=l.Rectangle.unpack(i,a,P);a+=l.Rectangle.packedLength;var u=r.Ellipsoid.unpack(i,a,D);a+=r.Ellipsoid.packedLength;var s=i[a++],d=i[a++],p=i[a++],c=i[a++],f=i[a];return e.defined(n)?(n._rectangle=l.Rectangle.clone(o,n._rectangle),n._ellipsoid=r.Ellipsoid.clone(u,n._ellipsoid),n._surfaceHeight=d,n._rotation=p,n._extrudedHeight=c,n._offsetAttribute=-1===f?void 0:f,n):(C.granularity=s,C.height=d,C.rotation=p,C.extrudedHeight=c,C.offsetAttribute=-1===f?void 0:f,new R(C))};var L=new r.Cartographic;function x(t,i){return e.defined(i)&&(t=R.unpack(t,i)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),t._rectangle=l.Rectangle.clone(t._rectangle),R.createGeometry(t)}return R.createGeometry=function(t){var r,n,o=t._rectangle,l=t._ellipsoid,u=m.RectangleGeometryLibrary.computeOptions(o,t._granularity,t._rotation,0,A,L);if(!i.CesiumMath.equalsEpsilon(o.north,o.south,i.CesiumMath.EPSILON10)&&!i.CesiumMath.equalsEpsilon(o.east,o.west,i.CesiumMath.EPSILON10)){var c,f=t._surfaceHeight,g=t._extrudedHeight,y=!i.CesiumMath.equalsEpsilon(f,g,0,i.CesiumMath.EPSILON2);if(y){if(r=G(t,u),e.defined(t._offsetAttribute)){var E=r.attributes.position.values.length/3,R=new Uint8Array(E);t._offsetAttribute===h.GeometryOffsetAttribute.TOP?R=h.arrayFill(R,1,0,E/2):(c=t._offsetAttribute===h.GeometryOffsetAttribute.NONE?0:1,R=h.arrayFill(R,c)),r.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:R})}var P=a.BoundingSphere.fromRectangle3D(o,l,f,_),D=a.BoundingSphere.fromRectangle3D(o,l,g,v);n=a.BoundingSphere.union(P,D)}else{if(r=w(t,u),r.attributes.position.values=b.PolygonPipeline.scaleToGeodeticHeight(r.attributes.position.values,f,l,!1),e.defined(t._offsetAttribute)){var C=r.attributes.position.values.length,x=new Uint8Array(C/3);c=t._offsetAttribute===h.GeometryOffsetAttribute.NONE?0:1,h.arrayFill(x,c),r.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:x})}n=a.BoundingSphere.fromRectangle3D(o,l,f)}return new d.Geometry({attributes:r.attributes,indices:r.indices,primitiveType:p.PrimitiveType.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},x}));