define(["exports","./when-45f3d25d","./Check-34538dad","./Cartesian3-ef6ea826","./Cartesian2-a652b463","./BoundingSphere-038d5fbc","./ComponentDatatype-d28c2e26","./GeometryAttribute-dfebcc43","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./IndexDatatype-6d2070e9","./GeometryOffsetAttribute-dae9c424","./VertexFormat-06aa4e32"],(function(t,e,a,i,r,n,o,m,s,u,l,f,c){"use strict";var d=new i.Cartesian3,C=new i.Cartesian3,p=new i.Cartesian3,y=new i.Cartesian3,_=new i.Cartesian3,v=new i.Cartesian3(1,1,1),h=Math.cos,A=Math.sin;function x(t){t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT);var a=e.defaultValue(t.radii,v),r=e.defaultValue(t.innerRadii,a),n=e.defaultValue(t.minimumClock,0),o=e.defaultValue(t.maximumClock,i.CesiumMath.TWO_PI),m=e.defaultValue(t.minimumCone,0),s=e.defaultValue(t.maximumCone,i.CesiumMath.PI),u=Math.round(e.defaultValue(t.stackPartitions,64)),l=Math.round(e.defaultValue(t.slicePartitions,64)),f=e.defaultValue(t.vertexFormat,c.VertexFormat.DEFAULT);this._radii=i.Cartesian3.clone(a),this._innerRadii=i.Cartesian3.clone(r),this._minimumClock=n,this._maximumClock=o,this._minimumCone=m,this._maximumCone=s,this._stackPartitions=u,this._slicePartitions=l,this._vertexFormat=c.VertexFormat.clone(f),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidGeometry"}x.packedLength=2*i.Cartesian3.packedLength+c.VertexFormat.packedLength+7,x.pack=function(t,a,r){return r=e.defaultValue(r,0),i.Cartesian3.pack(t._radii,a,r),r+=i.Cartesian3.packedLength,i.Cartesian3.pack(t._innerRadii,a,r),r+=i.Cartesian3.packedLength,c.VertexFormat.pack(t._vertexFormat,a,r),r+=c.VertexFormat.packedLength,a[r++]=t._minimumClock,a[r++]=t._maximumClock,a[r++]=t._minimumCone,a[r++]=t._maximumCone,a[r++]=t._stackPartitions,a[r++]=t._slicePartitions,a[r]=e.defaultValue(t._offsetAttribute,-1),a};var b,k=new i.Cartesian3,w=new i.Cartesian3,F=new c.VertexFormat,P={radii:k,innerRadii:w,vertexFormat:F,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};x.unpack=function(t,a,r){a=e.defaultValue(a,0);var n=i.Cartesian3.unpack(t,a,k);a+=i.Cartesian3.packedLength;var o=i.Cartesian3.unpack(t,a,w);a+=i.Cartesian3.packedLength;var m=c.VertexFormat.unpack(t,a,F);a+=c.VertexFormat.packedLength;var s=t[a++],u=t[a++],l=t[a++],f=t[a++],d=t[a++],C=t[a++],p=t[a];return e.defined(r)?(r._radii=i.Cartesian3.clone(n,r._radii),r._innerRadii=i.Cartesian3.clone(o,r._innerRadii),r._vertexFormat=c.VertexFormat.clone(m,r._vertexFormat),r._minimumClock=s,r._maximumClock=u,r._minimumCone=l,r._maximumCone=f,r._stackPartitions=d,r._slicePartitions=C,r._offsetAttribute=-1===p?void 0:p,r):(P.minimumClock=s,P.maximumClock=u,P.minimumCone=l,P.maximumCone=f,P.stackPartitions=d,P.slicePartitions=C,P.offsetAttribute=-1===p?void 0:p,new x(P))},x.createGeometry=function(t){var a=t._radii;if(!(a.x<=0||a.y<=0||a.z<=0)){var c=t._innerRadii;if(!(c.x<=0||c.y<=0||c.z<=0)){var v,x,b=t._minimumClock,k=t._maximumClock,w=t._minimumCone,F=t._maximumCone,P=t._vertexFormat,g=t._slicePartitions+1,V=t._stackPartitions+1;(g=Math.round(g*Math.abs(k-b)/i.CesiumMath.TWO_PI))<2&&(g=2),(V=Math.round(V*Math.abs(F-w)/i.CesiumMath.PI))<2&&(V=2);var T=0,M=[w],D=[b];for(v=0;v<V;v++)M.push(w+v*(F-w)/(V-1));for(M.push(F),x=0;x<g;x++)D.push(b+x*(k-b)/(g-1));D.push(k);var G=M.length,L=D.length,O=0,I=1,E=c.x!==a.x||c.y!==a.y||c.z!==a.z,z=!1,N=!1,R=!1;E&&(I=2,w>0&&(z=!0,O+=g-1),F<Math.PI&&(N=!0,O+=g-1),(k-b)%i.CesiumMath.TWO_PI?(R=!0,O+=2*(V-1)+1):O+=1);var S=L*G*I,U=new Float64Array(3*S),B=f.arrayFill(new Array(S),!1),W=f.arrayFill(new Array(S),!1),Y=g*V*I,J=6*(Y+O+1-(g+V)*I),X=l.IndexDatatype.createTypedArray(Y,J),Z=P.normal?new Float32Array(3*S):void 0,j=P.tangent?new Float32Array(3*S):void 0,q=P.bitangent?new Float32Array(3*S):void 0,H=P.st?new Float32Array(2*S):void 0,K=new Array(G),Q=new Array(G);for(v=0;v<G;v++)K[v]=A(M[v]),Q[v]=h(M[v]);var $=new Array(L),tt=new Array(L);for(x=0;x<L;x++)tt[x]=h(D[x]),$[x]=A(D[x]);for(v=0;v<G;v++)for(x=0;x<L;x++)U[T++]=a.x*K[v]*tt[x],U[T++]=a.y*K[v]*$[x],U[T++]=a.z*Q[v];var et,at,it,rt,nt=S/2;if(E)for(v=0;v<G;v++)for(x=0;x<L;x++)U[T++]=c.x*K[v]*tt[x],U[T++]=c.y*K[v]*$[x],U[T++]=c.z*Q[v],B[nt]=!0,v>0&&v!==G-1&&0!==x&&x!==L-1&&(W[nt]=!0),nt++;for(T=0,v=1;v<G-2;v++)for(et=v*L,at=(v+1)*L,x=1;x<L-2;x++)X[T++]=at+x,X[T++]=at+x+1,X[T++]=et+x+1,X[T++]=at+x,X[T++]=et+x+1,X[T++]=et+x;if(E){var ot=G*L;for(v=1;v<G-2;v++)for(et=ot+v*L,at=ot+(v+1)*L,x=1;x<L-2;x++)X[T++]=at+x,X[T++]=et+x,X[T++]=et+x+1,X[T++]=at+x,X[T++]=et+x+1,X[T++]=at+x+1}if(E){if(z)for(rt=G*L,v=1;v<L-2;v++)X[T++]=v,X[T++]=v+1,X[T++]=rt+v+1,X[T++]=v,X[T++]=rt+v+1,X[T++]=rt+v;if(N)for(it=G*L-L,rt=G*L*I-L,v=1;v<L-2;v++)X[T++]=it+v+1,X[T++]=it+v,X[T++]=rt+v,X[T++]=it+v+1,X[T++]=rt+v,X[T++]=rt+v+1}if(R){for(v=1;v<G-2;v++)rt=L*G+L*v,it=L*v,X[T++]=rt,X[T++]=it+L,X[T++]=it,X[T++]=rt,X[T++]=rt+L,X[T++]=it+L;for(v=1;v<G-2;v++)rt=L*G+L*(v+1)-1,it=L*(v+1)-1,X[T++]=it+L,X[T++]=rt,X[T++]=it,X[T++]=it+L,X[T++]=rt+L,X[T++]=rt}var mt=new u.GeometryAttributes;P.position&&(mt.position=new m.GeometryAttribute({componentDatatype:o.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:U}));var st,ut=0,lt=0,ft=0,ct=0,dt=S/2,Ct=r.Ellipsoid.fromCartesian3(a),pt=r.Ellipsoid.fromCartesian3(c);if(P.st||P.normal||P.tangent||P.bitangent){for(v=0;v<S;v++){st=B[v]?pt:Ct;var yt=i.Cartesian3.fromArray(U,3*v,d),_t=st.geodeticSurfaceNormal(yt,C);if(W[v]&&i.Cartesian3.negate(_t,_t),P.st){var vt=r.Cartesian2.negate(_t,_);H[ut++]=Math.atan2(vt.y,vt.x)/i.CesiumMath.TWO_PI+.5,H[ut++]=Math.asin(_t.z)/Math.PI+.5}if(P.normal&&(Z[lt++]=_t.x,Z[lt++]=_t.y,Z[lt++]=_t.z),P.tangent||P.bitangent){var ht,At=p,xt=0;if(B[v]&&(xt=dt),ht=!z&&v>=xt&&v<xt+2*L?i.Cartesian3.UNIT_X:i.Cartesian3.UNIT_Z,i.Cartesian3.cross(ht,_t,At),i.Cartesian3.normalize(At,At),P.tangent&&(j[ft++]=At.x,j[ft++]=At.y,j[ft++]=At.z),P.bitangent){var bt=i.Cartesian3.cross(_t,At,y);i.Cartesian3.normalize(bt,bt),q[ct++]=bt.x,q[ct++]=bt.y,q[ct++]=bt.z}}}P.st&&(mt.st=new m.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:H})),P.normal&&(mt.normal=new m.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:Z})),P.tangent&&(mt.tangent=new m.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:j})),P.bitangent&&(mt.bitangent=new m.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:q}))}if(e.defined(t._offsetAttribute)){var kt=U.length,wt=new Uint8Array(kt/3),Ft=t._offsetAttribute===f.GeometryOffsetAttribute.NONE?0:1;f.arrayFill(wt,Ft),mt.applyOffset=new m.GeometryAttribute({componentDatatype:o.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:wt})}return new m.Geometry({attributes:mt,indices:X,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:n.BoundingSphere.fromEllipsoid(Ct),offsetAttribute:t._offsetAttribute})}}},x.getUnitEllipsoid=function(){return e.defined(b)||(b=x.createGeometry(new x({radii:new i.Cartesian3(1,1,1),vertexFormat:c.VertexFormat.POSITION_ONLY}))),b},t.EllipsoidGeometry=x}));