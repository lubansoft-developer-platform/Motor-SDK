define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9","./Cartesian2-7a44370a","./BoundingSphere-bacc5cb6","./Matrix4-c65e6a1b","./RuntimeError-86da6af2","./Rectangle-c7d55cfa","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-70b679fd","./PrimitiveType-30fa6f85","./Transforms-7d49a8ab","./GeometryAttributes-9d45f9e2","./AttributeCompression-1e177d5e","./GeometryPipeline-57d51dc8","./EncodedCartesian3-7b803d4a","./IndexDatatype-e52361bd","./IntersectionTests-8855da40","./Plane-1875afb4","./GeometryOffsetAttribute-f755a5cb","./GeometryInstance-734856d8","./arrayRemoveDuplicates-24a803e7","./EllipsoidTangentPlane-3e14dd4d","./ArcType-39be7a32","./EllipsoidRhumbLine-4bc7760a","./PolygonPipeline-d22f3330","./PolygonGeometryLibrary-c7aa9cd4"],(function(e,t,i,r,o,n,a,y,s,l,p,d,u,c,f,g,h,m,b,P,v,E,A,G,_,T,H,L){"use strict";var C=[],O=[];function D(e,t,i,r,o){var n,a,y=G.EllipsoidTangentPlane.fromPoints(t,e),s=y.projectPointsOntoPlane(t,C),u=H.PolygonPipeline.computeWindingOrder2D(s);u===H.WindingOrder.CLOCKWISE&&(s.reverse(),t=t.slice().reverse());var f=t.length,g=0;if(r)for(n=new Float64Array(2*f*3),a=0;a<f;a++){var h=t[a],b=t[(a+1)%f];n[g++]=h.x,n[g++]=h.y,n[g++]=h.z,n[g++]=b.x,n[g++]=b.y,n[g++]=b.z}else{var P=0;if(o===_.ArcType.GEODESIC)for(a=0;a<f;a++)P+=L.PolygonGeometryLibrary.subdivideLineCount(t[a],t[(a+1)%f],i);else if(o===_.ArcType.RHUMB)for(a=0;a<f;a++)P+=L.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[a],t[(a+1)%f],i);for(n=new Float64Array(3*P),a=0;a<f;a++){var v;o===_.ArcType.GEODESIC?v=L.PolygonGeometryLibrary.subdivideLine(t[a],t[(a+1)%f],i,O):o===_.ArcType.RHUMB&&(v=L.PolygonGeometryLibrary.subdivideRhumbLine(e,t[a],t[(a+1)%f],i,O));for(var A=v.length,T=0;T<A;++T)n[g++]=v[T]}}f=n.length/3;var D=2*f,I=m.IndexDatatype.createTypedArray(f,D);for(g=0,a=0;a<f-1;a++)I[g++]=a,I[g++]=a+1;return I[g++]=f-1,I[g++]=0,new E.GeometryInstance({geometry:new p.Geometry({attributes:new c.GeometryAttributes({position:new p.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:I,primitiveType:d.PrimitiveType.LINES})})}function I(e,t,i,r,o){var n,a,y=G.EllipsoidTangentPlane.fromPoints(t,e),s=y.projectPointsOntoPlane(t,C),u=H.PolygonPipeline.computeWindingOrder2D(s);u===H.WindingOrder.CLOCKWISE&&(s.reverse(),t=t.slice().reverse());var f=t.length,g=new Array(f),h=0;if(r)for(n=new Float64Array(2*f*3*2),a=0;a<f;++a){g[a]=h/3;var b=t[a],P=t[(a+1)%f];n[h++]=b.x,n[h++]=b.y,n[h++]=b.z,n[h++]=P.x,n[h++]=P.y,n[h++]=P.z}else{var v=0;if(o===_.ArcType.GEODESIC)for(a=0;a<f;a++)v+=L.PolygonGeometryLibrary.subdivideLineCount(t[a],t[(a+1)%f],i);else if(o===_.ArcType.RHUMB)for(a=0;a<f;a++)v+=L.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[a],t[(a+1)%f],i);for(n=new Float64Array(3*v*2),a=0;a<f;++a){var A;g[a]=h/3,o===_.ArcType.GEODESIC?A=L.PolygonGeometryLibrary.subdivideLine(t[a],t[(a+1)%f],i,O):o===_.ArcType.RHUMB&&(A=L.PolygonGeometryLibrary.subdivideRhumbLine(e,t[a],t[(a+1)%f],i,O));for(var T=A.length,D=0;D<T;++D)n[h++]=A[D]}}f=n.length/6;var I=g.length,w=2*(2*f+I),x=m.IndexDatatype.createTypedArray(f+I,w);for(h=0,a=0;a<f;++a)x[h++]=a,x[h++]=(a+1)%f,x[h++]=a+f,x[h++]=(a+1)%f+f;for(a=0;a<I;a++){var k=g[a];x[h++]=k,x[h++]=k+f}return new E.GeometryInstance({geometry:new p.Geometry({attributes:new c.GeometryAttributes({position:new p.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:x,primitiveType:d.PrimitiveType.LINES})})}function w(o){if(t.Check.typeOf.object("options",o),t.Check.typeOf.object("options.polygonHierarchy",o.polygonHierarchy),o.perPositionHeight&&e.defined(o.height))throw new t.DeveloperError("Cannot use both options.perPositionHeight and options.height");if(e.defined(o.arcType)&&o.arcType!==_.ArcType.GEODESIC&&o.arcType!==_.ArcType.RHUMB)throw new t.DeveloperError("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var n=o.polygonHierarchy,a=e.defaultValue(o.ellipsoid,r.Ellipsoid.WGS84),y=e.defaultValue(o.granularity,i.CesiumMath.RADIANS_PER_DEGREE),s=e.defaultValue(o.perPositionHeight,!1),l=s&&e.defined(o.extrudedHeight),p=e.defaultValue(o.arcType,_.ArcType.GEODESIC),d=e.defaultValue(o.height,0),u=e.defaultValue(o.extrudedHeight,d);if(!l){var c=Math.max(d,u);u=Math.min(d,u),d=c}this._ellipsoid=r.Ellipsoid.clone(a),this._granularity=y,this._height=d,this._extrudedHeight=u,this._arcType=p,this._polygonHierarchy=n,this._perPositionHeight=s,this._perPositionHeightExtrude=l,this._offsetAttribute=o.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=L.PolygonGeometryLibrary.computeHierarchyPackedLength(n)+r.Ellipsoid.packedLength+8}w.pack=function(i,o,n){return t.Check.typeOf.object("value",i),t.Check.defined("array",o),n=e.defaultValue(n,0),n=L.PolygonGeometryLibrary.packPolygonHierarchy(i._polygonHierarchy,o,n),r.Ellipsoid.pack(i._ellipsoid,o,n),n+=r.Ellipsoid.packedLength,o[n++]=i._height,o[n++]=i._extrudedHeight,o[n++]=i._granularity,o[n++]=i._perPositionHeightExtrude?1:0,o[n++]=i._perPositionHeight?1:0,o[n++]=i._arcType,o[n++]=e.defaultValue(i._offsetAttribute,-1),o[n]=i.packedLength,o};var x=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),k={polygonHierarchy:{}};function S(t,i){return e.defined(i)&&(t=w.unpack(t,i)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),w.createGeometry(t)}return w.unpack=function(i,o,n){t.Check.defined("array",i),o=e.defaultValue(o,0);var a=L.PolygonGeometryLibrary.unpackPolygonHierarchy(i,o);o=a.startingIndex,delete a.startingIndex;var y=r.Ellipsoid.unpack(i,o,x);o+=r.Ellipsoid.packedLength;var s=i[o++],l=i[o++],p=i[o++],d=1===i[o++],u=1===i[o++],c=i[o++],f=i[o++],g=i[o];return e.defined(n)||(n=new w(k)),n._polygonHierarchy=a,n._ellipsoid=r.Ellipsoid.clone(y,n._ellipsoid),n._height=s,n._extrudedHeight=l,n._granularity=p,n._perPositionHeight=u,n._perPositionHeightExtrude=d,n._arcType=c,n._offsetAttribute=-1===f?void 0:f,n.packedLength=g,n},w.fromPositions=function(i){i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT),t.Check.defined("options.positions",i.positions);var r={polygonHierarchy:{positions:i.positions},height:i.height,extrudedHeight:i.extrudedHeight,ellipsoid:i.ellipsoid,granularity:i.granularity,perPositionHeight:i.perPositionHeight,arcType:i.arcType,offsetAttribute:i.offsetAttribute};return new w(r)},w.createGeometry=function(t){var r=t._ellipsoid,n=t._granularity,a=t._polygonHierarchy,y=t._perPositionHeight,s=t._arcType,d=L.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(a,!y,r);if(0!==d.length){var u,c,f,h=[],m=i.CesiumMath.chordLength(n,r.maximumRadius),b=t._height,P=t._extrudedHeight,E=t._perPositionHeightExtrude||!i.CesiumMath.equalsEpsilon(b,P,0,i.CesiumMath.EPSILON2);if(E)for(f=0;f<d.length;f++){if(u=I(r,d[f],m,y,s),u.geometry=L.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(u.geometry,b,P,r,y),e.defined(t._offsetAttribute)){var A=u.geometry.attributes.position.values.length/3,G=new Uint8Array(A);t._offsetAttribute===v.GeometryOffsetAttribute.TOP?G=v.arrayFill(G,1,0,A/2):(c=t._offsetAttribute===v.GeometryOffsetAttribute.NONE?0:1,G=v.arrayFill(G,c)),u.geometry.attributes.applyOffset=new p.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:G})}h.push(u)}else for(f=0;f<d.length;f++){if(u=D(r,d[f],m,y,s),u.geometry.attributes.position.values=H.PolygonPipeline.scaleToGeodeticHeight(u.geometry.attributes.position.values,b,r,!y),e.defined(t._offsetAttribute)){var _=u.geometry.attributes.position.values.length,T=new Uint8Array(_/3);c=t._offsetAttribute===v.GeometryOffsetAttribute.NONE?0:1,v.arrayFill(T,c),u.geometry.attributes.applyOffset=new p.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:T})}h.push(u)}var C=g.GeometryPipeline.combineInstances(h)[0],O=o.BoundingSphere.fromVertices(C.attributes.position.values);return new p.Geometry({attributes:C.attributes,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:O,offsetAttribute:t._offsetAttribute})}},S}));