define(["exports","./when-45f3d25d","./Check-34538dad","./Cartesian3-e69091b9"],(function(e,t,r,i){"use strict";var n=new i.Cartesian3,a=new i.Cartesian3;function o(e,o,u,c,d){if(!t.defined(e))throw new r.DeveloperError("cartesian is required.");if(!t.defined(o))throw new r.DeveloperError("oneOverRadii is required.");if(!t.defined(u))throw new r.DeveloperError("oneOverRadiiSquared is required.");if(!t.defined(c))throw new r.DeveloperError("centerToleranceSquared is required.");var s=e.x,f=e.y,h=e.z,l=o.x,y=o.y,p=o.z,C=s*s*l*l,m=f*f*y*y,g=h*h*p*p,O=C+m+g,b=Math.sqrt(1/O),k=i.Cartesian3.multiplyByScalar(e,b,n);if(O<c)return isFinite(b)?i.Cartesian3.clone(k,d):void 0;var v=u.x,x=u.y,_=u.z,w=a;w.x=k.x*v*2,w.y=k.y*x*2,w.z=k.z*_*2;var S,q,j,R,M,T,z,E,N,A,V,I=(1-b)*i.Cartesian3.magnitude(e)/(.5*i.Cartesian3.magnitude(w)),D=0;do{I-=D,j=1/(1+I*v),R=1/(1+I*x),M=1/(1+I*_),T=j*j,z=R*R,E=M*M,N=T*j,A=z*R,V=E*M,S=C*T+m*z+g*E-1,q=C*N*v+m*A*x+g*V*_;var B=-2*q;D=S/B}while(Math.abs(S)>i.CesiumMath.EPSILON12);return t.defined(d)?(d.x=s*j,d.y=f*R,d.z=h*M,d):new i.Cartesian3(s*j,f*R,h*M)}function u(e,r,i){this.longitude=t.defaultValue(e,0),this.latitude=t.defaultValue(r,0),this.height=t.defaultValue(i,0)}u.fromRadians=function(e,i,n,a){return r.Check.typeOf.number("longitude",e),r.Check.typeOf.number("latitude",i),n=t.defaultValue(n,0),t.defined(a)?(a.longitude=e,a.latitude=i,a.height=n,a):new u(e,i,n)},u.fromDegrees=function(e,t,n,a){return r.Check.typeOf.number("longitude",e),r.Check.typeOf.number("latitude",t),e=i.CesiumMath.toRadians(e),t=i.CesiumMath.toRadians(t),u.fromRadians(e,t,n,a)};var c=new i.Cartesian3,d=new i.Cartesian3,s=new i.Cartesian3,f=new i.Cartesian3(1/6378137,1/6378137,1/6356752.314245179),h=new i.Cartesian3(1/40680631590769,1/40680631590769,1/40408299984661.445),l=i.CesiumMath.EPSILON1;function y(e,n,a,o){n=t.defaultValue(n,0),a=t.defaultValue(a,0),o=t.defaultValue(o,0),r.Check.typeOf.number.greaterThanOrEquals("x",n,0),r.Check.typeOf.number.greaterThanOrEquals("y",a,0),r.Check.typeOf.number.greaterThanOrEquals("z",o,0),e._radii=new i.Cartesian3(n,a,o),e._radiiSquared=new i.Cartesian3(n*n,a*a,o*o),e._radiiToTheFourth=new i.Cartesian3(n*n*n*n,a*a*a*a,o*o*o*o),e._oneOverRadii=new i.Cartesian3(0===n?0:1/n,0===a?0:1/a,0===o?0:1/o),e._oneOverRadiiSquared=new i.Cartesian3(0===n?0:1/(n*n),0===a?0:1/(a*a),0===o?0:1/(o*o)),e._minimumRadius=Math.min(n,a,o),e._maximumRadius=Math.max(n,a,o),e._centerToleranceSquared=i.CesiumMath.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function p(e,t,r){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,y(this,e,t,r)}u.fromCartesian=function(e,r,n){var a=t.defined(r)?r.oneOverRadii:f,y=t.defined(r)?r.oneOverRadiiSquared:h,p=t.defined(r)?r._centerToleranceSquared:l,C=o(e,a,y,p,d);if(t.defined(C)){var m=i.Cartesian3.multiplyComponents(C,y,c);m=i.Cartesian3.normalize(m,m);var g=i.Cartesian3.subtract(e,C,s),O=Math.atan2(m.y,m.x),b=Math.asin(m.z),k=i.CesiumMath.sign(i.Cartesian3.dot(g,e))*i.Cartesian3.magnitude(g);return t.defined(n)?(n.longitude=O,n.latitude=b,n.height=k,n):new u(O,b,k)}},u.toCartesian=function(e,t,n){return r.Check.defined("cartographic",e),i.Cartesian3.fromRadians(e.longitude,e.latitude,e.height,t,n)},u.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.longitude=e.longitude,r.latitude=e.latitude,r.height=e.height,r):new u(e.longitude,e.latitude,e.height)},u.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.longitude===r.longitude&&e.latitude===r.latitude&&e.height===r.height},u.equalsEpsilon=function(e,r,i){return i=t.defaultValue(i,0),e===r||t.defined(e)&&t.defined(r)&&Math.abs(e.longitude-r.longitude)<=i&&Math.abs(e.latitude-r.latitude)<=i&&Math.abs(e.height-r.height)<=i},u.ZERO=Object.freeze(new u(0,0,0)),u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.prototype.equalsEpsilon=function(e,t){return u.equalsEpsilon(this,e,t)},u.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},Object.defineProperties(p.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),p.clone=function(e,r){if(t.defined(e)){var n=e._radii;return t.defined(r)?(i.Cartesian3.clone(n,r._radii),i.Cartesian3.clone(e._radiiSquared,r._radiiSquared),i.Cartesian3.clone(e._radiiToTheFourth,r._radiiToTheFourth),i.Cartesian3.clone(e._oneOverRadii,r._oneOverRadii),i.Cartesian3.clone(e._oneOverRadiiSquared,r._oneOverRadiiSquared),r._minimumRadius=e._minimumRadius,r._maximumRadius=e._maximumRadius,r._centerToleranceSquared=e._centerToleranceSquared,r):new p(n.x,n.y,n.z)}},p.fromCartesian3=function(e,r){return t.defined(r)||(r=new p),t.defined(e)?(y(r,e.x,e.y,e.z),r):r},p.WGS84=Object.freeze(new p(6378137,6378137,6356752.314245179)),p.UNIT_SPHERE=Object.freeze(new p(1,1,1)),p.MOON=Object.freeze(new p(i.CesiumMath.LUNAR_RADIUS,i.CesiumMath.LUNAR_RADIUS,i.CesiumMath.LUNAR_RADIUS)),p.prototype.clone=function(e){return p.clone(this,e)},p.packedLength=i.Cartesian3.packedLength,p.pack=function(e,n,a){return r.Check.typeOf.object("value",e),r.Check.defined("array",n),a=t.defaultValue(a,0),i.Cartesian3.pack(e._radii,n,a),n},p.unpack=function(e,n,a){r.Check.defined("array",e),n=t.defaultValue(n,0);var o=i.Cartesian3.unpack(e,n);return p.fromCartesian3(o,a)},p.prototype.geocentricSurfaceNormal=i.Cartesian3.normalize,p.prototype.geodeticSurfaceNormalCartographic=function(e,n){r.Check.typeOf.object("cartographic",e);var a=e.longitude,o=e.latitude,u=Math.cos(o),c=u*Math.cos(a),d=u*Math.sin(a),s=Math.sin(o);return t.defined(n)||(n=new i.Cartesian3),n.x=c,n.y=d,n.z=s,i.Cartesian3.normalize(n,n)},p.prototype.geodeticSurfaceNormal=function(e,r){return t.defined(r)||(r=new i.Cartesian3),r=i.Cartesian3.multiplyComponents(e,this._oneOverRadiiSquared,r),i.Cartesian3.normalize(r,r)};var C=new i.Cartesian3,m=new i.Cartesian3;p.prototype.cartographicToCartesian=function(e,r){var n=C,a=m;this.geodeticSurfaceNormalCartographic(e,n),i.Cartesian3.multiplyComponents(this._radiiSquared,n,a);var o=Math.sqrt(i.Cartesian3.dot(n,a));return i.Cartesian3.divideByScalar(a,o,a),i.Cartesian3.multiplyByScalar(n,e.height,n),t.defined(r)||(r=new i.Cartesian3),i.Cartesian3.add(a,n,r)},p.prototype.cartographicArrayToCartesianArray=function(e,i){r.Check.defined("cartographics",e);var n=e.length;t.defined(i)?i.length=n:i=new Array(n);for(var a=0;a<n;a++)i[a]=this.cartographicToCartesian(e[a],i[a]);return i};var g=new i.Cartesian3,O=new i.Cartesian3,b=new i.Cartesian3;function k(e,r){this.x=t.defaultValue(e,0),this.y=t.defaultValue(r,0)}p.prototype.cartesianToCartographic=function(e,r){var n=this.scaleToGeodeticSurface(e,O);if(t.defined(n)){var a=this.geodeticSurfaceNormal(n,g),o=i.Cartesian3.subtract(e,n,b),c=Math.atan2(a.y,a.x),d=Math.asin(a.z),s=i.CesiumMath.sign(i.Cartesian3.dot(o,e))*i.Cartesian3.magnitude(o);return t.defined(r)?(r.longitude=c,r.latitude=d,r.height=s,r):new u(c,d,s)}},p.prototype.cartesianArrayToCartographicArray=function(e,i){r.Check.defined("cartesians",e);var n=e.length;t.defined(i)?i.length=n:i=new Array(n);for(var a=0;a<n;++a)i[a]=this.cartesianToCartographic(e[a],i[a]);return i},p.prototype.scaleToGeodeticSurface=function(e,t){return o(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},p.prototype.scaleToGeocentricSurface=function(e,n){r.Check.typeOf.object("cartesian",e),t.defined(n)||(n=new i.Cartesian3);var a=e.x,o=e.y,u=e.z,c=this._oneOverRadiiSquared,d=1/Math.sqrt(a*a*c.x+o*o*c.y+u*u*c.z);return i.Cartesian3.multiplyByScalar(e,d,n)},p.prototype.transformPositionToScaledSpace=function(e,r){return t.defined(r)||(r=new i.Cartesian3),i.Cartesian3.multiplyComponents(e,this._oneOverRadii,r)},p.prototype.transformPositionFromScaledSpace=function(e,r){return t.defined(r)||(r=new i.Cartesian3),i.Cartesian3.multiplyComponents(e,this._radii,r)},p.prototype.equals=function(e){return this===e||t.defined(e)&&i.Cartesian3.equals(this._radii,e._radii)},p.prototype.toString=function(){return this._radii.toString()},p.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,n,a){if(r.Check.typeOf.object("position",e),!i.CesiumMath.equalsEpsilon(this._radii.x,this._radii.y,i.CesiumMath.EPSILON15))throw new r.DeveloperError("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");r.Check.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),n=t.defaultValue(n,0);var o=this._squaredXOverSquaredZ;if(t.defined(a)||(a=new i.Cartesian3),a.x=0,a.y=0,a.z=e.z*(1-o),!(Math.abs(a.z)>=this._radii.z-n))return a},k.fromElements=function(e,r,i){return t.defined(i)?(i.x=e,i.y=r,i):new k(e,r)},k.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.x=e.x,r.y=e.y,r):new k(e.x,e.y)},k.fromCartesian3=k.clone,k.fromCartesian4=k.clone,k.packedLength=2,k.pack=function(e,i,n){return r.Check.typeOf.object("value",e),r.Check.defined("array",i),n=t.defaultValue(n,0),i[n++]=e.x,i[n]=e.y,i},k.unpack=function(e,i,n){return r.Check.defined("array",e),i=t.defaultValue(i,0),t.defined(n)||(n=new k),n.x=e[i++],n.y=e[i],n},k.packArray=function(e,i){r.Check.defined("array",e);var n=e.length,a=2*n;if(t.defined(i)){if(!Array.isArray(i)&&i.length!==a)throw new r.DeveloperError("If result is a typed array, it must have exactly array.length * 2 elements");i.length!==a&&(i.length=a)}else i=new Array(a);for(var o=0;o<n;++o)k.pack(e[o],i,2*o);return i},k.unpackArray=function(e,i){if(r.Check.defined("array",e),r.Check.typeOf.number.greaterThanOrEquals("array.length",e.length,2),e.length%2!==0)throw new r.DeveloperError("array length must be a multiple of 2.");var n=e.length;t.defined(i)?i.length=n/2:i=new Array(n/2);for(var a=0;a<n;a+=2){var o=a/2;i[o]=k.unpack(e,a,i[o])}return i},k.fromArray=k.unpack,k.maximumComponent=function(e){return r.Check.typeOf.object("cartesian",e),Math.max(e.x,e.y)},k.minimumComponent=function(e){return r.Check.typeOf.object("cartesian",e),Math.min(e.x,e.y)},k.minimumByComponent=function(e,t,i){return r.Check.typeOf.object("first",e),r.Check.typeOf.object("second",t),r.Check.typeOf.object("result",i),i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i},k.maximumByComponent=function(e,t,i){return r.Check.typeOf.object("first",e),r.Check.typeOf.object("second",t),r.Check.typeOf.object("result",i),i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i},k.magnitudeSquared=function(e){return r.Check.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},k.magnitude=function(e){return Math.sqrt(k.magnitudeSquared(e))};var v=new k;k.distance=function(e,t){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),k.subtract(e,t,v),k.magnitude(v)},k.distanceSquared=function(e,t){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),k.subtract(e,t,v),k.magnitudeSquared(v)},k.normalize=function(e,t){r.Check.typeOf.object("cartesian",e),r.Check.typeOf.object("result",t);var i=k.magnitude(e);if(t.x=e.x/i,t.y=e.y/i,isNaN(t.x)||isNaN(t.y))throw new r.DeveloperError("normalized result is not a number");return t},k.dot=function(e,t){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),e.x*t.x+e.y*t.y},k.multiplyComponents=function(e,t,i){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",i),i.x=e.x*t.x,i.y=e.y*t.y,i},k.divideComponents=function(e,t,i){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",i),i.x=e.x/t.x,i.y=e.y/t.y,i},k.add=function(e,t,i){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",i),i.x=e.x+t.x,i.y=e.y+t.y,i},k.subtract=function(e,t,i){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",i),i.x=e.x-t.x,i.y=e.y-t.y,i},k.multiplyByScalar=function(e,t,i){return r.Check.typeOf.object("cartesian",e),r.Check.typeOf.number("scalar",t),r.Check.typeOf.object("result",i),i.x=e.x*t,i.y=e.y*t,i},k.divideByScalar=function(e,t,i){return r.Check.typeOf.object("cartesian",e),r.Check.typeOf.number("scalar",t),r.Check.typeOf.object("result",i),i.x=e.x/t,i.y=e.y/t,i},k.negate=function(e,t){return r.Check.typeOf.object("cartesian",e),r.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},k.abs=function(e,t){return r.Check.typeOf.object("cartesian",e),r.Check.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var x=new k;k.lerp=function(e,t,i,n){return r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",i),r.Check.typeOf.object("result",n),k.multiplyByScalar(t,i,x),n=k.multiplyByScalar(e,1-i,n),k.add(x,n,n)};var _=new k,w=new k;k.angleBetween=function(e,t){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),k.normalize(e,_),k.normalize(t,w),i.CesiumMath.acosClamped(k.dot(_,w))};var S=new k;k.mostOrthogonalAxis=function(e,t){r.Check.typeOf.object("cartesian",e),r.Check.typeOf.object("result",t);var i=k.normalize(e,S);return k.abs(i,i),t=i.x<=i.y?k.clone(k.UNIT_X,t):k.clone(k.UNIT_Y,t),t},k.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.x===r.x&&e.y===r.y},k.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]},k.equalsEpsilon=function(e,r,n,a){return e===r||t.defined(e)&&t.defined(r)&&i.CesiumMath.equalsEpsilon(e.x,r.x,n,a)&&i.CesiumMath.equalsEpsilon(e.y,r.y,n,a)},k.ZERO=Object.freeze(new k(0,0)),k.UNIT_X=Object.freeze(new k(1,0)),k.UNIT_Y=Object.freeze(new k(0,1)),k.prototype.clone=function(e){return k.clone(this,e)},k.prototype.equals=function(e){return k.equals(this,e)},k.prototype.equalsEpsilon=function(e,t,r){return k.equalsEpsilon(this,e,t,r)},k.prototype.toString=function(){return"("+this.x+", "+this.y+")"},e.Cartesian2=k,e.Cartographic=u,e.Ellipsoid=p}));