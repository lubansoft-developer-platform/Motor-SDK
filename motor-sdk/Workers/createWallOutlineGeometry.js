define(["./when-45f3d25d","./Check-34538dad","./Cartesian3-eab74dc0","./Cartesian2-174fefc1","./BoundingSphere-9db3442e","./Transforms-3e7152f2","./Matrix4-22b96d31","./RuntimeError-86da6af2","./WebGLConstants-3660bc8f","./ComponentDatatype-86703c58","./GeometryAttribute-98a8cf59","./PrimitiveType-30fa6f85","./GeometryAttributes-9d45f9e2","./IndexDatatype-cb635cbc","./IntersectionTests-4fa5e272","./Plane-99a0ae01","./AxisAlignedBoundingBox-1aaa0e65","./EllipsoidTangentPlane-a1163ec8","./EllipsoidRhumbLine-de5cdc57","./PolygonPipeline-05839d65","./EllipsoidGeodesic-96429ebd","./PolylinePipeline-579420a3","./WallGeometryLibrary-d460cbb2"],(function(e,i,t,r,n,a,o,s,l,d,m,p,u,f,h,g,c,v,y,E,w,_,C){"use strict";var H=new t.Cartesian3,b=new t.Cartesian3;function A(n){n=e.defaultValue(n,e.defaultValue.EMPTY_OBJECT);var a=n.positions,o=n.maximumHeights,s=n.minimumHeights;if(!e.defined(a))throw new i.DeveloperError("options.positions is required.");if(e.defined(o)&&o.length!==a.length)throw new i.DeveloperError("options.positions and options.maximumHeights must have the same length.");if(e.defined(s)&&s.length!==a.length)throw new i.DeveloperError("options.positions and options.minimumHeights must have the same length.");var l=e.defaultValue(n.granularity,t.CesiumMath.RADIANS_PER_DEGREE),d=e.defaultValue(n.ellipsoid,r.Ellipsoid.WGS84);this._positions=a,this._minimumHeights=s,this._maximumHeights=o,this._granularity=l,this._ellipsoid=r.Ellipsoid.clone(d),this._workerName="createWallOutlineGeometry";var m=1+a.length*t.Cartesian3.packedLength+2;e.defined(s)&&(m+=s.length),e.defined(o)&&(m+=o.length),this.packedLength=m+r.Ellipsoid.packedLength+1}A.pack=function(n,a,o){if(!e.defined(n))throw new i.DeveloperError("value is required");if(!e.defined(a))throw new i.DeveloperError("array is required");var s;o=e.defaultValue(o,0);var l=n._positions,d=l.length;for(a[o++]=d,s=0;s<d;++s,o+=t.Cartesian3.packedLength)t.Cartesian3.pack(l[s],a,o);var m=n._minimumHeights;if(d=e.defined(m)?m.length:0,a[o++]=d,e.defined(m))for(s=0;s<d;++s)a[o++]=m[s];var p=n._maximumHeights;if(d=e.defined(p)?p.length:0,a[o++]=d,e.defined(p))for(s=0;s<d;++s)a[o++]=p[s];return r.Ellipsoid.pack(n._ellipsoid,a,o),o+=r.Ellipsoid.packedLength,a[o]=n._granularity,a};var x=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),P={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:x,granularity:void 0};function k(i,t){return e.defined(t)&&(i=A.unpack(i,t)),i._ellipsoid=r.Ellipsoid.clone(i._ellipsoid),A.createGeometry(i)}return A.unpack=function(n,a,o){if(!e.defined(n))throw new i.DeveloperError("array is required");var s;a=e.defaultValue(a,0);var l,d,m=n[a++],p=new Array(m);for(s=0;s<m;++s,a+=t.Cartesian3.packedLength)p[s]=t.Cartesian3.unpack(n,a);if(m=n[a++],m>0)for(l=new Array(m),s=0;s<m;++s)l[s]=n[a++];if(m=n[a++],m>0)for(d=new Array(m),s=0;s<m;++s)d[s]=n[a++];var u=r.Ellipsoid.unpack(n,a,x);a+=r.Ellipsoid.packedLength;var f=n[a];return e.defined(o)?(o._positions=p,o._minimumHeights=l,o._maximumHeights=d,o._ellipsoid=r.Ellipsoid.clone(u,o._ellipsoid),o._granularity=f,o):(P.positions=p,P.minimumHeights=l,P.maximumHeights=d,P.granularity=f,new A(P))},A.fromConstantHeights=function(t){t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT);var r,n,a=t.positions;if(!e.defined(a))throw new i.DeveloperError("options.positions is required.");var o=t.minimumHeight,s=t.maximumHeight,l=e.defined(o),d=e.defined(s);if(l||d){var m=a.length;r=l?new Array(m):void 0,n=d?new Array(m):void 0;for(var p=0;p<m;++p)l&&(r[p]=o),d&&(n[p]=s)}var u={positions:a,maximumHeights:n,minimumHeights:r,ellipsoid:t.ellipsoid};return new A(u)},A.createGeometry=function(i){var r=i._positions,a=i._minimumHeights,o=i._maximumHeights,s=i._granularity,l=i._ellipsoid,h=C.WallGeometryLibrary.computePositions(l,r,o,a,s,!1);if(e.defined(h)){var g,c=h.bottomPositions,v=h.topPositions,y=v.length,E=2*y,w=new Float64Array(E),_=0;for(y/=3,g=0;g<y;++g){var A=3*g,x=t.Cartesian3.fromArray(v,A,H),P=t.Cartesian3.fromArray(c,A,b);w[_++]=P.x,w[_++]=P.y,w[_++]=P.z,w[_++]=x.x,w[_++]=x.y,w[_++]=x.z}var k=new u.GeometryAttributes({position:new m.GeometryAttribute({componentDatatype:d.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:w})}),D=E/3;E=2*D-4+D;var G=f.IndexDatatype.createTypedArray(D,E),L=0;for(g=0;g<D-2;g+=2){var T=g,V=g+2,S=t.Cartesian3.fromArray(w,3*T,H),B=t.Cartesian3.fromArray(w,3*V,b);if(!t.Cartesian3.equalsEpsilon(S,B,t.CesiumMath.EPSILON10)){var I=g+1,q=g+3;G[L++]=I,G[L++]=T,G[L++]=I,G[L++]=q,G[L++]=T,G[L++]=V}}return G[L++]=D-2,G[L++]=D-1,new m.Geometry({attributes:k,indices:G,primitiveType:p.PrimitiveType.LINES,boundingSphere:new n.BoundingSphere.fromVertices(w)})}},k}));