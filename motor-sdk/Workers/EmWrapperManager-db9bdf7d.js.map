{"version":3,"file":"EmWrapperManager-db9bdf7d.js","sources":["../../../../Source/Extension/Source/Worker/EmWrapperManager.js"],"sourcesContent":["import materem from \"../../../ThirdParty/Workers/materem.js\";\nimport when from \"../../../ThirdParty/when.js\";\nimport defined from \"../../../Core/defined.js\";\n\nexport let emMod;\n\n/**\n * mater em mgr\n */\nclass EmWrapperManager {\n    /**\n     *\n     * @param {string} wasmpath\n     * @returns {Promise<Boolean>}\n     */\n    static initWebAssembly(wasmpath) {\n        return initWebAssembly(wasmpath);\n    }\n}\n\nfunction initWebAssembly(wasmpath) {\n    let readyPromise = when.defer();\n    if (!defined(emMod)) {\n        const xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", wasmpath, true);\n        xhr.responseType = \"arraybuffer\";\n        xhr.send();\n\n        xhr.onload = function () {\n            var WebAssemblyType = {};\n            WebAssemblyType[\"wasmBinary\"] = xhr.response;\n            WebAssemblyType[\"onModuleLoaded\"] = function (inmod) {\n                emMod = inmod;\n                readyPromise.resolve(true);\n            };\n            //全局模块\n            materem(WebAssemblyType);\n        };\n    } else {\n        readyPromise.resolve(true);\n    }\n    return readyPromise.promise;\n}\n\nexport default EmWrapperManager;\n"],"names":["when","defined","emMod","materem"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;IAMA;IACA;IACA;IACA,MAAM,gBAAgB,CAAC;IACvB;IACA;IACA;IACA;IACA;IACA,IAAI,OAAO,eAAe,CAAC,QAAQ,EAAE;IACrC,QAAQ,OAAO,eAAe,CAAC,QAAQ,CAAC,CAAC;IACzC,KAAK;IACL,CAAC;AACD;IACA,SAAS,eAAe,CAAC,QAAQ,EAAE;IACnC,IAAI,IAAI,YAAY,GAAGA,SAAI,CAAC,KAAK,EAAE,CAAC;IACpC,IAAI,IAAI,CAACC,YAAO,CAACC,aAAK,CAAC,EAAE;IACzB,QAAQ,MAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;IACzC,QAAQ,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;IACxC,QAAQ,GAAG,CAAC,YAAY,GAAG,aAAa,CAAC;IACzC,QAAQ,GAAG,CAAC,IAAI,EAAE,CAAC;AACnB;IACA,QAAQ,GAAG,CAAC,MAAM,GAAG,YAAY;IACjC,YAAY,IAAI,eAAe,GAAG,EAAE,CAAC;IACrC,YAAY,eAAe,CAAC,YAAY,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC;IACzD,YAAY,eAAe,CAAC,gBAAgB,CAAC,GAAG,UAAU,KAAK,EAAE;IACjE,gBAAgBA,aAAK,GAAG,KAAK,CAAC;IAC9B,gBAAgB,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC3C,aAAa,CAAC;IACd;IACA,YAAYC,eAAO,CAAC,eAAe,CAAC,CAAC;IACrC,SAAS,CAAC;IACV,KAAK,MAAM;IACX,QAAQ,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACnC,KAAK;IACL,IAAI,OAAO,YAAY,CAAC,OAAO,CAAC;IAChC;;;;;;;;"}