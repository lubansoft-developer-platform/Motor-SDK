import buildModuleUrl from"../Core/buildModuleUrl.js";var tmp={};(function(e){var t,n,i="File format is not recognized.",r="File contains encrypted entry.",o="File is using Zip64 (4gb+ file size).",a="Error while reading zip file.",c="Error while writing zip file.",f="Error while writing file data.",u="Error while reading file data.",s="File already exists.",l=524288,w="inflate.js",g="deflate.js",d="text/plain",v="message";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(O){}function h(){var e=-1,t=this;t.append=function(n){var i,r=t.table;for(i=0;i<n.length;i++)e=e>>>8^r[255&(e^n[i])]},t.get=function(){return~e}}function p(e,t,n){return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}function y(e,t){var n,i;return n=new ArrayBuffer(e),i=new Uint8Array(n),t&&i.set(t,0),{buffer:n,array:i,view:new DataView(n)}}function U(){}function m(e){var t,n=this;function i(i,r){var o=new Blob([e],{type:d});t=new A(o),t.init((function(){n.size=t.size,i()}),r)}function r(e,n,i,r){t.readUint8Array(e,n,i,r)}n.size=0,n.init=i,n.readUint8Array=r}function z(e){var t,n=this;function i(i){var r=e.length;while("="==e.charAt(r-1))r--;t=e.indexOf(",")+1,n.size=Math.floor(.75*(r-t)),i()}function r(n,i,r){var o,a=y(i),c=4*Math.floor(n/3),f=4*Math.ceil((n+i)/3),u=window.atob(e.substring(c+t,f+t)),s=n-3*Math.floor(c/4);for(o=s;o<s+i;o++)a.array[o-s]=u.charCodeAt(o);r(a.array)}n.size=0,n.init=i,n.readUint8Array=r}function A(e){var t=this;function n(t){this.size=e.size,t()}function i(t,n,i,r){var o=new FileReader;o.onload=function(e){i(new Uint8Array(e.target.result))},o.onerror=r,o.readAsArrayBuffer(p(e,t,n))}t.size=0,t.init=n,t.readUint8Array=i}function b(){}function M(e){var n,i=this;function r(e){n=new Blob([],{type:d}),e()}function o(e,i){n=new Blob([n,t?e:e.buffer],{type:d}),i()}function a(t,i){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=i,r.readAsText(n,e)}i.init=r,i.writeUint8Array=o,i.getData=a}function S(e){var t=this,n="",i="";function r(t){n+="data:"+(e||"")+";base64,",t()}function o(e,t){var r,o=i.length,a=i;for(i="",r=0;r<3*Math.floor((o+e.length)/3)-o;r++)a+=String.fromCharCode(e[r]);for(;r<e.length;r++)i+=String.fromCharCode(e[r]);a.length>2?n+=window.btoa(a):i=a,t()}function a(e){e(n+window.btoa(i))}t.init=r,t.writeUint8Array=o,t.getData=a}function D(e){var n,i=this;function r(t){n=new Blob([],{type:e}),t()}function o(i,r){n=new Blob([n,t?i:i.buffer],{type:e}),r()}function a(e){e(n)}i.init=r,i.writeUint8Array=o,i.getData=a}function L(e,t,n,i,r,o,a,c,f,u){var s,w,g=0;function d(){e.removeEventListener(v,h,!1),c(w)}function h(e){var t=e.data,i=t.data;t.onappend&&(w+=i.length,n.writeUint8Array(i,(function(){o(!1,i),p()}),u)),t.onflush&&(i?(w+=i.length,n.writeUint8Array(i,(function(){o(!1,i),d()}),u)):d()),t.progress&&a&&a(s+t.current,r)}function p(){s=g*l,s<r?t.readUint8Array(i+s,Math.min(l,r-s),(function(t){e.postMessage({append:!0,data:t}),g++,a&&a(s,r),o(!0,t)}),f):e.postMessage({flush:!0})}w=0,e.addEventListener(v,h,!1),p()}function F(e,t,n,i,r,o,a,c,f,u){var s,w=0,g=0;function d(){var v;s=w*l,s<r?t.readUint8Array(i+s,Math.min(l,r-s),(function(t){var c=e.append(t,(function(){a&&a(i+s,r)}));g+=c.length,o(!0,t),n.writeUint8Array(c,(function(){o(!1,c),w++,setTimeout(d,1)}),u),a&&a(s,r)}),f):(v=e.flush(),v?(g+=v.length,n.writeUint8Array(v,(function(){o(!1,v),c(g)}),u)):c(g))}d()}function C(t,n,i,r,o,a,c,f,u){var s,l=new h;function g(e,t){o&&!e&&l.append(t)}function d(e){a(e,l.get())}return e.zip.useWebWorkers?(s=new Worker(e.zip.workerScriptsPath+w),L(s,t,n,i,r,g,c,d,f,u)):F(new e.zip.Inflater,t,n,i,r,g,c,d,f,u),s}function W(t,n,i,r,o,a,c){var f,u=new h;function s(e,t){e&&u.append(t)}function l(e){r(e,u.get())}function w(){f.removeEventListener(v,w,!1),L(f,t,n,0,t.size,s,o,l,a,c)}return e.zip.useWebWorkers?(f=new Worker(e.zip.workerScriptsPath+g),f.addEventListener(v,w,!1),f.postMessage({init:!0,level:i})):F(new e.zip.Deflater,t,n,0,t.size,s,o,l,a,c),f}function R(e,t,n,i,r,o,a,c,f){var u=0,s=new h;function w(){var g=u*l;g<i?e.readUint8Array(n+g,Math.min(l,i-g),(function(e){r&&s.append(e),a&&a(g,i,e),t.writeUint8Array(e,(function(){u++,w()}),f)}),c):o(i,s.get())}w()}function x(e){var t,n,i="",r=["\xc7","\xfc","\xe9","\xe2","\xe4","\xe0","\xe5","\xe7","\xea","\xeb","\xe8","\xef","\xee","\xec","\xc4","\xc5","\xc9","\xe6","\xc6","\xf4","\xf6","\xf2","\xfb","\xf9","\xff","\xd6","\xdc","\xf8","\xa3","\xd8","\xd7","\u0192","\xe1","\xed","\xf3","\xfa","\xf1","\xd1","\xaa","\xba","\xbf","\xae","\xac","\xbd","\xbc","\xa1","\xab","\xbb","_","_","_","\xa6","\xa6","\xc1","\xc2","\xc0","\xa9","\xa6","\xa6","+","+","\xa2","\xa5","+","+","-","-","+","-","+","\xe3","\xc3","+","+","-","-","\xa6","-","+","\xa4","\xf0","\xd0","\xca","\xcb","\xc8","i","\xcd","\xce","\xcf","+","+","_","_","\xa6","\xcc","_","\xd3","\xdf","\xd4","\xd2","\xf5","\xd5","\xb5","\xfe","\xde","\xda","\xdb","\xd9","\xfd","\xdd","\xaf","\xb4","\xad","\xb1","_","\xbe","\xb6","\xa7","\xf7","\xb8","\xb0","\xa8","\xb7","\xb9","\xb3","\xb2","_"," "];for(t=0;t<e.length;t++)n=255&e.charCodeAt(t),i+=n>127?r[n-128]:String.fromCharCode(n);return i}function k(e){return decodeURIComponent(escape(e))}function B(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function E(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(O){}}function _(e,t,n,i,a){e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=E(e.lastModDateRaw),1!==(1&e.bitFlag)?((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(n+22,!0),e.extraFieldLength=t.view.getUint16(n+24,!0)):a(o)):a(r)}function P(e,t){function n(){}function r(n,i){e.readUint8Array(e.size-n,n,(function(e){var t=y(e.length,e).view;1347093766!=t.getUint32(0)?r(n+1,i):i(t)}),(function(){t(a)}))}return n.prototype.getData=function(n,r,o,a){var c,s=this;function l(e,t){c&&c.terminate(),c=null,e&&e(t)}function w(e){var t=y(4);return t.view.setUint32(0,e),s.crc32==t.view.getUint32(0)}function g(e,t){a&&!w(t)?d():n.getData((function(e){l(r,e)}))}function d(){l(t,u)}function v(){l(t,f)}e.readUint8Array(s.offset,30,(function(r){var f,u=y(r.length,r);1347093252==u.view.getUint32(0)?(_(s,u,4,!1,t),f=s.offset+30+s.filenameLength+s.extraFieldLength,n.init((function(){0===s.compressionMethod?R(e,n,f,s.compressedSize,a,g,o,d,v):c=C(e,n,f,s.compressedSize,a,g,o,d,v)}),v)):t(i)}),d)},{getEntries:function(o){e.size<22?t(i):r(22,(function(r){var c,f;c=r.getUint32(16,!0),f=r.getUint16(8,!0),e.readUint8Array(c,e.size-c,(function(e){var r,a,c,u,s=0,l=[],w=y(e.length,e);for(r=0;r<f;r++){if(a=new n,1347092738!=w.view.getUint32(s))return void t(i);_(a,w,s+6,!0,t),a.commentLength=w.view.getUint16(s+32,!0),a.directory=16==(16&w.view.getUint8(s+38)),a.offset=w.view.getUint32(s+42,!0),c=B(w.array.subarray(s+46,s+46+a.filenameLength)),a.filename=2048===(2048&a.bitFlag)?k(c):x(c),a.directory||"/"!=a.filename.charAt(a.filename.length-1)||(a.directory=!0),u=B(w.array.subarray(s+46+a.filenameLength+a.extraFieldLength,s+46+a.filenameLength+a.extraFieldLength+a.commentLength)),a.comment=2048===(2048&a.bitFlag)?k(u):x(u),l.push(a),s+=46+a.filenameLength+a.extraFieldLength+a.commentLength}o(l)}),(function(){t(a)}))}))},close:function(e){e&&e()}}}function I(e){return unescape(encodeURIComponent(e))}function T(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function j(e,t,n){var i,r={},o=[],a=0;function f(e,t){i&&i.terminate(),i=null,e&&e(t)}function l(){f(t,c)}function w(){f(t,u)}return{add:function(c,u,g,d,v){var h,p,U;function m(t){var i;U=v.lastModDate||new Date,h=y(26),r[c]={headerArray:h.array,directory:v.directory,filename:p,offset:a,comment:T(I(v.comment||""))},h.view.setUint32(0,335546376),v.version&&h.view.setUint8(0,v.version),n||0===v.level||v.directory||h.view.setUint16(4,2048),h.view.setUint16(6,(U.getHours()<<6|U.getMinutes())<<5|U.getSeconds()/2,!0),h.view.setUint16(8,(U.getFullYear()-1980<<4|U.getMonth()+1)<<5|U.getDate(),!0),h.view.setUint16(22,p.length,!0),i=y(30+p.length),i.view.setUint32(0,1347093252),i.array.set(h.array,4),i.array.set(p,30),a+=i.array.length,e.writeUint8Array(i.array,t,l)}function z(t,n){var i=y(16);a+=t||0,i.view.setUint32(0,1347094280),"undefined"!=typeof n&&(h.view.setUint32(10,n,!0),i.view.setUint32(4,n,!0)),u&&(i.view.setUint32(8,t,!0),h.view.setUint32(14,t,!0),i.view.setUint32(12,u.size,!0),h.view.setUint32(18,u.size,!0)),e.writeUint8Array(i.array,(function(){a+=16,f(g)}),l)}function A(){v=v||{},c=c.trim(),v.directory&&"/"!=c.charAt(c.length-1)&&(c+="/"),r.hasOwnProperty(c)?t(s):(p=T(I(c)),o.push(c),m((function(){u?n||0===v.level?R(u,e,0,u.size,!0,z,d,w,l):i=W(u,e,v.level,z,d,w,l):z()}),l))}u?u.init(A,w):A()},close:function(t){var n,i,c,u=0,s=0;for(i=0;i<o.length;i++)c=r[o[i]],u+=46+c.filename.length+c.comment.length;for(n=y(u+22),i=0;i<o.length;i++)c=r[o[i]],n.view.setUint32(s,1347092738),n.view.setUint16(s+4,5120),n.array.set(c.headerArray,s+6),n.view.setUint16(s+32,c.comment.length,!0),c.directory&&n.view.setUint8(s+38,16),n.view.setUint32(s+42,c.offset,!0),n.array.set(c.filename,s+46),n.array.set(c.comment,s+46+c.filename.length),s+=46+c.filename.length+c.comment.length;n.view.setUint32(s,1347093766),n.view.setUint16(s+8,o.length,!0),n.view.setUint16(s+10,o.length,!0),n.view.setUint32(s+12,u,!0),n.view.setUint32(s+16,a,!0),e.writeUint8Array(n.array,(function(){f((function(){e.getData(t)}))}),l)}}}h.prototype.table=function(){var e,t,n,i=[];for(e=0;e<256;e++){for(n=e,t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;i[e]=n}return i}(),m.prototype=new U,m.prototype.constructor=m,z.prototype=new U,z.prototype.constructor=z,A.prototype=new U,A.prototype.constructor=A,b.prototype.getData=function(e){e(this.data)},M.prototype=new b,M.prototype.constructor=M,S.prototype=new b,S.prototype.constructor=S,D.prototype=new b,D.prototype.constructor=D,e.zip={Reader:U,Writer:b,BlobReader:A,Data64URIReader:z,TextReader:m,BlobWriter:D,Data64URIWriter:S,TextWriter:M,createReader:function(e,t,n){e.init((function(){t(P(e,n))}),n)},createWriter:function(e,t,n,i){e.init((function(){t(j(e,n,i))}),n)},useWebWorkers:!0},Object.defineProperties(e.zip,{workerScriptsPath:{get:function(){return"undefined"===typeof n&&(n=buildModuleUrl("ThirdParty/Workers/")),n}}})})(tmp);export default tmp.zip;